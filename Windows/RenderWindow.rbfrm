#tag WindowBegin Window RenderWindow   BackColor       =   16777215   Backdrop        =   0   BalloonHelp     =   ""   CloseButton     =   False   Composite       =   False   Frame           =   8   FullScreen      =   False   HasBackColor    =   False   Height          =   91   ImplicitInstance=   True   LiveResize      =   False   MacProcID       =   0   MaxHeight       =   32000   MaximizeButton  =   False   MaxWidth        =   32000   MenuBar         =   0   MenuBarVisible  =   True   MinHeight       =   64   MinimizeButton  =   True   MinWidth        =   64   Placement       =   0   Resizeable      =   False   Title           =   "Exporting"   Visible         =   True   Width           =   144   Begin ProgressBar Progress      AutoDeactivate  =   True      Enabled         =   True      Height          =   12      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Left            =   21      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   False      LockTop         =   False      Maximum         =   100      Scope           =   0      TabIndex        =   0      TabPanelIndex   =   0      TabStop         =   True      Top             =   14      Value           =   0      Visible         =   True      Width           =   100   End   Begin Timer Timer1      Height          =   32      Index           =   -2147483648      Left            =   222      LockedInPosition=   False      Mode            =   0      Period          =   25      Scope           =   0      TabIndex        =   1      TabPanelIndex   =   0      TabStop         =   True      Top             =   1      Width           =   32   End   Begin PushButton CancelButton      AutoDeactivate  =   True      Bold            =   False      ButtonStyle     =   0      Cancel          =   False      Caption         =   "Cancel"      Default         =   False      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   False      Left            =   20      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   False      LockTop         =   False      Scope           =   0      TabIndex        =   2      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   59      Underline       =   False      Visible         =   True      Width           =   100   End   Begin WindowThread WindowThread1      busy            =   0      Height          =   32      Index           =   -2147483648      Left            =   -18      LockedInPosition=   False      Priority        =   5      Scope           =   0      StackSize       =   0      TabIndex        =   3      TabPanelIndex   =   0      TabStop         =   True      Top             =   21      Width           =   32   End   Begin Timer Timer2      Height          =   32      Index           =   -2147483648      Left            =   114      LockedInPosition=   False      Mode            =   1      Period          =   1000      Scope           =   0      TabIndex        =   4      TabPanelIndex   =   0      TabStop         =   True      Top             =   21      Width           =   32   End   Begin Label TimeLabel      Active          =   ""      AutoDeactivate  =   True      Bold            =   False      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   False      Left            =   20      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   False      LockTop         =   False      Multiline       =   False      Scope           =   0      Selectable      =   False      TabIndex        =   5      TabPanelIndex   =   0      TabStop         =   True      Text            =   ""      TextAlign       =   1      TextColor       =   0      TextFont        =   "Smallsystem"      TextSize        =   0      Top             =   32      Transparent     =   False      Underline       =   False      Visible         =   True      Width           =   100      Window          =   0      _mWindow        =   0   EndEnd#tag EndWindow#tag WindowCode	#tag Event		Sub Open()		  SetLanguage		  if  WindowThread1.state= thread.NotRunning then		    windowthread1.run		  end		End Sub	#tag EndEvent	#tag Method, Flags = &h0		Sub SetLanguage()		  dim value as string		  dim languagedict as dictionary		  languagedict = app.languagedict		  if languagedict =nil then return		  		  if languagedict.getstring("cancel", value) then cancelbutton.Caption = value		  		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub SetPosition()		  if targetcarbon then return		  if parent<>nil then		    		  end		End Sub	#tag EndMethod	#tag Property, Flags = &h0		alpha As picture	#tag EndProperty	#tag Property, Flags = &h0		askforstop As boolean	#tag EndProperty	#tag Property, Flags = &h0		count As integer	#tag EndProperty	#tag Property, Flags = &h0		framep As picture	#tag EndProperty	#tag Property, Flags = &h0		joblist(-1) As integer	#tag EndProperty	#tag Property, Flags = &h0		parent As main	#tag EndProperty	#tag Property, Flags = &h0		starttime As date	#tag EndProperty#tag EndWindowCode#tag Events Timer1	#tag Event		Sub Action()		  'SetPosition		  '		  'if usercancelled then close		  'if ubound(joblist) > -1 then		  ''exportlabel.text = str(joblist(0))		  'progress.maximum = count		  'progress.value = count + 1 - ubound(joblist)		  'if parent.exportonetitle(joblist(0),frame,alpha) then		  'joblist.remove 0		  'else		  'close		  'end		  'else		  'close		  'end		End Sub	#tag EndEvent#tag EndEvents#tag Events CancelButton	#tag Event		Sub Action()		  askforstop = true		  me.enabled = false		End Sub	#tag EndEvent#tag EndEvents#tag Events WindowThread1	#tag Event		Sub CloseEvent()		  close		End Sub	#tag EndEvent	#tag Event		Function RunEvent() As boolean		  dim currenttime as date		  dim s1, s2 as string		  dim est as double		  		  // wait for joblist		  while parent=nil		  wend		  		  framep = parent.jobframe		  alpha = parent.jobalpha		  joblist = parent.jobs		  count = ubound(joblist) + 1		  top = parent.top		  left = parent.left + parent.width/2 - width/2		  starttime = new date		  		  while ubound(joblist)>-1		    SetPosition		    		    if usercancelled then return false		    if askforstop then return false		    		    progress.maximum = count		    progress.value = count -1 - ubound(joblist)		    		    if starttime<>nil then		      currenttime = new date		      currenttime.totalSeconds = currenttime.totalSeconds - starttime.totalSeconds		      if ubound(joblist) < count - 2 then		        est = (ubound(joblist)+1) / (count-ubound(joblist)) * currenttime.totalSeconds		        currenttime.totalSeconds = est		        s2 = format(currenttime.hour,"00") + ":" + format(currenttime.minute,"00") + ":" +format(currenttime.second,"00")		        timelabel.text = s2		      end		    end		    		    if parent.exportonetitle(joblist(0),framep,alpha) then		      joblist.remove 0		    else		      return false		    end		  wend		  return false		End Function	#tag EndEvent#tag EndEvents#tag Events Timer2	#tag Event		Sub Action()		  if WindowThread1.State = thread.NotRunning then		    windowthread1.run		  end		End Sub	#tag EndEvent#tag EndEvents