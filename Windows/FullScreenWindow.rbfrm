#tag WindowBegin Window FullScreenWindow   BackColor       =   0   Backdrop        =   0   BalloonHelp     =   ""   CloseButton     =   True   Composite       =   True   Frame           =   0   FullScreen      =   True   HasBackColor    =   True   Height          =   552   ImplicitInstance=   True   LiveResize      =   False   MacProcID       =   0   MaxHeight       =   32000   MaximizeButton  =   False   MaxWidth        =   32000   MenuBar         =   0   MenuBarVisible  =   False   MinHeight       =   64   MinimizeButton  =   True   MinWidth        =   64   Placement       =   0   Resizeable      =   False   Title           =   "Untitled"   Visible         =   True   Width           =   1076   Begin Canvas3 Preview      AcceptFocus     =   False      AcceptTabs      =   False      aspectratio     =   0      AutoDeactivate  =   True      Backdrop        =   0      bold            =   0      buffer          =   0      DoubleBuffer    =   False      Enabled         =   True      EraseBackground =   True      Height          =   122      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      italic          =   0      Left            =   0      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   True      LockRight       =   True      LockTop         =   False      Scope           =   0      spacing         =   0      TabIndex        =   0      TabPanelIndex   =   0      TabStop         =   True      textcolor       =   0      Top             =   26      underline       =   0      UseFocusRing    =   True      Visible         =   True      Width           =   1081   End   Begin Label TClabel      Active          =   ""      AutoDeactivate  =   True      Bold            =   False      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   False      Left            =   9      LockBottom      =   True      LockedInPosition=   False      LockLeft        =   True      LockRight       =   False      LockTop         =   False      Multiline       =   False      Scope           =   0      Selectable      =   False      TabIndex        =   1      TabPanelIndex   =   0      TabStop         =   True      Text            =   "00:00:00:00"      TextAlign       =   0      TextColor       =   16777215      TextFont        =   "System"      TextSize        =   0      Top             =   526      Transparent     =   False      Underline       =   False      Visible         =   True      Width           =   88      Window          =   0      _mWindow        =   0   End   Begin Label NextTitleLabel      Active          =   ""      AutoDeactivate  =   True      Bold            =   False      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   False      Left            =   521      LockBottom      =   True      LockedInPosition=   False      LockLeft        =   False      LockRight       =   True      LockTop         =   False      Multiline       =   False      Scope           =   0      Selectable      =   False      TabIndex        =   2      TabPanelIndex   =   0      TabStop         =   True      Text            =   "next title"      TextAlign       =   2      TextColor       =   16777215      TextFont        =   "System"      TextSize        =   0      Top             =   526      Transparent     =   False      Underline       =   False      Visible         =   True      Width           =   535      Window          =   0      _mWindow        =   0   End   Begin Timer Timer1      Height          =   32      Index           =   -2147483648      Left            =   655      LockedInPosition=   False      Mode            =   2      Period          =   20      Scope           =   0      TabIndex        =   3      TabPanelIndex   =   0      TabStop         =   True      Top             =   185      Width           =   32   End   Begin Label SpeedLabel      Active          =   ""      AutoDeactivate  =   True      Bold            =   False      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   False      Left            =   109      LockBottom      =   True      LockedInPosition=   False      LockLeft        =   True      LockRight       =   False      LockTop         =   False      Multiline       =   False      Scope           =   0      Selectable      =   False      TabIndex        =   4      TabPanelIndex   =   0      TabStop         =   True      Text            =   "0%"      TextAlign       =   0      TextColor       =   16777215      TextFont        =   "System"      TextSize        =   0      Top             =   526      Transparent     =   False      Underline       =   False      Visible         =   True      Width           =   88      Window          =   0      _mWindow        =   0   EndEnd#tag EndWindow#tag WindowCode	#tag Event		Sub Close()		  unlinkTitlelist		End Sub	#tag EndEvent	#tag Event		Function KeyDown(Key As String) As Boolean		  select case key		  case chr(1)		    if parent<>nil then		      lasttc = parent.titlelist.gettitle(1).getinPoint		      speed = 0		    end		    lasttc = tclabel.text		    lasttime = microseconds		  case chr(27) // esc		    //close		    self.fullScreen = not self.fullScreen		    self.menuBarvisible = not self.menuBarvisible		  case "A"		    tc.settext lasttc		    lasttc = parent.titlelist.getpreviousCutFromTimecode(tc).gettext		    speed =  0		    lasttime = microseconds		  case "S"		    tc.settext lasttc		    lasttc = parent.titlelist.getnextCutFromTimecode(tc).GetText		    speed = 0		    lasttime = microseconds		  case "H"		    tclabel.visible = not tclabel.visible		    speedlabel.visible = not speedlabel.visible		    nexttitleLabel.visible = not nextTitleLabel.visible		  case "J"		    if keyboard.asynckeyDown(40) then		      speed = -0.25		    elseif speed > -1.0 then		      speed = -1.0		    else		      speed = speed * 2		    end		    lasttc = tclabel.text		    lasttime = microseconds		  case "K"		    speed = 0.0		    lasttc = tclabel.text		    lasttime = microseconds		  case "L"		    if keyboard.asynckeyDown(40) then		      speed = 0.25		    elseif speed < 1.0 then		      speed = 1.0		    else		      speed = speed * 2		    end		    lasttc = tclabel.text		    lasttime = microseconds		  end		End Function	#tag EndEvent	#tag Event		Sub Resized()		  linkTitlelist		End Sub	#tag EndEvent	#tag MenuHandler		Function FileCLose() As Boolean Handles FileCLose.Action			close		End Function	#tag EndMenuHandler	#tag Method, Flags = &h0		Sub LinkTitlelist()		  if parent<>nil then		    preview.aspectratio = parent.preview.aspectratio		    preview.settextsize parent.style.size		    preview.wrapmethod= parent.preview.wrapMethod		    preview.left = (self.width -preview.width) / 2		    parent.titlelist.staticn = preview		    if parent.movieplayer1.visible then		      tclabel.text = parent.moviepositionLabel.text		    else		      tclabel.text = parent.titlelist.acttitle.getinPoint		    end		    		    tc = parent.style.gettimeCode		  end		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub UnlinkTitlelist()		  if parent<>nil then		    parent.titlelist.staticn = parent.preview		  end		End Sub	#tag EndMethod	#tag Property, Flags = &h0		lasttc As string	#tag EndProperty	#tag Property, Flags = &h0		lasttime As double	#tag EndProperty	#tag Property, Flags = &h0		parent As main	#tag EndProperty	#tag Property, Flags = &h0		speed As double	#tag EndProperty	#tag Property, Flags = &h0		tc As timecode	#tag EndProperty#tag EndWindowCode#tag Events Preview	#tag Event		Function Textsizeevent() As integer		  if parent<>nil then		    return parent.style.size		  else		    return 12		  end		End Function	#tag EndEvent#tag EndEvents#tag Events Timer1	#tag Event		Sub Action()		  dim now,ts as double		  dim s as string		  dim ot as onetitle		  		  now = microseconds		  		  		  if tc<>nil and lasttime > 0 then 		    		    tc.settext lasttc		    ts = tc.gettotalSeconds		    ts = ts + (now-lasttime)*speed/1000000.0		    tc.settotalSeconds ts		    s = tc.gettext		    if s<>tclabel.text then tclabel.text = s		    		    s = format(speed,"-0%")		    if s<>speedlabel.text then speedlabel.text = s		    		    		    		    if parent <> nil then		      parent.titlelist.previewfromtimecode(tc)		      		      ot = parent.titlelist.getnextTitleFromTimecode(tc)		      if ot<>nil then		        s= nthfield(ot.TextClean,endofLine.macintosh,1) + " " +ot.getinPoint		      else		        s = ""		      end		      if s<>nexttitleLabel.text then nexttitleLabel.text=s		    end		  end		  		End Sub	#tag EndEvent#tag EndEvents