#tag WindowBegin Window PreflightWindow   BackColor       =   16777215   Backdrop        =   0   BalloonHelp     =   ""   CloseButton     =   True   Composite       =   True   Frame           =   3   FullScreen      =   False   HasBackColor    =   False   Height          =   626   ImplicitInstance=   True   LiveResize      =   False   MacProcID       =   0   MaxHeight       =   32000   MaximizeButton  =   True   MaxWidth        =   32000   MenuBar         =   0   MenuBarVisible  =   True   MinHeight       =   64   MinimizeButton  =   True   MinWidth        =   64   Placement       =   0   Resizeable      =   False   Title           =   "Preflight"   Visible         =   True   Width           =   464   Begin DocumentSelector DocumentSelector1      AutoDeactivate  =   True      BalloonHelp     =   ""      Bold            =   False      ControlOrder    =   0      DataField       =   ""      DataSource      =   ""      DisabledBalloonHelp=   ""      Enabled         =   True      Height          =   16      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      InitialValue    =   ""      Italic          =   False      Left            =   41      ListIndex       =   0      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   False      LockTop         =   False      TabIndex        =   0      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "Smallsystem"      TextSize        =   0      Top             =   14      Underline       =   False      Visible         =   True      Width           =   252   End   Begin ListBox Results      AutoDeactivate  =   True      BalloonHelp     =   ""      Bold            =   False      ColumnCount     =   3      ColumnsResizable=   False      ColumnWidths    =   "40%,20%,40%"      ControlOrder    =   1      DataField       =   ""      DataSource      =   ""      DefaultRowHeight=   -1      DisabledBalloonHelp=   ""      Enabled         =   True      EnableDrag      =   False      EnableDragReorder=   False      GridLinesHorizontal=   0      GridLinesVertical=   0      HasHeading      =   False      HeadingIndex    =   -1      Height          =   196      HelpTag         =   ""      Hierarchical    =   False      Index           =   -2147483648      InitialParent   =   ""      InitialValue    =   ""      Italic          =   False      Left            =   20      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   False      LockTop         =   False      ScrollBarHorizontal=   False      ScrollBarVertical=   True      ScrollPosition  =   0      ScrollPositionX =   0      SelectionType   =   0      TabIndex        =   1      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "System"      TextSize        =   0      Top             =   403      Underline       =   False      UseFocusRing    =   True      Visible         =   True      Width           =   421   End   Begin PushButton RunButton      AutoDeactivate  =   True      BalloonHelp     =   ""      Bold            =   False      Cancel          =   False      Caption         =   "Run"      ControlOrder    =   2      Default         =   False      DisabledBalloonHelp=   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   False      Left            =   321      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   False      LockTop         =   False      TabIndex        =   2      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "System"      TextSize        =   0      Top             =   13      Underline       =   False      Visible         =   True      Width           =   120   End   Begin GroupBox SpottingErrorGroup      AutoDeactivate  =   True      BalloonHelp     =   ""      Bold            =   False      Caption         =   "Spotting Errors"      ControlOrder    =   3      DisabledBalloonHelp=   ""      Enabled         =   True      Height          =   187      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   False      Left            =   14      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   False      LockTop         =   False      TabIndex        =   3      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "System"      TextSize        =   0      Top             =   42      Underline       =   False      Visible         =   True      Width           =   428      Begin CheckBox TitlesWithOutTimecodeCheck         AutoDeactivate  =   True         BalloonHelp     =   ""         Bold            =   False         Caption         =   "Titles without TC"         ControlOrder    =   4         DataField       =   ""         DataSource      =   ""         DisabledBalloonHelp=   ""         Enabled         =   True         Height          =   25         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "SpottingErrorGroup"         Italic          =   False         Left            =   41         LockBottom      =   False         LockedInPosition=   False         LockLeft        =   False         LockRight       =   False         LockTop         =   False         State           =   1         TabIndex        =   0         TabPanelIndex   =   0         TabStop         =   True         TextFont        =   "Smallsystem"         TextSize        =   0         Top             =   64         Underline       =   False         Value           =   True         Visible         =   True         Width           =   319      End      Begin CheckBox OverlappingTimecodeCheck         AutoDeactivate  =   True         BalloonHelp     =   ""         Bold            =   False         Caption         =   "Overlapping TC. Frame distance less than"         ControlOrder    =   5         DataField       =   ""         DataSource      =   ""         DisabledBalloonHelp=   ""         Enabled         =   True         Height          =   25         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "SpottingErrorGroup"         Italic          =   False         Left            =   41         LockBottom      =   False         LockedInPosition=   False         LockLeft        =   False         LockRight       =   False         LockTop         =   False         State           =   1         TabIndex        =   1         TabPanelIndex   =   0         TabStop         =   True         TextFont        =   "Smallsystem"         TextSize        =   0         Top             =   110         Underline       =   False         Value           =   True         Visible         =   True         Width           =   319      End      Begin CheckBox TitlesShorterCheck         AutoDeactivate  =   True         BalloonHelp     =   ""         Bold            =   False         Caption         =   "TC duration shorter than 1 second"         ControlOrder    =   6         DataField       =   ""         DataSource      =   ""         DisabledBalloonHelp=   ""         Enabled         =   True         Height          =   25         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "SpottingErrorGroup"         Italic          =   False         Left            =   41         LockBottom      =   False         LockedInPosition=   False         LockLeft        =   False         LockRight       =   False         LockTop         =   False         State           =   1         TabIndex        =   2         TabPanelIndex   =   0         TabStop         =   True         TextFont        =   "Smallsystem"         TextSize        =   0         Top             =   133         Underline       =   False         Value           =   True         Visible         =   True         Width           =   319      End      Begin CheckBox TitlesLongerThanCheck         AutoDeactivate  =   True         BalloonHelp     =   ""         Bold            =   False         Caption         =   "TC duration longer than 10 seconds"         ControlOrder    =   7         DataField       =   ""         DataSource      =   ""         DisabledBalloonHelp=   ""         Enabled         =   True         Height          =   25         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "SpottingErrorGroup"         Italic          =   False         Left            =   41         LockBottom      =   False         LockedInPosition=   False         LockLeft        =   False         LockRight       =   False         LockTop         =   False         State           =   1         TabIndex        =   3         TabPanelIndex   =   0         TabStop         =   True         TextFont        =   "Smallsystem"         TextSize        =   0         Top             =   156         Underline       =   False         Value           =   True         Visible         =   True         Width           =   319      End      Begin CheckBox TitlesNotChronologicalCheck         AutoDeactivate  =   True         BalloonHelp     =   ""         Bold            =   False         Caption         =   "Titles not chronological"         ControlOrder    =   12         DataField       =   ""         DataSource      =   ""         DisabledBalloonHelp=   ""         Enabled         =   True         Height          =   25         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "SpottingErrorGroup"         Italic          =   False         Left            =   41         LockBottom      =   False         LockedInPosition=   False         LockLeft        =   False         LockRight       =   False         LockTop         =   False         State           =   1         TabIndex        =   4         TabPanelIndex   =   0         TabStop         =   True         TextFont        =   "Smallsystem"         TextSize        =   0         Top             =   87         Underline       =   False         Value           =   True         Visible         =   True         Width           =   319      End      Begin TextField OverlappingDistanceField         AcceptTabs      =   False         Alignment       =   0         AutoDeactivate  =   True         BackColor       =   16777215         BalloonHelp     =   ""         Bold            =   False         Border          =   True         ControlOrder    =   16         DataField       =   ""         DataSource      =   ""         DisabledBalloonHelp=   ""         Enabled         =   True         Format          =   ""         Height          =   22         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "SpottingErrorGroup"         Italic          =   False         Left            =   386         LimitText       =   0         LockBottom      =   False         LockedInPosition=   False         LockLeft        =   False         LockRight       =   False         LockTop         =   False         Mask            =   ""         MultiLine       =   False         Password        =   False         ReadOnly        =   False         ScrollBar       =   True         ScrollBarHorizontal=   False         ScrollBarVertical=   True         Styled          =   False         TabIndex        =   5         TabPanelIndex   =   0         TabStop         =   True         Text            =   3         TextColor       =   0         TextFont        =   "Smallsystem"         TextSize        =   0         Top             =   113         Underline       =   False         UseFocusRing    =   True         Visible         =   True         Width           =   40      End      Begin CheckBox ReadingSpeedTooFastCheck         AutoDeactivate  =   True         BalloonHelp     =   ""         Bold            =   False         Caption         =   "Reading Speed too fast"         ControlOrder    =   17         DataField       =   ""         DataSource      =   ""         DisabledBalloonHelp=   ""         Enabled         =   True         Height          =   25         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "SpottingErrorGroup"         Italic          =   False         Left            =   41         LockBottom      =   False         LockedInPosition=   False         LockLeft        =   False         LockRight       =   False         LockTop         =   False         State           =   1         TabIndex        =   6         TabPanelIndex   =   0         TabStop         =   True         TextFont        =   "Smallsystem"         TextSize        =   0         Top             =   179         Underline       =   False         Value           =   True         Visible         =   True         Width           =   319      End      Begin CheckBox ReadingSpeedTooSlowCheck         AutoDeactivate  =   True         BalloonHelp     =   ""         Bold            =   False         Caption         =   "Reading Speed too slow"         ControlOrder    =   18         DataField       =   ""         DataSource      =   ""         DisabledBalloonHelp=   ""         Enabled         =   True         Height          =   25         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "SpottingErrorGroup"         Italic          =   False         Left            =   41         LockBottom      =   False         LockedInPosition=   False         LockLeft        =   False         LockRight       =   False         LockTop         =   False         State           =   1         TabIndex        =   7         TabPanelIndex   =   0         TabStop         =   True         TextFont        =   "Smallsystem"         TextSize        =   0         Top             =   202         Underline       =   False         Value           =   True         Visible         =   True         Width           =   319      End   End   Begin CheckBox TextLongerCheck      AutoDeactivate  =   True      BalloonHelp     =   ""      Bold            =   False      Caption         =   "Text longer than maximal Characters"      ControlOrder    =   8      DataField       =   ""      DataSource      =   ""      DisabledBalloonHelp=   ""      Enabled         =   True      Height          =   25      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   False      Left            =   41      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   False      LockTop         =   False      State           =   1      TabIndex        =   4      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "Smallsystem"      TextSize        =   0      Top             =   360      Underline       =   False      Value           =   True      Visible         =   True      Width           =   319   End   Begin GroupBox TextErrorGroup      AutoDeactivate  =   True      BalloonHelp     =   ""      Bold            =   False      Caption         =   "Text Errors"      ControlOrder    =   9      DisabledBalloonHelp=   ""      Enabled         =   True      Height          =   83      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   False      Left            =   20      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   False      LockTop         =   False      TabIndex        =   5      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "System"      TextSize        =   0      Top             =   309      Underline       =   False      Visible         =   True      Width           =   425      Begin CheckBox EmptyLinesCheck         AutoDeactivate  =   True         BalloonHelp     =   ""         Bold            =   False         Caption         =   "Empty Lines"         ControlOrder    =   14         DataField       =   ""         DataSource      =   ""         DisabledBalloonHelp=   ""         Enabled         =   True         Height          =   25         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "TextErrorGroup"         Italic          =   False         Left            =   41         LockBottom      =   False         LockedInPosition=   False         LockLeft        =   False         LockRight       =   False         LockTop         =   False         State           =   1         TabIndex        =   0         TabPanelIndex   =   0         TabStop         =   True         TextFont        =   "Smallsystem"         TextSize        =   0         Top             =   339         Underline       =   False         Value           =   True         Visible         =   True         Width           =   319      End      Begin TextField TextLengthField         AcceptTabs      =   False         Alignment       =   0         AutoDeactivate  =   True         BackColor       =   16777215         BalloonHelp     =   ""         Bold            =   False         Border          =   True         ControlOrder    =   15         DataField       =   ""         DataSource      =   ""         DisabledBalloonHelp=   ""         Enabled         =   True         Format          =   ""         Height          =   22         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "TextErrorGroup"         Italic          =   False         Left            =   386         LimitText       =   0         LockBottom      =   False         LockedInPosition=   False         LockLeft        =   False         LockRight       =   False         LockTop         =   False         Mask            =   ""         MultiLine       =   False         Password        =   False         ReadOnly        =   False         ScrollBar       =   True         ScrollBarHorizontal=   False         ScrollBarVertical=   True         Styled          =   False         TabIndex        =   1         TabPanelIndex   =   0         TabStop         =   True         Text            =   40         TextColor       =   0         TextFont        =   "Smallsystem"         TextSize        =   0         Top             =   367         Underline       =   False         UseFocusRing    =   True         Visible         =   True         Width           =   40      End   End   Begin CheckBox DuplicateFilenamesCheck      AutoDeactivate  =   True      BalloonHelp     =   ""      Bold            =   False      Caption         =   "Duplicate Filenames"      ControlOrder    =   10      DataField       =   ""      DataSource      =   ""      DisabledBalloonHelp=   ""      Enabled         =   True      Height          =   25      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   False      Left            =   41      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   False      LockTop         =   False      State           =   1      TabIndex        =   6      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "Smallsystem"      TextSize        =   0      Top             =   261      Underline       =   False      Value           =   True      Visible         =   True      Width           =   319   End   Begin GroupBox FilenameErrorGroup      AutoDeactivate  =   True      BalloonHelp     =   ""      Bold            =   False      Caption         =   "Filename Errors"      ControlOrder    =   11      DisabledBalloonHelp=   ""      Enabled         =   True      Height          =   57      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   False      Left            =   19      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   False      LockTop         =   False      TabIndex        =   7      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "System"      TextSize        =   0      Top             =   241      Underline       =   False      Visible         =   True      Width           =   426   End   Begin ProgressBar ProgressBar1      AutoDeactivate  =   True      BalloonHelp     =   ""      ControlOrder    =   13      DisabledBalloonHelp=   ""      Enabled         =   True      Height          =   12      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Left            =   23      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   False      LockTop         =   False      Maximum         =   100      TabIndex        =   8      TabPanelIndex   =   0      TabStop         =   True      Top             =   607      Value           =   0      Visible         =   False      Width           =   100   EndEnd#tag EndWindow#tag WindowCode	#tag Event		Sub Activate()		  documentSelector1.refreshlist		End Sub	#tag EndEvent	#tag Event		Sub Close()		  dim dict as new dictionary		  		  dict.value("top") = top		  dict.value("left") =left		  		  dict.value("titleswithouttc")=  titleswithOutTimecodeCheck.value		  dict.value("titlesnotchronological")= titlesnotChronologicalCheck.value		  dict.value("overlappingtc")=overlappingTimecodeCheck.value 		  dict.value("overlappinttcvalue")= overlappingdistanceField.text		  dict.value("tcdurationshort")= titlesshorterCheck.value 		  dict.value("tcdurationlong")= titleslongerThanCheck.value 		  dict.value("readingSpeedToofastCheck") = readingSpeedToofastCheck.value		  dict.value("readingSpeedTooslowCheck") = readingSpeedTooslowCheck.value		  		  		  dict.value("duplicatefilenames")= duplicateFilenamesCheck.value 		  		  dict.value("emptylines")= emptyLinesCheck.value 		  dict.value("textlong")= textlongerCheck.value 		  dict.value("textlongvalue")=textlengthField.text		  		  app.preflightdict = dict		End Sub	#tag EndEvent	#tag Event		Sub Open()		  dim dict as dictionary		  dim s as string		  dim i as integer		  dim b as boolean		  dict = app.preflightdict		  		  if dict <>nil then		    if dict.getinteger("top",i) then top = i		    if dict.getinteger("left",i) then left = i		    self.setbounds(left,top,width,height)		    		    if dict.getboolean("titleswithouttc", b) then titleswithOutTimecodeCheck.value = b		    if dict.getboolean("titlesnotchronological", b) then titlesnotChronologicalCheck.value = b		    if dict.getboolean("overlappingtc", b) then overlappingTimecodeCheck.value = b		    if dict.getstring("overlappinttcvalue", s) then overlappingdistanceField.text = s		    if dict.getboolean("tcdurationshort", b) then titlesshorterCheck.value = b		    if dict.getboolean("tcdurationlong", b) then titleslongerThanCheck.value = b		    if dict.getboolean("readingspeedtoofast", b) then readingspeedtoofastcheck.value = b		    if dict.getboolean("readingspeedtooslow", b) then readingspeedtooslowcheck.value = b		    		    if dict.getboolean("duplicatefilenames", b) then duplicateFilenamesCheck.value = b		    		    if dict.getboolean("emptylines", b) then emptyLinesCheck.value = b		    if dict.getboolean("textlong", b) then textlongerCheck.value = b		    if dict.getstring("textlongvalue", s) then textlengthField.text = s		    		  end		  		  setlanguage		End Sub	#tag EndEvent	#tag MenuHandler		Function FileCLose() As Boolean Handles FileCLose.Action			self.close			return true		End Function	#tag EndMenuHandler	#tag Method, Flags = &h0		Sub AddError(errormessage as string, titlenumber as integer, title as oneTitle)		  results.addrow errormessage		  results.cellTag(results.lastIndex,0) = titlenumber		  results.cell(results.lastIndex,1) = title.getfilename		  results.cell(results.lastIndex,2) = nthfield(title.gettext,endofline,1)		  		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub CheckTitles(titles() as onetitle)		  dim tit as oneTitle		  dim i,ub as integer		  		  for each tit in titles		    tit.parseTimeCode		  next		  		  results.deleteAllRows		  		  ub = ubound(titles)		  		  progressBar1.maximum = ub		  progressBar1.value = 0		  progressBar1.visible = true		  filenamedict = nil		  		  for i = 0 to ub		    if titlesWithOutTimecodeCheck.value then		      titlewithoutTimecodeTest i+1,titles(i)		    end		    if i>0 and titlesnotChronologicalCheck.value then		      titlesChronologicalTest i+1, titles(i), titles(i-1)		    end		    if i>0 and overlappingtimecodeCheck.value then		      overlappingTimecodeTest i+1, titles(i), titles(i-1), val(overlappingDistanceField.text)		    end		    if titlesShorterCheck.value then		      shortTitleTest i+1, titles(i)		    end		    if titlesLongerThanCheck.value then		      longtitletest i+1, titles(i)		    end		    		    readingSpeedTest i+1, titles(i), readingSpeedTooFastCheck.value, readingSpeedTooslowCheck.value		    		    if duplicateFilenamesCheck.value then		      duplicateFilenameTest i+1, titles(i)		    end		    if emptylinesCheck.value then		      emptyLineTest  i+1, titles(i)		    end		    if textLongerCheck.value then		      longTextTest i+1, titles(i), val(textLengthField.text)		    end		    		    if i mod 25 = 0 then		      progressBar1.value = i 		      results.refresh		      updatenow		      if usercancelled then		        beep		        exit		      end		      		    end		  next		  		  progressBar1.visible = false		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub DuplicateFilenameTest(titlenumber as integer, title as oneTitle)		  dim s as string		  		  if  filenamedict=nil then		    filenamedict = new dictionary		  end		  		  s = title.getfilename 		  		  		  if filenamedict.hasKey(s) then		    addError  "Duplicate filename", titlenumber, title		  end		  filenamedict.value(s) = title.getinPoint		  		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub EmptyLineTest(titlenumber as integer, title as oneTitle)		  dim lines(-1), line as string		  lines = split(title.gettext,endofLine)		  		  for each line in lines		    if line = "" then		      adderror  "Empty Line",titlenumber, title		    end		  next		  		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub LongTextTest(titlenumber as integer, title as oneTitle, maxlength as integer)		  dim lines(-1), line as string		  dim mx as double		  lines = split(title.gettext,endofLine)		  		  if style<>nil then		    select case style.wrapmethod		    case style.kwrapnone		      mx =1		    case style.kwrapsimple		      mx = 1.9		    case style.kwrapsmart		      mx = 1.9		    else		      mx = 1.0		    end		  end		  		  for each line in lines		    if len(line)>mx*maxlength then		      adderror  "Long line " + str(len(line)),titlenumber, title		    end		  next		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub LongTitleTest(titlenumber as integer, title as oneTitle)		  dim msg as string		  dim tc, tc2 as timeCode		  dim count as integer		  		  tc = title.style.gettimecode		  		  if tc.istc(title.getinpoint) and tc.istc(title.getoutpoint) then		    		    tc.settext(title.getoutpoint)		    tc2 = tc.clone		    tc2.settext(title.getinpoint)		    tc.minus tc2		    		    if tc.getTotalSeconds > 10 then		      adderror "TC too long "  + right(tc.gettext,5), titlenumber, title		    end		  end		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub OverlappingTimecodeTest(titlenumber as integer, title as oneTitle, oldtitle as onetitle, mindistance as integer)		  dim msg as string		  dim tc, tc2 as timeCode		  dim count as integer		  		  tc = title.style.gettimecode		  		  if tc.istc(title.getinpoint) and tc.istc(oldtitle.getoutpoint)   then		    		    tc.settext(title.getinpoint)		    tc2 = tc.clone		    tc2.settext(oldtitle.getoutpoint)		    		    		    if tc.getframes - tc2.getframes  < mindistance then		      adderror "TC overlapping", titlenumber, title		    end		  end		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub ReadingSpeedTest(titlenumber as integer, title as oneTitle, fast as boolean, slow as boolean)		  dim msg as string		  dim tc, tc2 as timeCode		  dim count as integer		  dim dur as double		  dim trs as double		  		  tc = title.style.gettimecode		  		  if tc.istc(title.getinpoint) and tc.istc(title.getoutpoint) then		    		    tc.settext(title.getoutpoint)		    tc2 = tc.clone		    tc2.settext(title.getinpoint)		    tc.minus tc2		    		    dur = tc.gettotalSeconds		    if dur>0 then		      trs = len(title.textclean)/dur		      if trs>app.readingspeed*1.2 and fast then		        adderror "Reading speed too fast " + format(trs,"0"), titlenumber, title		      elseif trs<app.readingspeed*0.8 and slow and dur > 1.0 then		        adderror "Reading speed too slow " + format(trs,"0"), titlenumber, title		      end		    end		    		    		    		  end		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub SetLanguage()		  dim value as string		  dim languagedict as dictionary		  languagedict = app.languagedict		  		  if languagedict =nil then return		  		  		  if languagedict.getstring("preflighttitle", value) then title = value		  		  if languagedict.getstring("preflightspottingerror", value) then spottingerrorGroup.caption = value		  if languagedict.getstring("preflighttitleswithouttc", value) then titlesWithOutTimecodeCheck.caption = value		  if languagedict.getstring("preflighttitlesnotchronological", value) then titlesnotChronologicalCheck.caption = value		  if languagedict.getstring("preflightoverlappingtc", value) then overlappingTimecodeCheck.caption = value		  if languagedict.getstring("preflighttcdurationshort", value) then titlesshorterCheck.caption = value		  if languagedict.getstring("preflighttcdurationlong", value) then titleslongerThanCheck.caption = value		  		  if languagedict.getstring("preflightfilenameerror", value) then filenameErrorGroup.caption  = value		  if languagedict.getstring("preflightduplicatefilenames", value) then duplicateFilenamesCheck.caption = value		  		  if languagedict.getstring("preflighttexterrors", value) then texterrorGroup.caption = value		  if languagedict.getstring("preflightemptylines", value) then emptyLinesCheck.caption = value		  if languagedict.getstring("preflighttextlong", value) then textlongerCheck.caption = value		  		  		  if languagedict.getstring("preflightrun", value) then runbutton.caption = value		  		  		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub ShortTitleTest(titlenumber as integer, title as oneTitle)		  dim msg as string		  dim tc, tc2 as timeCode		  dim count as integer		  		  tc = title.style.gettimecode		  		  if tc.istc(title.getinpoint) and tc.istc(title.getoutpoint) then		    		    tc.settext(title.getoutpoint)		    tc2 = tc.clone		    tc2.settext(title.getinpoint)		    tc.minus tc2		    		    if tc.getTotalSeconds < 1 then		      adderror "TC too short " + right(tc.gettext,5) , titlenumber, title		    end		  end		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub TitlesChronologicalTest(titlenumber as integer, title as oneTitle, oldtitle as oneTitle)		  dim msg as string		  dim tc, tc2 as timeCode		  dim count as integer		  		  tc = title.style.gettimecode		  		  if tc.istc(title.getinpoint) and tc.istc(oldtitle.getinpoint)   then		    		    tc.settext(title.getinpoint)		    tc2 = tc.clone		    tc2.settext(oldtitle.getinpoint)		    		    		    if tc.getframes < tc2.getframes  then		      adderror "TC not chronological", titlenumber, title		    end		  end		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub TitleWithoutTimecodeTest(titlenumber as integer, title as onetitle)		  dim msg as string		  dim tc as timeCode		  		  tc = title.style.gettimecode		  		  if not tc.istc(title.getinpoint) then		    		    if not tc.istc(title.getoutpoint) then		      adderror "Invalid TC", titlenumber, title		    else		      adderror "Invalid TC start", titlenumber, title		    end		  else		    if not tc.istc(title.getoutpoint) then		      adderror "Invalid TC end", titlenumber, title		    end		  end		End Sub	#tag EndMethod	#tag Property, Flags = &h0		currentcolumn As integer	#tag EndProperty	#tag Property, Flags = &h0		currentrow As integer	#tag EndProperty	#tag Property, Flags = &h0		currentwindow As main	#tag EndProperty	#tag Property, Flags = &h0		filenamedict As dictionary	#tag EndProperty	#tag Property, Flags = &h0		style As subtitle	#tag EndProperty#tag EndWindowCode#tag Events Results	#tag Event		Function CellClick(row as Integer, column as Integer, x as Integer, y as Integer) As Boolean		  currentrow = row		  currentcolumn = column		End Function	#tag EndEvent	#tag Event		Sub DoubleClick()		  if currentwindow<>nil then		    currentwindow.titlelist.setFocus		    currentwindow.titlelist.selectFromTitleNumber me.celltag(currentrow,0)		    currentwindow.show		    currentwindow.titlelist.preview		    currentwindow.titlelist.setFocus		    currentwindow.titlelist.scrolltoSelection		  end		End Sub	#tag EndEvent#tag EndEvents#tag Events RunButton	#tag Event		Sub Action()		  dim titles() as oneTitle		  dim titlelist as edittitle		  		  		  'if not app.reg.online then		  'msgBox "You need an online license to use this tool."		  'return		  'end		  		  currentwindow = documentselector1.getdocument		  		  if currentwindow<>nil then		    titlelist = currentwindow.titlelist		  end		  		  if titlelist<>nil then		    titles = titlelist.getallTitles		    style = titlelist.style		    checktitles(titles)		  end		  		  		End Sub	#tag EndEvent#tag EndEvents