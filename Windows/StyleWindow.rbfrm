#tag WindowBegin Window StyleWindow   BackColor       =   16777215   Backdrop        =   0   BalloonHelp     =   ""   CloseButton     =   True   Composite       =   True   Frame           =   3   FullScreen      =   False   HasBackColor    =   False   Height          =   229   ImplicitInstance=   True   LiveResize      =   False   MacProcID       =   0   MaxHeight       =   32000   MaximizeButton  =   True   MaxWidth        =   32000   MenuBar         =   0   MenuBarVisible  =   True   MinHeight       =   64   MinimizeButton  =   True   MinWidth        =   64   Placement       =   0   Resizeable      =   False   Title           =   "Style"   Visible         =   True   Width           =   458   Begin DocumentSelector DocumentSelector1      AutoDeactivate  =   True      Bold            =   False      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   16      HelpTag         =   ""      includetemplates=   0      Index           =   -2147483648      InitialParent   =   ""      InitialValue    =   ""      Italic          =   False      Left            =   35      ListIndex       =   0      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   False      LockTop         =   False      Scope           =   0      TabIndex        =   0      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "Smallsystem"      TextSize        =   0      Top             =   14      Underline       =   False      Visible         =   True      Width           =   252   End   Begin ProgressBar ProgressBar1      AutoDeactivate  =   True      Enabled         =   True      Height          =   12      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Left            =   23      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   False      LockTop         =   False      Maximum         =   100      Scope           =   0      TabIndex        =   1      TabPanelIndex   =   0      TabStop         =   True      Top             =   563      Value           =   0      Visible         =   False      Width           =   100   End   Begin Label wrapcommithelp      AutoDeactivate  =   True      Bold            =   False      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   False      Left            =   41      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   False      LockTop         =   False      Multiline       =   False      Scope           =   0      TabIndex        =   0      TabPanelIndex   =   0      TabStop         =   True      Text            =   "Create two-line titles"      TextAlign       =   0      TextColor       =   0      TextFont        =   "Smallsystem"      TextSize        =   0      Top             =   155      Underline       =   False      Visible         =   True      Width           =   258   End   Begin CheckBox CreateNewFileOption      AutoDeactivate  =   True      Bold            =   False      Caption         =   "Create new file"      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   False      Left            =   303      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   False      LockTop         =   False      Scope           =   0      State           =   1      TabIndex        =   1      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "Smallsystem"      TextSize        =   0      Top             =   13      Underline       =   False      Value           =   True      Visible         =   True      Width           =   148   End   Begin GroupBox copygroup      AutoDeactivate  =   True      Bold            =   False      Caption         =   "Copy style"      Enabled         =   True      Height          =   65      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   False      Left            =   14      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   False      LockTop         =   False      Scope           =   0      TabIndex        =   2      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "System"      TextSize        =   0      Top             =   45      Underline       =   False      Visible         =   True      Width           =   428      Begin PushButton CopyStyleButton         AutoDeactivate  =   True         Bold            =   False         Cancel          =   False         Caption         =   "Run"         Default         =   False         Enabled         =   True         Height          =   16         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "copygroup"         Italic          =   False         Left            =   307         LockBottom      =   False         LockedInPosition=   False         LockLeft        =   False         LockRight       =   False         LockTop         =   False         Scope           =   0         TabIndex        =   0         TabPanelIndex   =   0         TabStop         =   True         TextFont        =   "Smallsystem"         TextSize        =   0         Top             =   75         Underline       =   False         Visible         =   True         Width           =   120      End      Begin Label referencefilelabel         AutoDeactivate  =   True         Bold            =   False         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   20         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "copygroup"         Italic          =   False         Left            =   43         LockBottom      =   False         LockedInPosition=   False         LockLeft        =   False         LockRight       =   False         LockTop         =   False         Multiline       =   False         Scope           =   0         TabIndex        =   1         TabPanelIndex   =   0         TabStop         =   True         Text            =   "Reference File"         TextAlign       =   0         TextColor       =   0         TextFont        =   "Smallsystem"         TextSize        =   0         Top             =   75         Underline       =   False         Visible         =   True         Width           =   100      End      Begin DocumentSelector ReferenceSelector         AutoDeactivate  =   True         Bold            =   False         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   16         HelpTag         =   ""         includetemplates=   0         Index           =   -2147483648         InitialParent   =   "copygroup"         InitialValue    =   ""         Italic          =   False         Left            =   137         ListIndex       =   0         LockBottom      =   False         LockedInPosition=   False         LockLeft        =   False         LockRight       =   False         LockTop         =   False         Scope           =   0         TabIndex        =   2         TabPanelIndex   =   0         TabStop         =   True         TextFont        =   "Smallsystem"         TextSize        =   0         Top             =   75         Underline       =   False         Visible         =   True         Width           =   150      End   End   Begin GroupBox wrapgroup      AutoDeactivate  =   True      Bold            =   False      Caption         =   "Wrap"      Enabled         =   True      Height          =   94      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   False      Left            =   15      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   False      LockTop         =   False      Scope           =   0      TabIndex        =   3      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "System"      TextSize        =   0      Top             =   122      Underline       =   False      Visible         =   True      Width           =   428      Begin PushButton WrapCommitButton         AutoDeactivate  =   True         Bold            =   False         Cancel          =   False         Caption         =   "Commit"         Default         =   False         Enabled         =   True         Height          =   16         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "wrapgroup"         Italic          =   False         Left            =   307         LockBottom      =   False         LockedInPosition=   False         LockLeft        =   False         LockRight       =   False         LockTop         =   False         Scope           =   0         TabIndex        =   0         TabPanelIndex   =   0         TabStop         =   True         TextFont        =   "Smallsystem"         TextSize        =   0         Top             =   155         Underline       =   False         Visible         =   True         Width           =   120      End      Begin PushButton WrapRemoveButton         AutoDeactivate  =   True         Bold            =   False         Cancel          =   False         Caption         =   "Remove"         Default         =   False         Enabled         =   True         Height          =   16         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "wrapgroup"         Italic          =   False         Left            =   308         LockBottom      =   False         LockedInPosition=   False         LockLeft        =   False         LockRight       =   False         LockTop         =   False         Scope           =   0         TabIndex        =   1         TabPanelIndex   =   0         TabStop         =   True         TextFont        =   "Smallsystem"         TextSize        =   0         Top             =   185         Underline       =   False         Visible         =   True         Width           =   120      End      Begin Label wrapremovehelp         AutoDeactivate  =   True         Bold            =   False         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   20         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "wrapgroup"         Italic          =   False         Left            =   41         LockBottom      =   False         LockedInPosition=   False         LockLeft        =   False         LockRight       =   False         LockTop         =   False         Multiline       =   False         Scope           =   0         TabIndex        =   2         TabPanelIndex   =   0         TabStop         =   True         Text            =   "Convert all titles to one-line titles"         TextAlign       =   0         TextColor       =   0         TextFont        =   "Smallsystem"         TextSize        =   0         Top             =   183         Underline       =   False         Visible         =   True         Width           =   258      End   EndEnd#tag EndWindow#tag WindowCode	#tag Event		Sub Close()		  dim dict as new dictionary		  dict.value("top") = top		  dict.value("left") = left		  dict.value("createnewfile") = createnewFileOption.value		  app.styledict = dict		End Sub	#tag EndEvent	#tag Event		Sub Open()		  dim dict as dictionary		  dim b as boolean		  dim i as integer		  		  dict = app.styledict		  if dict<>nil then		    if dict.getinteger("top",i) then top = i		    if dict.getinteger("left",i) then left = i		    self.setbounds(left,top,width,height)		    		    if dict.getboolean("createnewfile",b) then createNewFileOption.value = b		  end		  		  setlanguage		End Sub	#tag EndEvent	#tag MenuHandler		Function FileCLose() As Boolean Handles FileCLose.Action			self.close			return true		End Function	#tag EndMenuHandler	#tag Method, Flags = &h0		Sub SetLanguage()		  dim value as string		  dim cfr, ct as string		  dim i as integer		  dim languagedict as dictionary		  languagedict = app.languagedict		  		  if languagedict =nil then return		  		  		  if languagedict.getstring("styletitle", value) then title = value		  		  if languagedict.getstring("stylecreatenewfile", value) then createNewFileOption.caption = value		  		  if languagedict.getstring("stylecopy", value) then copygroup.caption = value		  if languagedict.getstring("stylereferencefile", value) then referencefilelabel.text = value		  if languagedict.getstring("stylerun", value) then copystyleButton.caption = value		  		  if languagedict.getstring("stylewrap", value) then wrapgroup.caption = value		  if languagedict.getstring("stylewrapcommithelp", value) then wrapcommithelp.text = value		  if languagedict.getstring("stylewrapcommit", value) then wrapcommitbutton.caption = value		  if languagedict.getstring("stylewrapremovehelp", value) then wrapremovehelp.text = value		  if languagedict.getstring("stylewrapremove", value) then wrapremovebutton.caption = value		  		  		  		  		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub UpdateTimecode(titlelist as edittitle, reflist as edittitle)		  dim titles(-1), title, reftitle as onetitle		  dim refdict as new dictionary		  		  titles = reflist.getallTitles		  for each title in titles		    title.parsetimeCode		    refdict.value(title.getfilename) = title		  next		  		  titles = titlelist.getAllTitles		  for each title in titles		    title.parseTimeCode		    if refdict.hasKey(title.getfilename) then		      reftitle = refdict.value(title.getfilename)		      title.setInOut(reftitle.getinpoint,reftitle.getoutpoint)		    end		  next		  titlelist.settitles(titles)		  		  		End Sub	#tag EndMethod#tag EndWindowCode#tag Events CopyStyleButton	#tag Event		Sub Action()		  dim titles() as oneTitle		  dim titlelist, reflist as edittitle		  dim m, r as main		  dim todo(-1), i, c as integer		  dim tc as timecode		  		  'if not app.reg.online then		  'msgBox "You need an online license to use this tool."		  'return		  'end		  		  m = documentselector1.getdocument		  if m<>nil then		    if createnewFileOption.value then		      m = m.clone		    end		    if m<>nil then		      r = referenceSelector.getDocument		      if r<> nil then		        m.style.clone r.style		        if createnewFileOption.value then		          titlelist.resetundo		          m.hasChanged = true		        end		        m.show		        m.touchhack		      end		    end		  end		  		  		  		End Sub	#tag EndEvent#tag EndEvents#tag Events WrapCommitButton	#tag Event		Sub Action()		  dim titles(-1) , title as oneTitle		  dim titlelist as edittitle		  dim preview as canvas3		  dim m, r as main		  dim todo(-1), i, c as integer		  dim tc as timecode		  dim d as dictionary		  		  'if not app.reg.online then		  'msgBox "You need an online license to use this tool."		  'return		  'end		  		  m = documentselector1.getdocument		  if m<>nil then		    if createnewFileOption.value then		      m = m.clone		    end		    if m<>nil then		      titlelist = m.titlelist		      preview =  m.preview		    end		    if titlelist<>nil then		      app.mouseCursor = system.cursors.wait		      		      titles = titlelist.getallTitles		      d = new dictionary		      for each title in titles		        d.value(title.filenamedefined) = 1		      next		      for each title in titles		        titlelist.preview title		        if preview.secondline<>"" then		          title.settext preview.firstline + endofLine + preview.secondline		        else		          title.settext preview.firstline		        end		        		      next		      		      titlelist.settitles titles		      		      		      app.mouseCursor = system.cursors.StandardPointer		      		      if createnewFileOption.value then		        titlelist.resetundo		        m.hasChanged = true		      end		      m.show		      m.touchhack		    end		  end		  		End Sub	#tag EndEvent#tag EndEvents#tag Events WrapRemoveButton	#tag Event		Sub Action()		  dim titles(-1) , title as oneTitle		  dim titlelist, reflist as edittitle		  dim m, r as main		  dim todo(-1), i, c as integer		  dim tc as timecode		  dim d as dictionary		  		  'if not app.reg.online then		  'msgBox "You need an online license to use this tool."		  'return		  'end		  		  m = documentselector1.getdocument		  if m<>nil then		    if createnewFileOption.value then		      m = m.clone		    end		    if m<>nil then		      titlelist = m.titlelist		    end		    if titlelist<>nil then		      app.mouseCursor = system.Cursors.wait		      		      titles = titlelist.getallTitles		      d = new dictionary		      for each title in titles		        d.value(title.filenamedefined) = 1		      next		      for each title in titles		        title.settext replaceall(title.gettext,endofLine," ")		      next		      		      titlelist.settitles titles		      		      		      app.mouseCursor = system.cursors.StandardPointer		      		      if createnewFileOption.value then		        titlelist.resetundo		        m.hasChanged = true		      end		      m.show		      m.touchhack		    end		  end		  		End Sub	#tag EndEvent#tag EndEvents