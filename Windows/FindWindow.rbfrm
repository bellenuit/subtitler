#tag WindowBegin Window FindWindow   BackColor       =   16777215   Backdrop        =   0   BalloonHelp     =   ""   CloseButton     =   True   Composite       =   False   Frame           =   8   FullScreen      =   False   HasBackColor    =   False   Height          =   135   ImplicitInstance=   True   LiveResize      =   False   MacProcID       =   0   MaxHeight       =   32000   MaximizeButton  =   False   MaxWidth        =   32000   MenuBar         =   0   MenuBarVisible  =   True   MinHeight       =   64   MinimizeButton  =   True   MinWidth        =   64   Placement       =   0   Resizeable      =   False   Title           =   "Find"   Visible         =   True   Width           =   499   Begin FindEditField FindText      AcceptTabs      =   False      Alignment       =   0      AutoDeactivate  =   True      BackColor       =   16777215      Bold            =   False      Border          =   True      CueText         =   ""      DataField       =   ""      DataSource      =   ""      deletekey       =   0      Enabled         =   True      Format          =   ""      Height          =   19      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   False      Left            =   103      LimitText       =   0      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   False      LockTop         =   False      Mask            =   ""      Password        =   False      ReadOnly        =   False      Scope           =   0      TabIndex        =   0      TabPanelIndex   =   0      TabStop         =   True      Text            =   ""      TextColor       =   0      TextFont        =   "Smallsystem"      TextSize        =   0      Top             =   7      Underline       =   False      UseFocusRing    =   True      Visible         =   True      Width           =   380   End   Begin PushButton CancelButton      AutoDeactivate  =   True      Bold            =   False      Cancel          =   True      Caption         =   "Cancel"      Default         =   False      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   False      Left            =   103      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   False      LockTop         =   False      Scope           =   0      TabIndex        =   1      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "System"      TextSize        =   0      Top             =   102      Underline       =   False      Visible         =   True      Width           =   100   End   Begin PushButton FindButton      AutoDeactivate  =   True      Bold            =   False      Cancel          =   False      Caption         =   "Find"      Default         =   True      Enabled         =   False      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   False      Left            =   372      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   False      LockTop         =   False      Scope           =   0      TabIndex        =   2      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "System"      TextSize        =   0      Top             =   102      Underline       =   False      Visible         =   True      Width           =   107   End   Begin PopupMenu FindKindMenu      AutoDeactivate  =   True      Bold            =   False      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      InitialValue    =   ""      Italic          =   False      Left            =   103      ListIndex       =   0      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   False      LockTop         =   False      Scope           =   0      TabIndex        =   3      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "Smallsystem"      TextSize        =   0      Top             =   70      Underline       =   False      Visible         =   True      Width           =   127   End   Begin Label FindLabel      AutoDeactivate  =   True      Bold            =   False      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   13      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   False      Left            =   13      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   False      LockTop         =   False      Multiline       =   False      Scope           =   0      TabIndex        =   4      TabPanelIndex   =   0      TabStop         =   True      Text            =   "Find"      TextAlign       =   0      TextColor       =   0      TextFont        =   "SmallSystem"      TextSize        =   0      Top             =   13      Underline       =   False      Visible         =   True      Width           =   78   End   Begin FindEditField ReplaceText      AcceptTabs      =   False      Alignment       =   0      AutoDeactivate  =   True      BackColor       =   16777215      Bold            =   False      Border          =   True      CueText         =   ""      DataField       =   ""      DataSource      =   ""      deletekey       =   0      Enabled         =   True      Format          =   ""      Height          =   19      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   False      Left            =   103      LimitText       =   0      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   False      LockTop         =   False      Mask            =   ""      Password        =   False      ReadOnly        =   False      Scope           =   0      TabIndex        =   5      TabPanelIndex   =   0      TabStop         =   True      Text            =   ""      TextColor       =   0      TextFont        =   "Smallsystem"      TextSize        =   0      Top             =   39      Underline       =   False      UseFocusRing    =   True      Visible         =   True      Width           =   380   End   Begin Label ReplaceLabel      AutoDeactivate  =   True      Bold            =   False      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   13      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   False      Left            =   13      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   False      LockTop         =   False      Multiline       =   False      Scope           =   0      TabIndex        =   6      TabPanelIndex   =   0      TabStop         =   True      Text            =   "Replace"      TextAlign       =   0      TextColor       =   0      TextFont        =   "SmallSystem"      TextSize        =   0      Top             =   45      Underline       =   False      Visible         =   True      Width           =   78   End   Begin CheckBox CapitalCheck      AutoDeactivate  =   True      Bold            =   False      Caption         =   "Capitals"      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   False      Left            =   250      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   False      LockTop         =   False      Scope           =   0      State           =   0      TabIndex        =   7      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "SmallSystem"      TextSize        =   0      Top             =   69      Underline       =   False      Value           =   False      Visible         =   True      Width           =   233   End   Begin PushButton ReplaceAllButton      AutoDeactivate  =   True      Bold            =   False      Cancel          =   True      Caption         =   "ReplaceAll"      Default         =   False      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   False      Left            =   218      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   False      LockTop         =   False      Scope           =   0      TabIndex        =   8      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "System"      TextSize        =   0      Top             =   102      Underline       =   False      Visible         =   True      Width           =   142   EndEnd#tag EndWindow#tag WindowCode	#tag Event		Sub Close()		  app.findtop = top		  app.findleft = left		End Sub	#tag EndEvent	#tag Event		Sub Open()		  'top = app.findtop		  'left = app.findleft		  setlanguage		End Sub	#tag EndEvent	#tag Method, Flags = &h0		Sub SetLanguage()		  dim value as string		  dim languagedict as dictionary		  languagedict = app.languagedict		  if languagedict =nil then return		  		  if languagedict.getstring("find", value) then self.title = value		  if languagedict.getstring("find", value) then findlabel.text = value		  if languagedict.getstring("replace", value) then replacelabel.text = value		  if languagedict.getstring("casesensitive", value) then capitalcheck.caption = value		  if languagedict.getstring("cancel", value) then cancelbutton.Caption = value		  if languagedict.getstring("replaceall", value) then replaceallbutton.caption = value		  if languagedict.getstring("find", value) then findbutton.caption = value		  		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub showreplace(rep as boolean, t as string)		  		  		  findtext.Readtext t		  replacetext.mydict = findtext.mydict		  		  		  		  replace = rep		  if replace then		    title = app.getlabel("Replace")		  else		    replacetext.top = -50		    replacelabel.top = -50		    replaceallbutton.visible = false		    capitalcheck.top = 39		    findkindmenu.top = 39		    cancelButton.top = 70		    cancelButton.left = 190		    findbutton.top = 70		    height = 100		  end		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub showreplacebutton(t as string)		  showreplace true, t		  findbutton.caption = app.getlabel("Replace")		End Sub	#tag EndMethod	#tag Property, Flags = &h0		replace As boolean	#tag EndProperty#tag EndWindowCode#tag Events FindText	#tag Event		Sub TextChangeEvent()		  if len(me.text)>0 then		    findbutton.enabled=true		  else		    findbutton.enabled=false		  end		End Sub	#tag EndEvent	#tag Event		Sub Close()		  app.findtext = me.text		End Sub	#tag EndEvent	#tag Event		Sub Open()		  me.text = ""		  me.seltext = app.findtext		End Sub	#tag EndEvent#tag EndEvents#tag Events CancelButton	#tag Event		Sub Action()		  close		End Sub	#tag EndEvent#tag EndEvents#tag Events FindButton	#tag Event		Sub Action()		  //// 1.1π2 adaption new parameter for find    // <-- CONVERTED		  		  dim st, la as integer		  dim ed as EditTitle		  		  ed = main(window(1)).titlelist		  		  if me.caption = app.getlabel("Replace") then		    ed.seltext = replacetext.escapedText		  end		  		  		  select case findkindMenu.listindex		  case 0		    st = ed.selstart		    la = len(ed.text)		  case 1		    st = 0		    la = len(ed.text)		  case 2		    st = ed.selstart		    la = st+ed.sellength		  end		  		  if replace then		    main(window(1)).replace findtext.escapedtext,st,la,capitalcheck.value,replacetext.escapedtext,false		  else		    main(window(1)).find findtext.escapedtext, st,la, capitalcheck.value		    close		  end		  		  		End Sub	#tag EndEvent#tag EndEvents#tag Events FindKindMenu	#tag Event		Sub Close()		  app.findwhere = me.listindex		End Sub	#tag EndEvent	#tag Event		Sub Open()		  // 1.1π2 new    // <-- CONVERTED		  		  me.deleteAllRows		  me.addrow app.getlabel("findfromhere")		  me.addrow app.getlabel("findfromstart")		  me.addrow app.getlabel("findselection")		  		  me.listindex = app.findwhere		End Sub	#tag EndEvent#tag EndEvents#tag Events ReplaceText	#tag Event		Sub Close()		  app.replacetext = me.text		End Sub	#tag EndEvent	#tag Event		Sub Open()		  me.text = ""		  me.seltext = app.replacetext		End Sub	#tag EndEvent#tag EndEvents#tag Events CapitalCheck	#tag Event		Sub Close()		  app.CapitalCheck = me.value		End Sub	#tag EndEvent	#tag Event		Sub Open()		  me.value = app.CapitalCheck		End Sub	#tag EndEvent#tag EndEvents#tag Events ReplaceAllButton	#tag Event		Sub Action()		  //// 1.1π2 adaption new parameter for find    // <-- CONVERTED		  		  dim st, la as integer		  dim ed as EditTitle		  		  ed = main(window(1)).titlelist		  		  select case findkindMenu.listindex		  case 0		    st = ed.selstart		    la = len(ed.text)		  case 1		    st = 0		    la = len(ed.text)		  case 2		    st = ed.selstart		    la = st+ed.sellength		  end		  		  main(window(1)).replace findtext.escapedtext,st,la,capitalcheck.value,replacetext.escapedtext,true		  close		End Sub	#tag EndEvent#tag EndEvents