#tag WindowBegin Window SpottingWindow   BackColor       =   16777215   Backdrop        =   0   BalloonHelp     =   ""   CloseButton     =   True   Composite       =   True   Frame           =   3   FullScreen      =   False   HasBackColor    =   False   Height          =   587   ImplicitInstance=   True   LiveResize      =   False   MacProcID       =   0   MaxHeight       =   32000   MaximizeButton  =   True   MaxWidth        =   32000   MenuBar         =   0   MenuBarVisible  =   True   MinHeight       =   64   MinimizeButton  =   True   MinWidth        =   64   Placement       =   0   Resizeable      =   False   Title           =   "Spotting"   Visible         =   True   Width           =   459   Begin DocumentSelector DocumentSelector1      AutoDeactivate  =   True      Bold            =   False      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   16      HelpTag         =   ""      includetemplates=   0      Index           =   -2147483648      InitialParent   =   ""      InitialValue    =   ""      Italic          =   False      Left            =   41      ListIndex       =   0      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   False      LockTop         =   False      Scope           =   0      TabIndex        =   0      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "Smallsystem"      TextSize        =   0      TextUnit        =   0      Top             =   14      Underline       =   False      Visible         =   True      Width           =   252   End   Begin GroupBox updatetimecodegroup      AutoDeactivate  =   True      Bold            =   False      Caption         =   "Update Timecode"      Enabled         =   True      Height          =   107      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   False      Left            =   14      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   False      LockTop         =   False      Scope           =   0      TabIndex        =   0      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   329      Underline       =   False      Visible         =   True      Width           =   428      Begin Label updatetimecodehelp         Active          =   ""         AutoDeactivate  =   True         Bold            =   False         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   20         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "updatetimecodegroup"         Italic          =   False         Left            =   43         LockBottom      =   False         LockedInPosition=   False         LockLeft        =   False         LockRight       =   False         LockTop         =   False         Multiline       =   False         Scope           =   0         Selectable      =   False         TabIndex        =   0         TabPanelIndex   =   0         TabStop         =   True         Text            =   "Update timecode based on common file comments"         TextAlign       =   0         TextColor       =   0         TextFont        =   "Smallsystem"         TextSize        =   0         Top             =   356         Transparent     =   False         Underline       =   False         Visible         =   True         Width           =   340         Window          =   0         _mWindow        =   0      End      Begin Label referencefilelabel         Active          =   ""         AutoDeactivate  =   True         Bold            =   False         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   20         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "updatetimecodegroup"         Italic          =   False         Left            =   43         LockBottom      =   False         LockedInPosition=   False         LockLeft        =   False         LockRight       =   False         LockTop         =   False         Multiline       =   False         Scope           =   0         Selectable      =   False         TabIndex        =   1         TabPanelIndex   =   0         TabStop         =   True         Text            =   "Reference"         TextAlign       =   0         TextColor       =   0         TextFont        =   "Smallsystem"         TextSize        =   0         Top             =   382         Transparent     =   False         Underline       =   False         Visible         =   True         Width           =   100         Window          =   0         _mWindow        =   0      End      Begin DocumentSelector ReferenceSelector         AutoDeactivate  =   True         Bold            =   False         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   16         HelpTag         =   ""         includetemplates=   0         Index           =   -2147483648         InitialParent   =   "updatetimecodegroup"         InitialValue    =   ""         Italic          =   False         Left            =   137         ListIndex       =   0         LockBottom      =   False         LockedInPosition=   False         LockLeft        =   False         LockRight       =   False         LockTop         =   False         Scope           =   0         TabIndex        =   0         TabPanelIndex   =   0         TabStop         =   True         TextFont        =   "Smallsystem"         TextSize        =   0         TextUnit        =   0         Top             =   382         Underline       =   False         Visible         =   True         Width           =   150      End      Begin PushButton UpdateTimecodeRunButton         AutoDeactivate  =   True         Bold            =   False         ButtonStyle     =   0         Cancel          =   False         Caption         =   "Run"         Default         =   False         Enabled         =   True         Height          =   16         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "updatetimecodegroup"         Italic          =   False         Left            =   307         LockBottom      =   False         LockedInPosition=   False         LockLeft        =   False         LockRight       =   False         LockTop         =   False         Scope           =   0         TabIndex        =   2         TabPanelIndex   =   0         TabStop         =   True         TextFont        =   "Smallsystem"         TextSize        =   0         TextUnit        =   0         Top             =   382         Underline       =   False         Visible         =   True         Width           =   120      End      Begin CheckBox RemoveUnreferencedTitlesOption         AutoDeactivate  =   True         Bold            =   False         Caption         =   "Remove unreferenced titles"         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   20         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "updatetimecodegroup"         Italic          =   False         Left            =   41         LockBottom      =   False         LockedInPosition=   False         LockLeft        =   False         LockRight       =   False         LockTop         =   False         Scope           =   0         State           =   1         TabIndex        =   3         TabPanelIndex   =   0         TabStop         =   True         TextFont        =   "Smallsystem"         TextSize        =   0         TextUnit        =   0         Top             =   410         Underline       =   False         Value           =   True         Visible         =   True         Width           =   377      End   End   Begin ProgressBar ProgressBar1      AutoDeactivate  =   True      Enabled         =   True      Height          =   12      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Left            =   23      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   False      LockTop         =   False      Maximum         =   100      Scope           =   0      TabIndex        =   2      TabPanelIndex   =   0      TabStop         =   True      Top             =   563      Value           =   0      Visible         =   False      Width           =   100   End   Begin CheckBox CreateNewFileOption      AutoDeactivate  =   True      Bold            =   False      Caption         =   "Create new file"      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   False      Left            =   304      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   False      LockTop         =   False      Scope           =   0      State           =   1      TabIndex        =   1      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "Smallsystem"      TextSize        =   0      TextUnit        =   0      Top             =   13      Underline       =   False      Value           =   True      Visible         =   True      Width           =   147   End   Begin GroupBox offsettimecodegroup      AutoDeactivate  =   True      Bold            =   False      Caption         =   "Offset Timecode"      Enabled         =   True      Height          =   65      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   False      Left            =   14      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   False      LockTop         =   False      Scope           =   0      TabIndex        =   2      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   45      Underline       =   False      Visible         =   True      Width           =   428      Begin CheckBox SelectionOnlyCheckbox         AutoDeactivate  =   True         Bold            =   False         Caption         =   "Selection only"         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   20         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "offsettimecodegroup"         Italic          =   False         Left            =   192         LockBottom      =   False         LockedInPosition=   False         LockLeft        =   False         LockRight       =   False         LockTop         =   False         Scope           =   0         State           =   1         TabIndex        =   0         TabPanelIndex   =   0         TabStop         =   True         TextFont        =   "Smallsystem"         TextSize        =   0         TextUnit        =   0         Top             =   75         Underline       =   False         Value           =   True         Visible         =   True         Width           =   123      End      Begin TextField OffsetField         AcceptTabs      =   False         Alignment       =   0         AutoDeactivate  =   True         AutomaticallyCheckSpelling=   False         BackColor       =   16777215         Bold            =   False         Border          =   True         CueText         =   ""         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Format          =   ""         Height          =   20         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "offsettimecodegroup"         Italic          =   False         Left            =   41         LimitText       =   0         LockBottom      =   False         LockedInPosition=   False         LockLeft        =   False         LockRight       =   False         LockTop         =   False         Mask            =   ""         Password        =   False         ReadOnly        =   False         Scope           =   0         TabIndex        =   1         TabPanelIndex   =   0         TabStop         =   True         Text            =   ""         TextColor       =   0         TextFont        =   "Smallsystem"         TextSize        =   0         TextUnit        =   0         Top             =   75         Underline       =   False         UseFocusRing    =   True         Visible         =   True         Width           =   144      End      Begin PushButton OffsetTimeCodeRunButton         AutoDeactivate  =   True         Bold            =   False         ButtonStyle     =   0         Cancel          =   False         Caption         =   "Run"         Default         =   False         Enabled         =   True         Height          =   16         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "offsettimecodegroup"         Italic          =   False         Left            =   307         LockBottom      =   False         LockedInPosition=   False         LockLeft        =   False         LockRight       =   False         LockTop         =   False         Scope           =   0         TabIndex        =   2         TabPanelIndex   =   0         TabStop         =   True         TextFont        =   "Smallsystem"         TextSize        =   0         TextUnit        =   0         Top             =   75         Underline       =   False         Visible         =   True         Width           =   120      End   End   Begin GroupBox changeframerategroup      AutoDeactivate  =   True      Bold            =   False      Caption         =   "Change Framerate"      Enabled         =   True      Height          =   115      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   False      Left            =   14      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   False      LockTop         =   False      Scope           =   0      TabIndex        =   3      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   121      Underline       =   False      Visible         =   True      Width           =   428      Begin PopUpMenu2 TCMenu         AutoDeactivate  =   True         Bold            =   False         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   20         HelpTag         =   ""         Index           =   0         InitialParent   =   "changeframerategroup"         InitialValue    =   ""         Italic          =   False         Left            =   41         ListIndex       =   0         LockBottom      =   False         LockedInPosition=   False         LockLeft        =   False         LockRight       =   False         LockTop         =   False         Scope           =   0         TabIndex        =   0         TabPanelIndex   =   0         TabStop         =   True         TextFont        =   "Smallsystem"         TextSize        =   0         TextUnit        =   0         Top             =   152         Underline       =   False         Visible         =   True         Width           =   100      End      Begin PopUpMenu2 TCMenu         AutoDeactivate  =   True         Bold            =   False         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   20         HelpTag         =   ""         Index           =   1         InitialParent   =   "changeframerategroup"         InitialValue    =   ""         Italic          =   False         Left            =   185         ListIndex       =   0         LockBottom      =   False         LockedInPosition=   False         LockLeft        =   False         LockRight       =   False         LockTop         =   False         Scope           =   0         TabIndex        =   0         TabPanelIndex   =   0         TabStop         =   True         TextFont        =   "Smallsystem"         TextSize        =   0         TextUnit        =   0         Top             =   152         Underline       =   False         Visible         =   True         Width           =   100      End      Begin Label StaticText3         Active          =   ""         AutoDeactivate  =   True         Bold            =   False         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   20         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "changeframerategroup"         Italic          =   False         Left            =   160         LockBottom      =   False         LockedInPosition=   False         LockLeft        =   False         LockRight       =   False         LockTop         =   False         Multiline       =   False         Scope           =   0         Selectable      =   False         TabIndex        =   0         TabPanelIndex   =   0         TabStop         =   True         Text            =   ">"         TextAlign       =   0         TextColor       =   0         TextFont        =   "System"         TextSize        =   0         Top             =   152         Transparent     =   False         Underline       =   False         Visible         =   True         Width           =   16         Window          =   0         _mWindow        =   0      End      Begin PopUpMenu2 TimeMenu         AutoDeactivate  =   True         Bold            =   False         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   20         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "changeframerategroup"         InitialValue    =   ""         Italic          =   False         Left            =   41         ListIndex       =   0         LockBottom      =   False         LockedInPosition=   False         LockLeft        =   False         LockRight       =   False         LockTop         =   False         Scope           =   0         TabIndex        =   0         TabPanelIndex   =   0         TabStop         =   True         TextFont        =   "Smallsystem"         TextSize        =   0         TextUnit        =   0         Top             =   180         Underline       =   False         Visible         =   True         Width           =   244      End      Begin PushButton ChangeFramerateRunButton         AutoDeactivate  =   True         Bold            =   False         ButtonStyle     =   0         Cancel          =   False         Caption         =   "Run"         Default         =   False         Enabled         =   True         Height          =   16         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "changeframerategroup"         Italic          =   False         Left            =   307         LockBottom      =   False         LockedInPosition=   False         LockLeft        =   False         LockRight       =   False         LockTop         =   False         Scope           =   0         TabIndex        =   1         TabPanelIndex   =   0         TabStop         =   True         TextFont        =   "Smallsystem"         TextSize        =   0         TextUnit        =   0         Top             =   208         Underline       =   False         Visible         =   True         Width           =   120      End      Begin TextField ChangeFrameRateReferenceFied         AcceptTabs      =   False         Alignment       =   0         AutoDeactivate  =   True         AutomaticallyCheckSpelling=   False         BackColor       =   16777215         Bold            =   False         Border          =   True         CueText         =   ""         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Format          =   ""         Height          =   20         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "changeframerategroup"         Italic          =   False         Left            =   135         LimitText       =   0         LockBottom      =   False         LockedInPosition=   False         LockLeft        =   False         LockRight       =   False         LockTop         =   False         Mask            =   ""         Password        =   False         ReadOnly        =   False         Scope           =   0         TabIndex        =   2         TabPanelIndex   =   0         TabStop         =   True         Text            =   ""         TextColor       =   0         TextFont        =   "Smallsystem"         TextSize        =   0         TextUnit        =   0         Top             =   206         Underline       =   False         UseFocusRing    =   True         Visible         =   True         Width           =   144      End      Begin Label referencefilelabel1         Active          =   ""         AutoDeactivate  =   True         Bold            =   False         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   20         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "changeframerategroup"         Italic          =   False         Left            =   43         LockBottom      =   False         LockedInPosition=   False         LockLeft        =   False         LockRight       =   False         LockTop         =   False         Multiline       =   False         Scope           =   0         Selectable      =   False         TabIndex        =   3         TabPanelIndex   =   0         TabStop         =   True         Text            =   "Reference"         TextAlign       =   0         TextColor       =   0         TextFont        =   "Smallsystem"         TextSize        =   0         Top             =   208         Transparent     =   False         Underline       =   False         Visible         =   True         Width           =   82         Window          =   0         _mWindow        =   0      End   End   Begin GroupBox filenamecommentsgroup      AutoDeactivate  =   True      Bold            =   False      Caption         =   "Filename comments"      Enabled         =   True      Height          =   65      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   False      Left            =   14      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   False      LockTop         =   False      Scope           =   0      TabIndex        =   4      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   252      Underline       =   False      Visible         =   True      Width           =   428      Begin PushButton FilenameAddButton         AutoDeactivate  =   True         Bold            =   False         ButtonStyle     =   0         Cancel          =   False         Caption         =   "Add"         Default         =   False         Enabled         =   True         Height          =   16         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "filenamecommentsgroup"         Italic          =   False         Left            =   41         LockBottom      =   False         LockedInPosition=   False         LockLeft        =   False         LockRight       =   False         LockTop         =   False         Scope           =   0         TabIndex        =   0         TabPanelIndex   =   0         TabStop         =   True         TextFont        =   "Smallsystem"         TextSize        =   0         TextUnit        =   0         Top             =   282         Underline       =   False         Visible         =   True         Width           =   120      End      Begin PushButton FilenameRemoveButton         AutoDeactivate  =   True         Bold            =   False         ButtonStyle     =   0         Cancel          =   False         Caption         =   "Remove"         Default         =   False         Enabled         =   True         Height          =   16         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "filenamecommentsgroup"         Italic          =   False         Left            =   307         LockBottom      =   False         LockedInPosition=   False         LockLeft        =   False         LockRight       =   False         LockTop         =   False         Scope           =   0         TabIndex        =   1         TabPanelIndex   =   0         TabStop         =   True         TextFont        =   "Smallsystem"         TextSize        =   0         TextUnit        =   0         Top             =   282         Underline       =   False         Visible         =   True         Width           =   120      End   End   Begin GroupBox offsettimecodegroup1      AutoDeactivate  =   True      Bold            =   False      Caption         =   "Remove Flash titles"      Enabled         =   True      Height          =   91      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   False      Left            =   14      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   False      LockTop         =   False      Scope           =   0      TabIndex        =   5      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   452      Underline       =   False      Visible         =   True      Width           =   428      Begin PushButton OffsetTimeCodeRunButton1         AutoDeactivate  =   True         Bold            =   False         ButtonStyle     =   0         Cancel          =   False         Caption         =   "Run"         Default         =   False         Enabled         =   True         Height          =   16         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "offsettimecodegroup1"         Italic          =   False         Left            =   307         LockBottom      =   False         LockedInPosition=   False         LockLeft        =   False         LockRight       =   False         LockTop         =   False         Scope           =   0         TabIndex        =   2         TabPanelIndex   =   0         TabStop         =   True         TextFont        =   "Smallsystem"         TextSize        =   0         TextUnit        =   0         Top             =   507         Underline       =   False         Visible         =   True         Width           =   120      End      Begin Label updatetimecodehelp1         Active          =   ""         AutoDeactivate  =   True         Bold            =   False         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   20         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "offsettimecodegroup1"         Italic          =   False         Left            =   41         LockBottom      =   False         LockedInPosition=   False         LockLeft        =   False         LockRight       =   False         LockTop         =   False         Multiline       =   False         Scope           =   0         Selectable      =   False         TabIndex        =   3         TabPanelIndex   =   0         TabStop         =   True         Text            =   "Removes subtitles that have a duration of 0 or 1 frames."         TextAlign       =   0         TextColor       =   0         TextFont        =   "Smallsystem"         TextSize        =   0         Top             =   475         Transparent     =   False         Underline       =   False         Visible         =   True         Width           =   386         Window          =   0         _mWindow        =   0      End   EndEnd#tag EndWindow#tag WindowCode	#tag Event		Sub Activate()		  documentSelector1.refreshlist		  referenceSelector.refreshlist		End Sub	#tag EndEvent	#tag Event		Sub Close()		  dim dict as new dictionary		  dim d as dictionary		  dict.value("top") = top		  dict.value("left") = left		  dict.value("createnewfile") = createnewFileOption.value		  d = new dictionary		  d.value("value") = offsetfield.text		  d.value("selectiononly") = selectionOnlyCheckbox.value		  dict.value("offsettimecode") = d		  d = new dictionary		  d.value("sourcerate") = tcmenu(0).text		  d.value("targetrate") = tcmenu(1).text		  d.value("timemoce") = timemenu.text		  dict.value("changeframerate") = d		  dict.value("removeunreferencedtitles") =removeunreferencedTitlesOption.value		  app.spottingdict = dict		End Sub	#tag EndEvent	#tag Event		Sub Open()		  dim s as string		  dim b as boolean		  dim i as integer		  dim dict,d as dictionary		  		  dict = app.spottingdict		  if dict<>nil then		    if dict.getinteger("top",i) then top = i		    if dict.getinteger("left",i) then left = i		    self.setbounds(left,top,width,height)		    if dict.getboolean("createnewfile",b) then createnewFileOption.value = b		    if dict.getdictionary("offsettimecode",d) then		      if d.getstring("value",s) then offsetfield.text = s		      if d.getboolean("selectiononly",b) then selectionOnlyCheckbox.value = b		    end		    if dict.getdictionary("changeframerate",d) then		      if d.getstring("sourcerate", s) then tcmenu(0).settext s		      if d.getstring("targetrate", s) then tcmenu(1).settext s		      if d.getstring("timemoce", s) then timemenu.settext s		    end		    if dict.getboolean("removeunreferencedtitles",b) then removeUnreferencedTitlesOption.value = b		  end		  		  setlanguage		End Sub	#tag EndEvent	#tag MenuHandler		Function FileCLose() As Boolean Handles FileCLose.Action			self.close			return true		End Function	#tag EndMenuHandler	#tag Method, Flags = &h0		Sub SetLanguage()		  dim value as string		  dim cfr, ct as string		  dim i as integer		  dim languagedict as dictionary		  languagedict = app.languagedict		  		  if languagedict =nil then return		  		  		  if languagedict.getstring("spottingtitle", value) then title = value		  		  if languagedict.getstring("spottingcreatenewfile", value) then createNewFileOption.caption = value		  		  if languagedict.getstring("spottingoffsettimecode", value) then offsettimecodegroup.caption = value		  if languagedict.getstring("spottingselectiononly", value) then selectionOnlyCheckbox.caption = value		  		  if languagedict.getstring("spottingchangeframerate", value) then changeframerategroup.caption = value		  if languagedict.getstring("spottingconstantframecount", value) then 		    cfr = value		  else		    cfr = "Constant Framecount"		  end		  if languagedict.getstring("spottingconstanttime", value) then 		    ct = value		  else		    ct = "Constant Time"		  end		  i = timemenu.listindex		  timemenu.init array(cfr,ct)		  timemenu.listindex = i		  		  if languagedict.getstring("spottingfilenamecomments", value) then filenamecommentsgroup.caption = value		  if languagedict.getstring("spottingfilenameadd", value) then filenameAddButton.caption = value		  if languagedict.getstring("spottingfilenameremove", value) then filenameremoveButton.caption = value		  		  if languagedict.getstring("spottingupdatetimecode", value) then updatetimecodegroup.caption = value		  if languagedict.getstring("SpottingUpdateTimecodeHelp", value) then updatetimecodehelp.text = value		  if languagedict.getstring("spottingreferencefile", value) then referencefilelabel.text = value		  		  if languagedict.getstring("spottingrun", value) then		    offsettimecoderunButton.caption = value		    changeframerateRunButton.caption = value		    updatetimecoderunButton.caption = value		  end		  if languagedict.getstring("spottingremoveunreferencedtitles", value) then removeUnreferencedTitlesOption.caption = value		  		  		  		  		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub UpdateTimecode(titlelist as edittitle, reflist as edittitle, removeuunreferenced as boolean)		  dim titles(-1), title, reftitle as onetitle		  dim refdict as new dictionary		  dim i,ub as integer		  		  titles = reflist.getallTitles		  for each title in titles		    title.parsetimeCode		    refdict.value(title.getfilename) = title		  next		  		  titles = titlelist.getAllTitles		  ub = ubound(titles)		  for i = ub downTo 0		    title = titles(i)		    title.parseTimeCode		    if refdict.hasKey(title.getfilename) then		      reftitle = refdict.value(title.getfilename)		      title.setInOut(reftitle.getinpoint,reftitle.getoutpoint)		    elseif removeuunreferenced then		      titles.remove i		    end		  next		  titlelist.settitles(titles)		  if removeuunreferenced then titlelist.sortTitles		  		  		End Sub	#tag EndMethod#tag EndWindowCode#tag Events UpdateTimecodeRunButton	#tag Event		Sub Action()		  dim titles() as oneTitle		  dim titlelist, reflist as edittitle		  dim m, r as main		  		  'if not app.reg.online then		  'msgBox "You need an online license to use this tool."		  'return		  'end		  		  m = documentselector1.getdocument		  if m<>nil then		    if createnewFileOption.value then		      m = m.clone		    end		    if m<>nil then titlelist = m.titlelist		    r = referenceSelector.getdocument		    if r<>nil then		      reflist = r.titlelist		    end		    if titlelist<>nil and reflist<>nil then		      updatetimecode titlelist, reflist, removeUnreferencedTitlesOption.value		      if createnewFileOption.value then		        titlelist.resetundo		        m.hasChanged = true		      end		      m.show		      m.touchhack		    end		  end		  		  		End Sub	#tag EndEvent#tag EndEvents#tag Events OffsetField	#tag Event		Sub Open()		  me.text = "00:00:00:00"		End Sub	#tag EndEvent#tag EndEvents#tag Events OffsetTimeCodeRunButton	#tag Event		Sub Action()		  dim titles() as oneTitle		  dim titlelist, reflist as edittitle		  dim m, r as main		  dim todo(-1), i, c as integer		  dim tc as timecode		  		  'if not app.reg.online then		  'msgBox "You need an online license to use this tool."		  'return		  'end		  		  m = documentselector1.getdocument		  if m<>nil then		    if createnewFileOption.value then		      m = m.clone		    end		    if m<>nil then		      titlelist = m.titlelist		      tc = m.style.getTimeCode		      tc.settext replaceall(offsetfield.text," ","")		    end		    if titlelist<>nil then		      app.mouseCursor = system.cursors.wait		      c = titlelist.titlecount		      for i = 1 to c		        if not selectionOnlyCheckbox.value then		          todo.append i		        elseif titlelist.titleinselection(i) then		          todo.append i		        end		      next		      titlelist.trimlist(todo,tc)		      app.mouseCursor = system.cursors.standardpointer		      		      if createnewFileOption.value then		        titlelist.resetundo		        m.hasChanged = true		      end		      m.show		      m.touchhack		    end		  end		  		  		End Sub	#tag EndEvent#tag EndEvents#tag Events TCMenu	#tag Event		Sub Open()		  me.addrow "23.98"		  me.addrow "24"		  me.addrow "25"		  me.addrow "29.97 DF"		  me.addrow "29.97 NDF"		  me.addrow "30"		  me.addrow "50"		  me.addrow "59.94"		  me.listindex = 1		End Sub	#tag EndEvent#tag EndEvents#tag Events TimeMenu	#tag Event		Sub Open()		  me.addrow "Constant Framecount"		  me.addrow "Constant Time"		  me.listindex = 1		End Sub	#tag EndEvent#tag EndEvents#tag Events ChangeFramerateRunButton	#tag Event		Sub Action()		  dim titles() as oneTitle		  dim titlelist, reflist as edittitle		  dim m, r as main		  dim todo(-1), i, c as integer		  dim tc as timecode		  		  'if not app.reg.online then		  'msgBox "You need an online license to use this tool."		  'return		  'end		  		  m = documentselector1.getdocument		  if m<>nil then		    if createnewFileOption.value then		      m = m.clone		    end		    if m<>nil then		      titlelist = m.titlelist		      tc = m.style.getTimeCode //??		      tc.settext offsetfield.text //??		    end		    if titlelist<>nil then		      app.mouseCursor = system.cursors.wait		      c = titlelist.titlecount		      for i = 1 to c		        todo.append i		      next		      titlelist.changeframeRatelist(todo,TCMenu(0).text,TCMenu(1).text,timemenu.listindex=1,ChangeFrameRateReferenceFied.text)		      		      app.mouseCursor = system.cursors.standardpointer		      		      if createnewFileOption.value then		        titlelist.resetundo		        m.hasChanged = true		      end		      m.show		      m.touchhack		    end		  end		  		  		End Sub	#tag EndEvent#tag EndEvents#tag Events ChangeFrameRateReferenceFied	#tag Event		Sub Open()		  me.text = "00:00:00:00"		End Sub	#tag EndEvent#tag EndEvents#tag Events FilenameAddButton	#tag Event		Sub Action()		  dim titles(-1) , title as oneTitle		  dim titlelist, reflist as edittitle		  dim m, r as main		  dim todo(-1), i, c as integer		  dim tc as timecode		  dim d as dictionary		  dim cnt as integer		  		  'if not app.reg.online then		  'msgBox "You need an online license to use this tool."		  'return		  'end		  		  m = documentselector1.getdocument		  if m<>nil then		    if createnewFileOption.value then		      m = m.clone		    end		    if m<>nil then		      titlelist = m.titlelist		      tc = m.style.getTimeCode		      tc.settext offsetfield.text		    end		    if titlelist<>nil then		      app.mouseCursor = system.cursors.wait		      		      titles = titlelist.getallTitles		      d = new dictionary		      for each title in titles		        d.value(title.filenamedefined) = 1		      next		      cnt=1		      for each title in titles		        if title.filenamedefined="" then		          while d.hasKey(format(cnt,"0000"))		            cnt = cnt + 1		          wend		          title.setitemFilename cnt		          d.value(title.filenamedefined) = 1		        end		      next		      		      titlelist.settitles titles		      		      		      app.mouseCursor = system.cursors.standardpointer		      		      if createnewFileOption.value then		        titlelist.resetundo		        m.hasChanged = true		      end		      m.show		      m.touchhack		    end		  end		  		End Sub	#tag EndEvent#tag EndEvents#tag Events FilenameRemoveButton	#tag Event		Sub Action()		  dim titles(-1) , title as oneTitle		  dim titlelist, reflist as edittitle		  dim m, r as main		  dim todo(-1), i, c as integer		  dim tc as timecode		  		  'if not app.reg.online then		  'msgBox "You need an online license to use this tool."		  'return		  'end		  		  m = documentselector1.getdocument		  if m<>nil then		    if createnewFileOption.value then		      m = m.clone		    end		    if m<>nil then		      titlelist = m.titlelist		      tc = m.style.getTimeCode		      tc.settext offsetfield.text		    end		    if titlelist<>nil then		      app.mouseCursor = system.cursors.wait		      		      titles = titlelist.getallTitles		      for each title in titles		        title.setfilename ""		      next		      titlelist.settitles titles		       		      		      app.mouseCursor = system.cursors.standardpointer		      		      if createnewFileOption.value then		        titlelist.resetundo		        m.hasChanged = true		      end		      m.show		      m.touchhack		    end		  end		  		End Sub	#tag EndEvent#tag EndEvents#tag Events OffsetTimeCodeRunButton1	#tag Event		Sub Action()		  dim titles() as oneTitle		  dim titlelist, reflist as edittitle		  dim m, r as main		  dim todo(-1), i, c as integer		  dim tc as timecode		  		  'if not app.reg.online then		  'msgBox "You need an online license to use this tool."		  'return		  'end		  		  m = documentselector1.getdocument		  if m<>nil then		    if createnewFileOption.value then		      m = m.clone		    end		    if m<>nil then		      titlelist = m.titlelist		      tc = m.style.getTimeCode		      tc.settext replaceall(offsetfield.text," ","")		    end		    if titlelist<>nil then		      app.mouseCursor = system.cursors.wait		      c = titlelist.titlecount		      for i = 1 to c		        if not selectionOnlyCheckbox.value then		          todo.append i		        elseif titlelist.titleinselection(i) then		          todo.append i		        end		      next		      titlelist.CleanFlashList(todo)		      app.mouseCursor = system.cursors.standardpointer		      		      if createnewFileOption.value then		        titlelist.resetundo		        m.hasChanged = true		      end		      m.show		      m.touchhack		    end		  end		  		  		End Sub	#tag EndEvent#tag EndEvents