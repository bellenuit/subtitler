#tag WindowBegin Window Main   BackColor       =   16777215   Backdrop        =   0   BalloonHelp     =   ""   CloseButton     =   True   Composite       =   True   Frame           =   0   FullScreen      =   False   HasBackColor    =   False   Height          =   523   ImplicitInstance=   True   LiveResize      =   False   MacProcID       =   0   MaxHeight       =   32000   MaximizeButton  =   True   MaxWidth        =   32000   MenuBar         =   0   MenuBarVisible  =   True   MinHeight       =   313   MinimizeButton  =   True   MinWidth        =   700   Placement       =   0   Resizeable      =   True   Title           =   "Untitled"   Visible         =   True   Width           =   702   Begin GroupBox GroupBox6      AutoDeactivate  =   True      Bold            =   False      Caption         =   "Export Format"      Enabled         =   True      Height          =   43      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   False      Left            =   137      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   False      LockTop         =   False      Scope           =   0      TabIndex        =   15      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "Smallsystem"      TextSize        =   0      TextUnit        =   0      Top             =   151      Underline       =   False      Visible         =   True      Width           =   554      Begin TextField ExportPrefixField         AcceptTabs      =   False         Alignment       =   0         AutoDeactivate  =   True         AutomaticallyCheckSpelling=   False         BackColor       =   16777215         Bold            =   False         Border          =   True         CueText         =   ""         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Format          =   ""         Height          =   17         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "GroupBox6"         Italic          =   False         Left            =   611         LimitText       =   0         LockBottom      =   False         LockedInPosition=   False         LockLeft        =   False         LockRight       =   False         LockTop         =   False         Mask            =   ""         Password        =   False         ReadOnly        =   False         Scope           =   0         TabIndex        =   0         TabPanelIndex   =   0         TabStop         =   True         Text            =   ""         TextColor       =   0         TextFont        =   "SmallSystem"         TextSize        =   0         TextUnit        =   0         Top             =   170         Underline       =   False         UseFocusRing    =   True         Visible         =   True         Width           =   69      End      Begin StaticText2 ExportPrefixLabel         Active          =   ""         AutoDeactivate  =   True         Bold            =   False         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   19         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "GroupBox6"         Italic          =   False         Left            =   563         LockBottom      =   False         LockedInPosition=   False         LockLeft        =   False         LockRight       =   False         LockTop         =   False         Multiline       =   False         Scope           =   0         Selectable      =   False         TabIndex        =   0         TabPanelIndex   =   0         TabStop         =   True         Text            =   "Prefix"         TextAlign       =   2         TextColor       =   0         TextFont        =   "Smallsystem"         TextSize        =   0         Top             =   169         Transparent     =   False         Underline       =   False         Visible         =   True         Width           =   42         Window          =   0         _mWindow        =   0      End   End   Begin UpDownArrows LittleArrows1      AcceptFocus     =   ""      AutoDeactivate  =   True      Enabled         =   True      Height          =   24      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Left            =   594      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   False      LockTop         =   False      Scope           =   0      TabIndex        =   0      TabPanelIndex   =   0      TabStop         =   True      Top             =   40      Visible         =   False      Width           =   13   End   Begin UpDownArrows LittleArrows2      AcceptFocus     =   ""      AutoDeactivate  =   True      Enabled         =   True      Height          =   24      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Left            =   594      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   False      LockTop         =   False      Scope           =   0      TabIndex        =   1      TabPanelIndex   =   0      TabStop         =   True      Top             =   65      Visible         =   False      Width           =   13   End   Begin UpDownArrows LittleArrows3      AcceptFocus     =   ""      AutoDeactivate  =   True      Enabled         =   True      Height          =   24      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Left            =   594      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   False      LockTop         =   False      Scope           =   0      TabIndex        =   2      TabPanelIndex   =   0      TabStop         =   True      Top             =   106      Visible         =   False      Width           =   13   End   Begin EditTitle Titlelist      AcceptTabs      =   False      Alignment       =   0      AutoDeactivate  =   True      AutomaticallyCheckSpelling=   True      BackColor       =   16777215      Bold            =   False      Border          =   True      changeignore    =   0      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Format          =   ""      Height          =   143      HelpTag         =   ""      HideSelection   =   True      Index           =   -2147483648      InitialParent   =   ""      isreplace       =   0      Italic          =   False      Left            =   -1      LimitText       =   0      LockBottom      =   True      LockedInPosition=   False      LockLeft        =   True      LockRight       =   True      LockTop         =   True      Mask            =   ""      Multiline       =   True      plain           =   0      ReadOnly        =   False      Scope           =   0      ScrollbarHorizontal=   False      ScrollbarVertical=   True      Styled          =   False      TabIndex        =   0      TabPanelIndex   =   0      TabStop         =   True      Text            =   ""      TextColor       =   0      TextFont        =   "Geneva"      TextSize        =   12      TextUnit        =   0      Top             =   367      Underline       =   False      UseFocusRing    =   True      Visible         =   True      Width           =   704   End   Begin GroupBox GroupBox1      AutoDeactivate  =   True      Bold            =   False      Caption         =   "Text"      Enabled         =   True      Height          =   110      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   False      Left            =   21      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   False      LockTop         =   False      Scope           =   0      TabIndex        =   0      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "Smallsystem"      TextSize        =   0      TextUnit        =   0      Top             =   21      Underline       =   False      Visible         =   True      Width           =   185      Begin PopupMenu FontMenu         AutoDeactivate  =   True         Bold            =   False         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   13         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "GroupBox1"         InitialValue    =   ""         Italic          =   False         Left            =   28         ListIndex       =   0         LockBottom      =   False         LockedInPosition=   False         LockLeft        =   False         LockRight       =   False         LockTop         =   False         Scope           =   0         TabIndex        =   0         TabPanelIndex   =   0         TabStop         =   True         TextFont        =   "Smallsystem"         TextSize        =   0         TextUnit        =   0         Top             =   39         Underline       =   False         Visible         =   True         Width           =   100      End      Begin CheckBox CheckBold         AutoDeactivate  =   True         Bold            =   True         Caption         =   "B"         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   14         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "GroupBox1"         Italic          =   False         Left            =   31         LockBottom      =   False         LockedInPosition=   False         LockLeft        =   False         LockRight       =   False         LockTop         =   False         Scope           =   0         State           =   0         TabIndex        =   1         TabPanelIndex   =   0         TabStop         =   True         TextFont        =   "Smallsystem"         TextSize        =   0         TextUnit        =   0         Top             =   60         Underline       =   False         Value           =   False         Visible         =   True         Width           =   27      End      Begin CheckBox CheckItalic         AutoDeactivate  =   True         Bold            =   False         Caption         =   "I"         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   15         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "GroupBox1"         Italic          =   True         Left            =   63         LockBottom      =   False         LockedInPosition=   False         LockLeft        =   False         LockRight       =   False         LockTop         =   False         Scope           =   0         State           =   0         TabIndex        =   2         TabPanelIndex   =   0         TabStop         =   True         TextFont        =   "Smallsystem"         TextSize        =   0         TextUnit        =   0         Top             =   60         Underline       =   False         Value           =   False         Visible         =   True         Width           =   33      End      Begin CheckBox CheckUnderline         AutoDeactivate  =   True         Bold            =   False         Caption         =   "U"         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   15         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "GroupBox1"         Italic          =   False         Left            =   95         LockBottom      =   False         LockedInPosition=   False         LockLeft        =   False         LockRight       =   False         LockTop         =   False         Scope           =   0         State           =   0         TabIndex        =   3         TabPanelIndex   =   0         TabStop         =   True         TextFont        =   "Smallsystem"         TextSize        =   0         TextUnit        =   0         Top             =   60         Underline       =   True         Value           =   False         Visible         =   True         Width           =   30      End      Begin RGBSelect TextColorBox         AcceptFocus     =   False         AcceptTabs      =   False         actcolor        =   0         AutoDeactivate  =   True         Backdrop        =   0         DoubleBuffer    =   False         Enabled         =   True         EraseBackground =   True         Height          =   15         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "GroupBox1"         Left            =   160         LockBottom      =   False         LockedInPosition=   False         LockLeft        =   False         LockRight       =   False         LockTop         =   False         Scope           =   0         TabIndex        =   0         TabPanelIndex   =   0         TabStop         =   True         Top             =   108         UseFocusRing    =   True         Visible         =   True         Width           =   32      End      Begin PopupMenu SizeMenu         AutoDeactivate  =   True         Bold            =   False         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   13         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "GroupBox1"         InitialValue    =   ""         Italic          =   False         Left            =   132         ListIndex       =   0         LockBottom      =   False         LockedInPosition=   False         LockLeft        =   False         LockRight       =   False         LockTop         =   False         Scope           =   0         TabIndex        =   4         TabPanelIndex   =   0         TabStop         =   True         TextFont        =   "Smallsystem"         TextSize        =   0         TextUnit        =   0         Top             =   39         Underline       =   False         Visible         =   True         Width           =   70      End      Begin PopupMenu TextAlpha         AutoDeactivate  =   True         Bold            =   False         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   13         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "GroupBox1"         InitialValue    =   ""         Italic          =   False         Left            =   132         ListIndex       =   0         LockBottom      =   False         LockedInPosition=   False         LockLeft        =   False         LockRight       =   False         LockTop         =   False         Scope           =   0         TabIndex        =   5         TabPanelIndex   =   0         TabStop         =   True         TextFont        =   "Smallsystem"         TextSize        =   0         TextUnit        =   0         Top             =   61         Underline       =   False         Visible         =   True         Width           =   70      End      Begin PopupMenu TextSoft         AutoDeactivate  =   True         Bold            =   False         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   13         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "GroupBox1"         InitialValue    =   ""         Italic          =   False         Left            =   132         ListIndex       =   0         LockBottom      =   False         LockedInPosition=   False         LockLeft        =   False         LockRight       =   False         LockTop         =   False         Scope           =   0         TabIndex        =   6         TabPanelIndex   =   0         TabStop         =   True         TextFont        =   "Smallsystem"         TextSize        =   0         TextUnit        =   0         Top             =   83         Underline       =   False         Visible         =   True         Width           =   70      End      Begin PopupMenu LeadingMenu         AutoDeactivate  =   True         Bold            =   False         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   13         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "GroupBox1"         InitialValue    =   ""         Italic          =   False         Left            =   30         ListIndex       =   0         LockBottom      =   False         LockedInPosition=   False         LockLeft        =   False         LockRight       =   False         LockTop         =   False         Scope           =   0         TabIndex        =   7         TabPanelIndex   =   0         TabStop         =   True         TextFont        =   "Smallsystem"         TextSize        =   0         TextUnit        =   0         Top             =   106         Underline       =   False         Visible         =   True         Width           =   95      End      Begin PopupMenu SpacingMenu         AutoDeactivate  =   True         Bold            =   False         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   13         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "GroupBox1"         InitialValue    =   ""         Italic          =   False         Left            =   30         ListIndex       =   0         LockBottom      =   False         LockedInPosition=   False         LockLeft        =   False         LockRight       =   False         LockTop         =   False         Scope           =   0         TabIndex        =   8         TabPanelIndex   =   0         TabStop         =   True         TextFont        =   "Smallsystem"         TextSize        =   0         TextUnit        =   0         Top             =   83         Underline       =   False         Visible         =   True         Width           =   95      End   End   Begin DisclosureTriangle StyleDT      AcceptFocus     =   ""      AutoDeactivate  =   True      Enabled         =   True      Facing          =   0      Height          =   12      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Left            =   5      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   False      LockTop         =   False      Scope           =   0      TabIndex        =   1      TabPanelIndex   =   0      TabStop         =   True      Top             =   4      Value           =   True      Visible         =   True      Width           =   12   End   Begin GroupBox GroupBox5      AutoDeactivate  =   True      Bold            =   False      Caption         =   "Videoformat"      Enabled         =   True      Height          =   43      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   False      Left            =   22      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   False      LockTop         =   False      Scope           =   0      TabIndex        =   2      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "Smallsystem"      TextSize        =   0      TextUnit        =   0      Top             =   151      Underline       =   False      Visible         =   True      Width           =   114      Begin PopupMenu VideoFormatMenu         AutoDeactivate  =   True         Bold            =   False         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   13         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "GroupBox5"         InitialValue    =   "PAL\rPAL 16:9\rNTSC\rNTSC 16:9"         Italic          =   False         Left            =   31         ListIndex       =   0         LockBottom      =   False         LockedInPosition=   False         LockLeft        =   False         LockRight       =   False         LockTop         =   False         Scope           =   0         TabIndex        =   0         TabPanelIndex   =   0         TabStop         =   True         TextFont        =   "Smallsystem"         TextSize        =   0         TextUnit        =   0         Top             =   170         Underline       =   False         Visible         =   True         Width           =   92      End   End   Begin Canvas3 Preview      AcceptFocus     =   False      AcceptTabs      =   False      aspectratio     =   0      AutoDeactivate  =   True      Backdrop        =   0      bold            =   0      buffer          =   0      DoubleBuffer    =   False      Enabled         =   True      EraseBackground =   True      Height          =   40      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      italic          =   0      Left            =   21      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   False      LockTop         =   False      Scope           =   0      spacing         =   0      TabIndex        =   0      TabPanelIndex   =   0      TabStop         =   True      textcolor       =   0      Top             =   311      underline       =   0      UseFocusRing    =   True      Visible         =   True      Width           =   670   End   Begin GroupBox GroupBox4      AutoDeactivate  =   True      Bold            =   False      Caption         =   "Vertical Position"      Enabled         =   True      Height          =   43      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   False      Left            =   464      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   False      LockTop         =   False      Scope           =   0      TabIndex        =   3      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "Smallsystem"      TextSize        =   0      TextUnit        =   0      Top             =   88      Underline       =   False      Visible         =   True      Width           =   228      Begin PopupMenu ValignMenu         AutoDeactivate  =   True         Bold            =   False         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   13         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "GroupBox4"         InitialValue    =   ""         Italic          =   False         Left            =   613         ListIndex       =   0         LockBottom      =   False         LockedInPosition=   False         LockLeft        =   False         LockRight       =   False         LockTop         =   False         Scope           =   0         TabIndex        =   0         TabPanelIndex   =   0         TabStop         =   True         TextFont        =   "Smallsystem"         TextSize        =   0         TextUnit        =   0         Top             =   108         Underline       =   False         Visible         =   True         Width           =   75      End      Begin avxPNumber VSlider         AutoDeactivate  =   True         Enabled         =   True         Height          =   17         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "GroupBox4"         Left            =   481         LineStep        =   1         LiveScroll      =   True         LockBottom      =   False         LockedInPosition=   False         LockLeft        =   False         LockRight       =   False         LockTop         =   False         Maximum         =   720         Minimum         =   0         PageStep        =   10         Scope           =   0         TabIndex        =   0         TabPanelIndex   =   0         TabStop         =   True         TickStyle       =   0         Top             =   108         Value           =   0         Visible         =   True         Width           =   80      End      Begin StaticText2 VLabel         Active          =   ""         AutoDeactivate  =   True         Bold            =   False         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   14         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "GroupBox4"         Italic          =   False         Left            =   554         LockBottom      =   False         LockedInPosition=   False         LockLeft        =   False         LockRight       =   False         LockTop         =   False         Multiline       =   False         Scope           =   0         Selectable      =   False         TabIndex        =   0         TabPanelIndex   =   0         TabStop         =   True         Text            =   0         TextAlign       =   2         TextColor       =   0         TextFont        =   "Smallsystem"         TextSize        =   0         Top             =   108         Transparent     =   False         Underline       =   False         Visible         =   True         Width           =   35         Window          =   0         _mWindow        =   0      End      Begin Label StaticText1         Active          =   ""         AutoDeactivate  =   True         Bold            =   False         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   13         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "GroupBox4"         Italic          =   False         Left            =   470         LockBottom      =   False         LockedInPosition=   False         LockLeft        =   False         LockRight       =   False         LockTop         =   False         Multiline       =   False         Scope           =   0         Selectable      =   False         TabIndex        =   1         TabPanelIndex   =   0         TabStop         =   True         Text            =   "Y"         TextAlign       =   0         TextColor       =   0         TextFont        =   "Smallsystem"         TextSize        =   0         Top             =   110         Transparent     =   False         Underline       =   False         Visible         =   True         Width           =   28         Window          =   0         _mWindow        =   0      End   End   Begin GroupBox GroupBox3      AutoDeactivate  =   True      Bold            =   False      Caption         =   "Horizontal Position"      Enabled         =   True      Height          =   68      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   False      Left            =   463      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   False      LockTop         =   False      Scope           =   0      TabIndex        =   4      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "Smallsystem"      TextSize        =   0      TextUnit        =   0      Top             =   21      Underline       =   False      Visible         =   True      Width           =   228      Begin PopupMenu HalignMenu         AutoDeactivate  =   True         Bold            =   False         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   13         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "GroupBox3"         InitialValue    =   ""         Italic          =   False         Left            =   612         ListIndex       =   0         LockBottom      =   False         LockedInPosition=   False         LockLeft        =   False         LockRight       =   False         LockTop         =   False         Scope           =   0         TabIndex        =   0         TabPanelIndex   =   0         TabStop         =   True         TextFont        =   "Smallsystem"         TextSize        =   0         TextUnit        =   0         Top             =   40         Underline       =   False         Visible         =   True         Width           =   75      End      Begin avxPNumber LSlider         AutoDeactivate  =   True         Enabled         =   True         Height          =   17         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "GroupBox3"         Left            =   480         LineStep        =   1         LiveScroll      =   True         LockBottom      =   False         LockedInPosition=   False         LockLeft        =   False         LockRight       =   False         LockTop         =   False         Maximum         =   576         Minimum         =   0         PageStep        =   10         Scope           =   0         TabIndex        =   0         TabPanelIndex   =   0         TabStop         =   True         TickStyle       =   0         Top             =   42         Value           =   0         Visible         =   True         Width           =   80      End      Begin StaticText2 LLabel         Active          =   ""         AutoDeactivate  =   True         Bold            =   False         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   17         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "GroupBox3"         Italic          =   False         Left            =   555         LockBottom      =   False         LockedInPosition=   False         LockLeft        =   False         LockRight       =   False         LockTop         =   False         Multiline       =   False         Scope           =   0         Selectable      =   False         TabIndex        =   0         TabPanelIndex   =   0         TabStop         =   True         Text            =   0         TextAlign       =   2         TextColor       =   0         TextFont        =   "Smallsystem"         TextSize        =   0         Top             =   38         Transparent     =   False         Underline       =   False         Visible         =   True         Width           =   35         Window          =   0         _mWindow        =   0      End      Begin avxPNumber RSlider         AutoDeactivate  =   True         Enabled         =   True         Height          =   17         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "GroupBox3"         Left            =   480         LineStep        =   1         LiveScroll      =   True         LockBottom      =   False         LockedInPosition=   False         LockLeft        =   False         LockRight       =   False         LockTop         =   False         Maximum         =   576         Minimum         =   0         PageStep        =   10         Scope           =   0         TabIndex        =   0         TabPanelIndex   =   0         TabStop         =   True         TickStyle       =   0         Top             =   67         Value           =   0         Visible         =   True         Width           =   80      End      Begin StaticText2 RLabel         Active          =   ""         AutoDeactivate  =   True         Bold            =   False         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   18         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "GroupBox3"         Italic          =   False         Left            =   555         LockBottom      =   False         LockedInPosition=   False         LockLeft        =   False         LockRight       =   False         LockTop         =   False         Multiline       =   False         Scope           =   0         Selectable      =   False         TabIndex        =   0         TabPanelIndex   =   0         TabStop         =   True         Text            =   0         TextAlign       =   2         TextColor       =   0         TextFont        =   "Smallsystem"         TextSize        =   0         Top             =   64         Transparent     =   False         Underline       =   False         Visible         =   True         Width           =   35         Window          =   0         _mWindow        =   0      End      Begin PopupMenu WrapMenu         AutoDeactivate  =   True         Bold            =   False         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   13         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "GroupBox3"         InitialValue    =   ""         Italic          =   False         Left            =   612         ListIndex       =   0         LockBottom      =   False         LockedInPosition=   False         LockLeft        =   False         LockRight       =   False         LockTop         =   False         Scope           =   0         TabIndex        =   1         TabPanelIndex   =   0         TabStop         =   True         TextFont        =   "Smallsystem"         TextSize        =   0         TextUnit        =   0         Top             =   65         Underline       =   False         Visible         =   True         Width           =   75      End      Begin StaticText2 LTextLabel         Active          =   ""         AutoDeactivate  =   True         Bold            =   False         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   13         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "GroupBox3"         Italic          =   False         Left            =   468         LockBottom      =   False         LockedInPosition=   False         LockLeft        =   False         LockRight       =   False         LockTop         =   False         Multiline       =   False         Scope           =   0         Selectable      =   False         TabIndex        =   0         TabPanelIndex   =   0         TabStop         =   True         Text            =   "L"         TextAlign       =   0         TextColor       =   0         TextFont        =   "Smallsystem"         TextSize        =   0         Top             =   41         Transparent     =   False         Underline       =   False         Visible         =   True         Width           =   73         Window          =   0         _mWindow        =   0      End      Begin StaticText2 StaticText3         Active          =   ""         AutoDeactivate  =   True         Bold            =   False         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   13         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "GroupBox3"         Italic          =   False         Left            =   468         LockBottom      =   False         LockedInPosition=   False         LockLeft        =   False         LockRight       =   False         LockTop         =   False         Multiline       =   False         Scope           =   0         Selectable      =   False         TabIndex        =   0         TabPanelIndex   =   0         TabStop         =   True         Text            =   "R"         TextAlign       =   0         TextColor       =   0         TextFont        =   "Smallsystem"         TextSize        =   0         Top             =   66         Transparent     =   False         Underline       =   False         Visible         =   True         Width           =   28         Window          =   0         _mWindow        =   0      End   End   Begin GroupBox GroupBox2      AutoDeactivate  =   True      Bold            =   False      Caption         =   "Border"      Enabled         =   True      Height          =   110      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   False      Left            =   209      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   False      LockTop         =   False      Scope           =   0      TabIndex        =   5      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "Smallsystem"      TextSize        =   0      TextUnit        =   0      Top             =   21      Underline       =   False      Visible         =   True      Width           =   80      Begin RGBSelect BorderColorBox         AcceptFocus     =   False         AcceptTabs      =   False         actcolor        =   0         AutoDeactivate  =   True         Backdrop        =   0         DoubleBuffer    =   False         Enabled         =   True         EraseBackground =   True         Height          =   15         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "GroupBox2"         Left            =   243         LockBottom      =   False         LockedInPosition=   False         LockLeft        =   False         LockRight       =   False         LockTop         =   False         Scope           =   0         TabIndex        =   0         TabPanelIndex   =   0         TabStop         =   True         Top             =   108         UseFocusRing    =   True         Visible         =   True         Width           =   32      End      Begin PopupMenu BorderWidth         AutoDeactivate  =   True         Bold            =   False         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   13         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "GroupBox2"         InitialValue    =   ""         Italic          =   False         Left            =   214         ListIndex       =   0         LockBottom      =   False         LockedInPosition=   False         LockLeft        =   False         LockRight       =   False         LockTop         =   False         Scope           =   0         TabIndex        =   0         TabPanelIndex   =   0         TabStop         =   True         TextFont        =   "Smallsystem"         TextSize        =   0         TextUnit        =   0         Top             =   61         Underline       =   False         Visible         =   True         Width           =   70      End      Begin PopupMenu BorderAlpha         AutoDeactivate  =   True         Bold            =   False         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   13         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "GroupBox2"         InitialValue    =   ""         Italic          =   False         Left            =   214         ListIndex       =   0         LockBottom      =   False         LockedInPosition=   False         LockLeft        =   False         LockRight       =   False         LockTop         =   False         Scope           =   0         TabIndex        =   1         TabPanelIndex   =   0         TabStop         =   True         TextFont        =   "Smallsystem"         TextSize        =   0         TextUnit        =   0         Top             =   39         Underline       =   False         Visible         =   True         Width           =   70      End      Begin PopupMenu Bordersoft         AutoDeactivate  =   True         Bold            =   False         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   13         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "GroupBox2"         InitialValue    =   ""         Italic          =   False         Left            =   214         ListIndex       =   0         LockBottom      =   False         LockedInPosition=   False         LockLeft        =   False         LockRight       =   False         LockTop         =   False         Scope           =   0         TabIndex        =   2         TabPanelIndex   =   0         TabStop         =   True         TextFont        =   "Smallsystem"         TextSize        =   0         TextUnit        =   0         Top             =   84         Underline       =   False         Visible         =   True         Width           =   70      End   End   Begin ShadowSelect ShadowMarker      AcceptFocus     =   False      AcceptTabs      =   False      AutoDeactivate  =   True      Backdrop        =   0      DoubleBuffer    =   False      Enabled         =   True      EraseBackground =   True      Height          =   40      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Left            =   301      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   False      LockTop         =   False      Scope           =   0      TabIndex        =   0      TabPanelIndex   =   0      TabStop         =   True      Top             =   82      UseFocusRing    =   True      Visible         =   True      Width           =   40   End   Begin Timer Timer1      Height          =   32      Index           =   -2147483648      InitialParent   =   ""      Left            =   385      LockedInPosition=   False      Mode            =   0      Period          =   500      Scope           =   0      TabIndex        =   13      TabPanelIndex   =   0      TabStop         =   True      Top             =   138      Width           =   32   End   Begin DisclosureTriangle PreviewDT      AcceptFocus     =   ""      AutoDeactivate  =   True      Enabled         =   True      Facing          =   0      Height          =   12      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Left            =   5      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   False      LockTop         =   False      Scope           =   0      TabIndex        =   6      TabPanelIndex   =   0      TabStop         =   True      Top             =   294      Value           =   True      Visible         =   True      Width           =   12   End   Begin StaticText2 StyleLabel      Active          =   ""      AutoDeactivate  =   True      Bold            =   False      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   15      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   False      Left            =   23      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   False      LockTop         =   False      Multiline       =   False      Scope           =   0      Selectable      =   False      TabIndex        =   0      TabPanelIndex   =   0      TabStop         =   True      Text            =   "Style"      TextAlign       =   0      TextColor       =   0      TextFont        =   "Smallsystem"      TextSize        =   0      Top             =   4      Transparent     =   False      Underline       =   False      Visible         =   True      Width           =   668      Window          =   0      _mWindow        =   0   End   Begin StaticText2 PreviewLabel      Active          =   ""      AutoDeactivate  =   True      Bold            =   False      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   15      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   False      Left            =   23      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   False      LockTop         =   False      Multiline       =   False      Scope           =   0      Selectable      =   False      TabIndex        =   0      TabPanelIndex   =   0      TabStop         =   True      Text            =   "Preview"      TextAlign       =   0      TextColor       =   0      TextFont        =   "Smallsystem"      TextSize        =   0      Top             =   294      Transparent     =   False      Underline       =   False      Visible         =   True      Width           =   668      Window          =   0      _mWindow        =   0   End   Begin PushButton FolderButton      AutoDeactivate  =   True      Bold            =   False      ButtonStyle     =   0      Cancel          =   False      Caption         =   "Export Folder"      Default         =   False      Enabled         =   True      Height          =   19      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   False      Left            =   252      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   False      LockTop         =   False      Scope           =   0      TabIndex        =   7      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "Smallsystem"      TextSize        =   0      TextUnit        =   0      Top             =   169      Underline       =   False      Visible         =   True      Width           =   317   End   Begin PopupMenu ExportFormatMenu      AutoDeactivate  =   True      Bold            =   False      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   13      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      InitialValue    =   "PICT\rTIFF-RLE\rTIFF\r"      Italic          =   False      Left            =   147      ListIndex       =   0      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   False      LockTop         =   False      Scope           =   0      TabIndex        =   8      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "Smallsystem"      TextSize        =   0      TextUnit        =   0      Top             =   170      Underline       =   False      Visible         =   True      Width           =   98   End   Begin DisclosureTriangle ExportDT      AcceptFocus     =   ""      AutoDeactivate  =   True      Enabled         =   True      Facing          =   0      Height          =   12      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Left            =   5      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   False      LockTop         =   False      Scope           =   0      TabIndex        =   9      TabPanelIndex   =   0      TabStop         =   True      Top             =   139      Value           =   True      Visible         =   True      Width           =   12   End   Begin StaticText2 ExportLabel      Active          =   ""      AutoDeactivate  =   True      Bold            =   False      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   15      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   False      Left            =   23      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   False      LockTop         =   False      Multiline       =   False      Scope           =   0      Selectable      =   False      TabIndex        =   0      TabPanelIndex   =   0      TabStop         =   True      Text            =   "Export"      TextAlign       =   0      TextColor       =   0      TextFont        =   "Smallsystem"      TextSize        =   0      Top             =   139      Transparent     =   False      Underline       =   False      Visible         =   True      Width           =   669      Window          =   0      _mWindow        =   0   End   Begin ProgressBar progress      AutoDeactivate  =   True      Enabled         =   True      Height          =   12      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Left            =   1      LockBottom      =   True      LockedInPosition=   False      LockLeft        =   True      LockRight       =   False      LockTop         =   False      Maximum         =   100      Scope           =   0      TabIndex        =   21      TabPanelIndex   =   0      TabStop         =   True      Top             =   510      Value           =   0      Visible         =   False      Width           =   100   End   Begin RGBSelect RectColorBox      AcceptFocus     =   False      AcceptTabs      =   False      actcolor        =   0      AutoDeactivate  =   True      Backdrop        =   0      DoubleBuffer    =   False      Enabled         =   True      EraseBackground =   True      Height          =   15      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Left            =   423      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   False      LockTop         =   False      Scope           =   0      TabIndex        =   0      TabPanelIndex   =   0      TabStop         =   True      Top             =   108      UseFocusRing    =   True      Visible         =   True      Width           =   32   End   Begin GroupBox ShadowGroup      AutoDeactivate  =   True      Bold            =   False      Caption         =   "Shadow"      Enabled         =   True      Height          =   110      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   False      Left            =   291      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   False      LockTop         =   False      Scope           =   0      TabIndex        =   10      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "Smallsystem"      TextSize        =   0      TextUnit        =   0      Top             =   21      Underline       =   False      Visible         =   True      Width           =   91      Begin PopupMenu ShadowSoft         AutoDeactivate  =   True         Bold            =   False         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   13         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "ShadowGroup"         InitialValue    =   ""         Italic          =   False         Left            =   297         ListIndex       =   0         LockBottom      =   False         LockedInPosition=   False         LockLeft        =   False         LockRight       =   False         LockTop         =   False         Scope           =   0         TabIndex        =   0         TabPanelIndex   =   0         TabStop         =   True         TextFont        =   "Smallsystem"         TextSize        =   0         TextUnit        =   0         Top             =   61         Underline       =   False         Visible         =   True         Width           =   70      End      Begin PopupMenu ShadowAlpha         AutoDeactivate  =   True         Bold            =   False         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   13         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "ShadowGroup"         InitialValue    =   ""         Italic          =   False         Left            =   297         ListIndex       =   0         LockBottom      =   False         LockedInPosition=   False         LockLeft        =   False         LockRight       =   False         LockTop         =   False         Scope           =   0         TabIndex        =   1         TabPanelIndex   =   0         TabStop         =   True         TextFont        =   "Smallsystem"         TextSize        =   0         TextUnit        =   0         Top             =   39         Underline       =   False         Visible         =   True         Width           =   70      End      Begin RGBSelect ShadowColorBox         AcceptFocus     =   False         AcceptTabs      =   False         actcolor        =   0         AutoDeactivate  =   True         Backdrop        =   0         DoubleBuffer    =   False         Enabled         =   True         EraseBackground =   True         Height          =   15         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "ShadowGroup"         Left            =   344         LockBottom      =   False         LockedInPosition=   False         LockLeft        =   False         LockRight       =   False         LockTop         =   False         Scope           =   0         TabIndex        =   0         TabPanelIndex   =   0         TabStop         =   True         Top             =   108         UseFocusRing    =   True         Visible         =   True         Width           =   32      End   End   Begin GroupBox GroupBox8      AutoDeactivate  =   True      Bold            =   False      Caption         =   "Box"      Enabled         =   True      Height          =   110      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   False      Left            =   384      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   False      LockTop         =   False      Scope           =   0      TabIndex        =   11      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "Smallsystem"      TextSize        =   0      TextUnit        =   0      Top             =   21      Underline       =   False      Visible         =   True      Width           =   78      Begin PopupMenu RectSoft         AutoDeactivate  =   True         Bold            =   False         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   13         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "GroupBox8"         InitialValue    =   ""         Italic          =   False         Left            =   388         ListIndex       =   0         LockBottom      =   False         LockedInPosition=   False         LockLeft        =   False         LockRight       =   False         LockTop         =   False         Scope           =   0         TabIndex        =   0         TabPanelIndex   =   0         TabStop         =   True         TextFont        =   "Smallsystem"         TextSize        =   0         TextUnit        =   0         Top             =   84         Underline       =   False         Visible         =   True         Width           =   70      End      Begin PopupMenu RectAlpha         AutoDeactivate  =   True         Bold            =   False         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   13         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "GroupBox8"         InitialValue    =   ""         Italic          =   False         Left            =   388         ListIndex       =   0         LockBottom      =   False         LockedInPosition=   False         LockLeft        =   False         LockRight       =   False         LockTop         =   False         Scope           =   0         TabIndex        =   1         TabPanelIndex   =   0         TabStop         =   True         TextFont        =   "Smallsystem"         TextSize        =   0         TextUnit        =   0         Top             =   39         Underline       =   False         Visible         =   True         Width           =   70      End      Begin PopUpMenu2 RectForm         AutoDeactivate  =   True         Bold            =   False         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   13         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "GroupBox8"         InitialValue    =   ""         Italic          =   False         Left            =   388         ListIndex       =   0         LockBottom      =   False         LockedInPosition=   False         LockLeft        =   False         LockRight       =   False         LockTop         =   False         Scope           =   0         TabIndex        =   0         TabPanelIndex   =   0         TabStop         =   True         TextFont        =   "Smallsystem"         TextSize        =   0         TextUnit        =   0         Top             =   61         Underline       =   False         Visible         =   True         Width           =   70      End   End   Begin DisclosureTriangle MovieDT      AcceptFocus     =   ""      AutoDeactivate  =   True      Enabled         =   True      Facing          =   0      Height          =   12      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Left            =   5      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   False      LockTop         =   False      Scope           =   0      TabIndex        =   12      TabPanelIndex   =   0      TabStop         =   True      Top             =   194      Value           =   True      Visible         =   True      Width           =   12   End   Begin StaticText2 MovieLabel      Active          =   ""      AutoDeactivate  =   True      Bold            =   False      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   15      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   False      Left            =   23      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   False      LockTop         =   False      Multiline       =   False      Scope           =   0      Selectable      =   False      TabIndex        =   0      TabPanelIndex   =   0      TabStop         =   True      Text            =   "Movie"      TextAlign       =   0      TextColor       =   0      TextFont        =   "Smallsystem"      TextSize        =   0      Top             =   194      Transparent     =   False      Underline       =   False      Visible         =   True      Width           =   700      Window          =   0      _mWindow        =   0   End   Begin BetterMoviePlayer MoviePlayer1      AutoDeactivate  =   True      AutoPlay        =   ""      AutoResize      =   False      Border          =   True      Controller      =   0      framerate       =   0      HasStep         =   True      Height          =   180      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      inpoint         =   0      Left            =   21      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   False      LockTop         =   False      Looping         =   False      Movie           =   0      outpoint        =   0      Palindrome      =   False      PlayerType      =   0      Scope           =   0      Speaker         =   True      TabIndex        =   0      TabPanelIndex   =   0      TabStop         =   True      Top             =   211      Visible         =   False      wavevolume      =   0      Width           =   320   End   Begin GroupBox MovieGroup      AutoDeactivate  =   True      Bold            =   False      Caption         =   ""      Enabled         =   True      Height          =   200      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   False      Left            =   358      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   False      LockTop         =   False      Scope           =   0      TabIndex        =   13      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "Smallsystem"      TextSize        =   0      TextUnit        =   0      Top             =   211      Underline       =   False      Visible         =   True      Width           =   220      Begin StaticText2 StaticText4         Active          =   ""         AutoDeactivate  =   True         Bold            =   False         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   20         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "MovieGroup"         Italic          =   False         Left            =   379         LockBottom      =   False         LockedInPosition=   False         LockLeft        =   False         LockRight       =   False         LockTop         =   False         Multiline       =   False         Scope           =   0         Selectable      =   False         TabIndex        =   0         TabPanelIndex   =   0         TabStop         =   True         Text            =   "Offset:"         TextAlign       =   2         TextColor       =   0         TextFont        =   "Smallsystem"         TextSize        =   0         Top             =   244         Transparent     =   False         Underline       =   False         Visible         =   True         Width           =   61         Window          =   0         _mWindow        =   0      End      Begin TextField MovieOffsetField         AcceptTabs      =   False         Alignment       =   0         AutoDeactivate  =   True         AutomaticallyCheckSpelling=   False         BackColor       =   16777215         Bold            =   False         Border          =   True         CueText         =   ""         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Format          =   ""         Height          =   18         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "MovieGroup"         Italic          =   False         Left            =   448         LimitText       =   0         LockBottom      =   False         LockedInPosition=   False         LockLeft        =   False         LockRight       =   False         LockTop         =   False         Mask            =   ""         Password        =   False         ReadOnly        =   False         Scope           =   0         TabIndex        =   0         TabPanelIndex   =   0         TabStop         =   True         Text            =   "00:00:00:00"         TextColor       =   0         TextFont        =   "Smallsystem"         TextSize        =   0         TextUnit        =   0         Top             =   244         Underline       =   False         UseFocusRing    =   True         Visible         =   True         Width           =   120      End      Begin CheckBox MovieSyncOption         AutoDeactivate  =   True         Bold            =   False         Caption         =   "Sync"         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   20         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "MovieGroup"         Italic          =   False         Left            =   445         LockBottom      =   False         LockedInPosition=   False         LockLeft        =   False         LockRight       =   False         LockTop         =   False         Scope           =   0         State           =   0         TabIndex        =   1         TabPanelIndex   =   0         TabStop         =   True         TextFont        =   "Smallsystem"         TextSize        =   0         TextUnit        =   0         Top             =   268         Underline       =   False         Value           =   False         Visible         =   True         Width           =   120      End      Begin StaticText2 StaticText5         Active          =   ""         AutoDeactivate  =   True         Bold            =   False         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   20         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "MovieGroup"         Italic          =   False         Left            =   379         LockBottom      =   False         LockedInPosition=   False         LockLeft        =   False         LockRight       =   False         LockTop         =   False         Multiline       =   False         Scope           =   0         Selectable      =   False         TabIndex        =   0         TabPanelIndex   =   0         TabStop         =   True         Text            =   "Position:"         TextAlign       =   2         TextColor       =   0         TextFont        =   "Smallsystem"         TextSize        =   0         Top             =   292         Transparent     =   False         Underline       =   False         Visible         =   True         Width           =   61         Window          =   0         _mWindow        =   0      End      Begin StaticText2 MoviePositionLabel         Active          =   ""         AutoDeactivate  =   True         Bold            =   False         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   20         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "MovieGroup"         Italic          =   False         Left            =   449         LockBottom      =   False         LockedInPosition=   False         LockLeft        =   False         LockRight       =   False         LockTop         =   False         Multiline       =   False         Scope           =   0         Selectable      =   False         TabIndex        =   0         TabPanelIndex   =   0         TabStop         =   True         Text            =   "00:00:00:00"         TextAlign       =   0         TextColor       =   0         TextFont        =   "Smallsystem"         TextSize        =   0         Top             =   292         Transparent     =   False         Underline       =   False         Visible         =   True         Width           =   120         Window          =   0         _mWindow        =   0      End      Begin StaticText2 StaticText6         Active          =   ""         AutoDeactivate  =   True         Bold            =   False         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   20         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "MovieGroup"         Italic          =   False         Left            =   379         LockBottom      =   False         LockedInPosition=   False         LockLeft        =   False         LockRight       =   False         LockTop         =   False         Multiline       =   False         Scope           =   0         Selectable      =   False         TabIndex        =   0         TabPanelIndex   =   0         TabStop         =   True         Text            =   "In:"         TextAlign       =   2         TextColor       =   0         TextFont        =   "Smallsystem"         TextSize        =   0         Top             =   316         Transparent     =   False         Underline       =   False         Visible         =   True         Width           =   61         Window          =   0         _mWindow        =   0      End      Begin StaticText2 MovieMarkInLabel         Active          =   ""         AutoDeactivate  =   True         Bold            =   False         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   20         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "MovieGroup"         Italic          =   False         Left            =   449         LockBottom      =   False         LockedInPosition=   False         LockLeft        =   False         LockRight       =   False         LockTop         =   False         Multiline       =   False         Scope           =   0         Selectable      =   False         TabIndex        =   0         TabPanelIndex   =   0         TabStop         =   True         Text            =   "00:00:00:00"         TextAlign       =   0         TextColor       =   0         TextFont        =   "Smallsystem"         TextSize        =   0         Top             =   316         Transparent     =   False         Underline       =   False         Visible         =   True         Width           =   120         Window          =   0         _mWindow        =   0      End      Begin StaticText2 StaticText8         Active          =   ""         AutoDeactivate  =   True         Bold            =   False         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   20         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "MovieGroup"         Italic          =   False         Left            =   379         LockBottom      =   False         LockedInPosition=   False         LockLeft        =   False         LockRight       =   False         LockTop         =   False         Multiline       =   False         Scope           =   0         Selectable      =   False         TabIndex        =   0         TabPanelIndex   =   0         TabStop         =   True         Text            =   "Out:"         TextAlign       =   2         TextColor       =   0         TextFont        =   "Smallsystem"         TextSize        =   0         Top             =   340         Transparent     =   False         Underline       =   False         Visible         =   True         Width           =   61         Window          =   0         _mWindow        =   0      End      Begin StaticText2 MovieMarkOutLabel         Active          =   ""         AutoDeactivate  =   True         Bold            =   False         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   20         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "MovieGroup"         Italic          =   False         Left            =   449         LockBottom      =   False         LockedInPosition=   False         LockLeft        =   False         LockRight       =   False         LockTop         =   False         Multiline       =   False         Scope           =   0         Selectable      =   False         TabIndex        =   0         TabPanelIndex   =   0         TabStop         =   True         Text            =   "00:00:00:00"         TextAlign       =   0         TextColor       =   0         TextFont        =   "Smallsystem"         TextSize        =   0         Top             =   340         Transparent     =   False         Underline       =   False         Visible         =   True         Width           =   120         Window          =   0         _mWindow        =   0      End      Begin StaticText2 StaticText10         Active          =   ""         AutoDeactivate  =   True         Bold            =   False         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   20         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "MovieGroup"         Italic          =   False         Left            =   379         LockBottom      =   False         LockedInPosition=   False         LockLeft        =   False         LockRight       =   False         LockTop         =   False         Multiline       =   False         Scope           =   0         Selectable      =   False         TabIndex        =   0         TabPanelIndex   =   0         TabStop         =   True         Text            =   "Status:"         TextAlign       =   2         TextColor       =   0         TextFont        =   "Smallsystem"         TextSize        =   0         Top             =   388         Transparent     =   False         Underline       =   False         Visible         =   True         Width           =   61         Window          =   0         _mWindow        =   0      End      Begin StaticText2 MovieStatusLabel         Active          =   ""         AutoDeactivate  =   True         Bold            =   False         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   20         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "MovieGroup"         Italic          =   False         Left            =   449         LockBottom      =   False         LockedInPosition=   False         LockLeft        =   False         LockRight       =   False         LockTop         =   False         Multiline       =   False         Scope           =   0         Selectable      =   False         TabIndex        =   0         TabPanelIndex   =   0         TabStop         =   True         Text            =   "Stop"         TextAlign       =   0         TextColor       =   0         TextFont        =   "Smallsystem"         TextSize        =   0         Top             =   388         Transparent     =   False         Underline       =   False         Visible         =   True         Width           =   120         Window          =   0         _mWindow        =   0      End      Begin StaticText2 StaticText7         Active          =   ""         AutoDeactivate  =   True         Bold            =   False         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   20         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "MovieGroup"         Italic          =   False         Left            =   379         LockBottom      =   False         LockedInPosition=   False         LockLeft        =   False         LockRight       =   False         LockTop         =   False         Multiline       =   False         Scope           =   0         Selectable      =   False         TabIndex        =   0         TabPanelIndex   =   0         TabStop         =   True         Text            =   "Framerate:"         TextAlign       =   2         TextColor       =   0         TextFont        =   "Smallsystem"         TextSize        =   0         Top             =   219         Transparent     =   False         Underline       =   False         Visible         =   True         Width           =   61         Window          =   0         _mWindow        =   0      End      Begin PopupMenu FrameRateMenu         AutoDeactivate  =   True         Bold            =   False         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   13         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "MovieGroup"         InitialValue    =   ""         Italic          =   False         Left            =   448         ListIndex       =   0         LockBottom      =   False         LockedInPosition=   False         LockLeft        =   False         LockRight       =   False         LockTop         =   False         Scope           =   0         TabIndex        =   2         TabPanelIndex   =   0         TabStop         =   True         TextFont        =   "SmallSystem"         TextSize        =   0         TextUnit        =   0         Top             =   220         Underline       =   False         Visible         =   True         Width           =   120      End      Begin StaticText2 MovieDurationTextLabel         Active          =   ""         AutoDeactivate  =   True         Bold            =   False         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   20         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "MovieGroup"         Italic          =   False         Left            =   379         LockBottom      =   False         LockedInPosition=   False         LockLeft        =   False         LockRight       =   False         LockTop         =   False         Multiline       =   False         Scope           =   0         Selectable      =   False         TabIndex        =   0         TabPanelIndex   =   0         TabStop         =   True         Text            =   "Duration:"         TextAlign       =   2         TextColor       =   0         TextFont        =   "Smallsystem"         TextSize        =   0         Top             =   364         Transparent     =   False         Underline       =   False         Visible         =   True         Width           =   61         Window          =   0         _mWindow        =   0      End      Begin StaticText2 MovieDurationLabel         Active          =   ""         AutoDeactivate  =   True         Bold            =   False         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   20         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "MovieGroup"         Italic          =   False         Left            =   449         LockBottom      =   False         LockedInPosition=   False         LockLeft        =   False         LockRight       =   False         LockTop         =   False         Multiline       =   False         Scope           =   0         Selectable      =   False         TabIndex        =   0         TabPanelIndex   =   0         TabStop         =   True         Text            =   "00:00:00:00"         TextAlign       =   0         TextColor       =   0         TextFont        =   "Smallsystem"         TextSize        =   0         Top             =   364         Transparent     =   False         Underline       =   False         Visible         =   True         Width           =   120         Window          =   0         _mWindow        =   0      End   End   Begin Timer MovieTimer      Height          =   32      Index           =   -2147483648      InitialParent   =   ""      Left            =   560      LockedInPosition=   False      Mode            =   0      Period          =   200      Scope           =   0      TabIndex        =   29      TabPanelIndex   =   0      TabStop         =   True      Top             =   218      Width           =   32   End   Begin Canvas MovieCanvas      AcceptFocus     =   True      AcceptTabs      =   False      AutoDeactivate  =   True      Backdrop        =   0      DoubleBuffer    =   False      Enabled         =   True      EraseBackground =   True      Height          =   170      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Left            =   21      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   False      LockTop         =   False      Scope           =   0      TabIndex        =   14      TabPanelIndex   =   0      TabStop         =   True      Top             =   206      UseFocusRing    =   True      Visible         =   False      Width           =   311   End   Begin Timeline Timeline1      AcceptFocus     =   False      AcceptTabs      =   False      AutoDeactivate  =   True      Backdrop        =   0      DoubleBuffer    =   False      duration        =   0      Enabled         =   True      EraseBackground =   True      Height          =   26      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Left            =   160      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   False      LockTop         =   False      position        =   0      Scope           =   0      TabIndex        =   0      TabPanelIndex   =   0      TabStop         =   True      Top             =   292      UseFocusRing    =   True      Visible         =   True      waveform        =   0      Width           =   200   End   Begin EventReceiver EventReceiver1      Height          =   32      Index           =   -2147483648      InitialParent   =   ""      Left            =   554      LockedInPosition=   False      Scope           =   0      TabIndex        =   32      TabPanelIndex   =   0      TabStop         =   True      Top             =   138      Width           =   32   End   Begin WaveformCanvas WaveCanvas      AcceptFocus     =   False      AcceptTabs      =   False      AutoDeactivate  =   True      Backdrop        =   0      DoubleBuffer    =   False      Enabled         =   True      EraseBackground =   True      Height          =   26      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Left            =   194      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   False      LockTop         =   False      markin          =   0      markout         =   0      Scope           =   0      TabIndex        =   0      TabPanelIndex   =   0      TabStop         =   True      Top             =   302      UseFocusRing    =   True      Visible         =   False      Width           =   200   End   Begin Canvas Titlelistselector      AcceptFocus     =   False      AcceptTabs      =   False      AutoDeactivate  =   True      Backdrop        =   0      DoubleBuffer    =   False      Enabled         =   True      EraseBackground =   True      Height          =   158      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Left            =   686      LockBottom      =   True      LockedInPosition=   False      LockLeft        =   False      LockRight       =   True      LockTop         =   True      Scope           =   0      TabIndex        =   16      TabPanelIndex   =   0      TabStop         =   True      Top             =   364      UseFocusRing    =   True      Visible         =   True      Width           =   17   End   Begin HTMLViewer HTMLViewer1      AutoDeactivate  =   True      Enabled         =   True      Height          =   49      HelpTag         =   ""      Index           =   -2147483648      Left            =   158      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      Renderer        =   1      Scope           =   0      TabIndex        =   17      TabPanelIndex   =   0      TabStop         =   True      Top             =   207      Visible         =   False      Width           =   48   EndEnd#tag EndWindow#tag WindowCode	#tag Event		Sub Activate()		  dim i as integer		  app.actmain = self		  app.style = style		End Sub	#tag EndEvent	#tag Event		Function CancelClose(appQuitting as Boolean) As Boolean		  if closeanywayprop then return false		  app.actmain = self 		  if haschanged then		    savechanges.showmodalwithin me // does not work ??		    select case savechanges.buttonPressed		    case "NoSave"		    case "Cancel"		      return true		    case "Save"		      savedocument title,false		    end select		    savechanges.close		  end if		End Function	#tag EndEvent	#tag Event		Sub Close()		  if closeanywayprop  then return		  		  		  app.mainleft = self.left		  app.maintop = self.top		  app.mainwidth = self.width		  app.mainheight = self.height		  app.exportformat = exportformat		  		  		  // looking for crash		  movietimer.mode = 0		  movieplayer1.movie = nil		  timer1.mode = 0		  		  		exception err as nilobjectException		  msgBox "Serious error in Main.Close. Please contact developer"		  		End Sub	#tag EndEvent	#tag Event		Sub EnableMenuItems()		  if disablemenus then return		  		  		  'appleaboutsubtitler.enabled = true		  'fileimport.enabled = true		  if len(titlelist.text) > 0 then		    fileexport.enable		    'exportothertext.enable		    'exportotherCinetypTimeCode.enable		    'exportotherDS.enable		    'exportotherEDL.enable		    'exportotherFCPXML.enable		    'exportotherQuickTimeText.enable		    'exportotherSonicSSTGraphic.enable		    'exportotherSonicSSTText.enable		    'exportotherSTL.enable		    'exportotherSTLText.enable		    'exportothersubrip.enable		    'exportothersubstationAlpha.enable		    'exportothersubtitler1.enable		    'exportotherEBU.enable		    editfind.enabled = true		    editreplace.enabled = true		    if findtext<>"" then		      editfindagain.enabled = true		    end		    fileprint.enabled = true		    toolsExport.enable		  end		  fileclose.enabled = true		  filepagesetup.enabled = true		  if haschanged then		    filesave.enabled = true		  end if		  filesaveas.enabled = true		  filenew.enabled = true		  fileopen.enabled = true		  windowsmonitor.enabled = true		  windowssettings.enabled = true		  		  titlelist.enablemenus		  		  if moviePlayer1.movie <> nil then		    fileRemoveMovie.enable		    spottingPlayForward.enable		    spottingstop.enable		    spottingplaybackward.enable		    spottingMarkIn.enable		    spottingMarkOut.enable		    if titlelist.titlecount > 0 then		      spottingmarktitle.enable		    end		    if movieplayer1.inpoint < movieplayer1.outpoint then		      spottingnewTitle.enable		      spottingupdateTimecode.enable		    end		    spottingincreaseWavefom.enable		    spottingreduceWaveform.enable		  end		  		  if titlelist.titlecount > 0 then		    spottingsplitTitle.enable		  end		  if titlelist.titlecount > 1 then		    spottingjoinTitle.enable		    spottingsortbyTimecode.enable		  end		  		End Sub	#tag EndEvent	#tag Event		Function KeyDown(Key As String) As Boolean		  		  		  		  if key = chr(27) then		    setmovieFocus false		    		    titlelist.setfocus		    'lasttitle = 0 // stop export titles		    return true		  end		  		  		  if moviefocus then		    movieplayer1.keydown(key)		    return true		  end		  		End Function	#tag EndEvent	#tag Event		Sub Open()		  dim i, screenwidth as integer		  dim found as boolean		  // must be top of all		  		  opening = true		  		  styledt.value = false		  exportdt.value = false		  moviedt.value = false		  previewdt.value  = true		  		  		  exportformat = app.exportformat		  if style = nil then		    msgbox StErrorNoStyle		    quit		  end if		  document = app.openingfile		  app.openingfile = nil		  if document <> nil then		    opendocument		  end if		  		  // guess maximal screen		  for i = 0 to screencount-1		    screenwidth = screenwidth + screen(i).width		  next		  		  'beep		  if left <0 or left > screenwidth-minwidth then		    left = min(left,screenwidth-minwidth)		    if left<0 then left = 0		  end		  if top <48 or top > screen(0).height-minheight then		    top = min(top,screen(0).height-minheight)		    if top < 48 then top = 48		  end		  width = max(width,minwidth)		  height = max(height,minheight)		  'beep		  setlanguage		  		  found = false		  for i = 0 to fontmenu.listcount-1		    if style.font = fontmenu.list(i) then		      fontmenu.listindex = i		      found = true		    end if		  next		  // π5 error message when font is not found.    // <-- CONVERTED		  if not found then		    MsgBox Replace(STErrorFontNotFound, "^1", style.font)		  end		  found = false		  for i = 0 to sizemenu.listcount-1		    if style.size = val(sizemenu.list(i)) then		      sizemenu.listindex = i		      found = true		    end if		  next		  if not found then		    sizemenu.addrow str(style.size)		    sizemenu.listindex = sizemenu.listcount - 1		  end		  checkbold.value = style.bold		  checkitalic.value = style.italic		  checkunderline.value = style.underline		  		  textcolorbox.selcolor = style.textc		  for i = 0 to textalpha.listcount-1		    if style.textalpha *100= val(textalpha.list(i)) then		      textalpha.listindex = i		    end if		  next		  		  for i = 0 to textsoft.listcount-1		    if style.textsoft= val(textsoft.list(i)) then		      textsoft.listindex = i		    end if		  next		  		  for i = 0 to leadingmenu.listcount-1		    if style.leading= val(leadingmenu.list(i)) then		      leadingmenu.listindex = i		    end if		  next		  		  for i = 0 to spacingmenu.listcount-1		    if style.spacing= val(spacingmenu.list(i)) then		      spacingmenu.listindex = i		    end if		  next		  		  for i = 0 to borderalpha.listcount-1		    if style.borderalpha *100= val(borderalpha.list(i)) then		      borderalpha.listindex = i		    end if		  next		  		  for i = 0 to borderwidth.listcount-1		    if style.borderwidth= val(borderwidth.list(i)) then		      borderwidth.listindex = i		    end if		  next		  		  for i = 0 to bordersoft.listcount-1		    if style.bordersoft= val(bordersoft.list(i)) then		      bordersoft.listindex = i		    end if		  next		  		  bordercolorbox.selcolor = style.borderc		  		  		  for i = 0 to shadowalpha.listcount-1		    if style.shadowalpha *100= val(shadowalpha.list(i)) then		      shadowalpha.listindex = i		    end if		  next		  		  for i = 0 to shadowsoft.listcount-1		    if style.shadowsoft= val(shadowsoft.list(i)) then		      shadowsoft.listindex = i		    end if		  next		  		  shadowmarker.shadowselect style.shadowx, style.shadowy		  shadowcolorBox.selcolor = style.shadowc		  		  		  		  for i = 0 to rectalpha.listcount-1		    if style.rectalpha *100= val(rectalpha.list(i)) then		      rectalpha.listindex = i		    end if		  next		  		  		  for i = 0 to rectsoft.listcount-1		    if style.rectsoft= val(rectsoft.list(i)) then		      rectsoft.listindex = i		    end if		  next		  rectcolorBox.selcolor = style.rectc		  		  if style.rectform>0 then		    rectform.listindex = style.rectform-1		  end		  		  if style.right.value <= style.left.value then		    style.right.value = style.left.value + 1		  end		  		  lslider.avxpnumber(0,style.width,style.width*0.1,style.left,llabel,timer1)		  rslider.avxpnumber(0,style.width,style.width*0.9,style.right,rlabel,timer1)		  		  		  halignmenu.listindex = style.halign		  		  vslider.avxpnumber(0,style.height,style.height*0.75,style.ver,vlabel,timer1)		  valignmenu.listindex = style.valign		  		  		  wrapmenu.listindex = style.wrapmethod		  		  		  for i = 0 to videoformatmenu.listcount-1		    if style.standard = videoformatmenu.list(i) then		      videoformatmenu.listindex = i		    end if		  next		  		  		  for i = 0 to exportformatmenu.listcount-1		    if exportformat = exportformatmenu.list(i) then		      exportformatmenu.listindex = i		    end if		  next		  		  if folderpath <> "" then folderbutton.caption = folderpath'		  		  		  		  for i = 0 to frameratemenu.listcount-1		    if style.framerate = frameratemenu.list(i) then		      frameratemenu.listindex = i		    end if		  next		  		  		  haschanged=false		  opening =false		  		  setformat //preview.setformat		  setlayout		  setwidth		  		  		  'beep		  setlayout		  		  		  app.actmain = self		  		  		  		exception err as nilobjectException		  msgBox "Serious error in Main.Open. Please contact developer"		  		End Sub	#tag EndEvent	#tag Event		Sub Resized()		  // 1.1π2 setlayout because scrollbar was partially covered by grow box    // <-- CONVERTED		  		  setlayout		End Sub	#tag EndEvent	#tag MenuHandler		Function EditFind() As Boolean Handles EditFind.Action			findWindow.showreplace false, titlelist.text			return true		End Function	#tag EndMenuHandler	#tag MenuHandler		Function EditFindAgain() As Boolean Handles EditFindAgain.Action			// 1.1π2 selstart is not changed any more. adaption new parameter for find    // <-- CONVERTED						if titlelist.seltext = findtext then			titlelist.sellength = 0			end			find findtext, titlelist.selstart+len(findtext),len(titlelist.text),PCapitalcheck			return true		End Function	#tag EndMenuHandler	#tag MenuHandler		Function EditRedo() As Boolean Handles EditRedo.Action			titlelist.redo			titlelist.setfocus			return true		End Function	#tag EndMenuHandler	#tag MenuHandler		Function EditReplace() As Boolean Handles EditReplace.Action			'findwindow.showwithin self			findWindow.showreplace true, titlelist.text			return true		End Function	#tag EndMenuHandler	#tag MenuHandler		Function EditUndo() As Boolean Handles EditUndo.Action			titlelist.undo			titlelist.setfocus			return true		End Function	#tag EndMenuHandler	#tag MenuHandler		Function FileCLose() As Boolean Handles FileCLose.Action			self.close			return true		End Function	#tag EndMenuHandler	#tag MenuHandler		Function FileExport() As Boolean Handles FileExport.Action			dim f as folderItem			dim fd as selectFolderDialog			// check for valid folderitem 1.4/ 16.4.3			f = getfolderItem(folderpath)			if folderpath = "" or f=nil then			fd = new selectFolderDialog			fd.ActionButtonCaption = "Export folder"			f = fd.ShowModalwithin(me)			//f = fd.ShowModalWithin(me)			'f = selectfolder			if f<>nil then			offlineWarning			folderpath = f.absolutePath			'folderpathlabel.text = folderpath			setlayout			haschanged = true			ExportTitle			end			else			exporttitle			end 			return true		End Function	#tag EndMenuHandler	#tag MenuHandler		Function FileExportother() As Boolean Handles FileExportother.Action			exportWindow.show			return true		End Function	#tag EndMenuHandler	#tag MenuHandler		Function FileImportMovie() As Boolean Handles FileImportMovie.Action			return fileimportmoviecommand		End Function	#tag EndMenuHandler	#tag MenuHandler		Function FilePageSetup() As Boolean Handles FilePageSetup.Action			dim ps as printerSetup			ps = new printersetup			if pageSetup<> "" then			ps.setupString=pagesetup			end			if ps.pagesetupDialog then			pagesetup= ps.setupString			app.pagesetup = ps.setupstring			end			return true		End Function	#tag EndMenuHandler	#tag MenuHandler		Function FilePrint() As Boolean Handles FilePrint.Action			dim g as graphics			dim ps as printersetup			dim pagewidth,pageheight,pgnumber,blockheight as integer			dim i,j,lines,size as integer			dim x,y as integer			dim xt,yt as integer			dim xd,yd,xp as integer			dim textsize, commentsize, commentheight as integer			dim texty, commenty as integer			dim acttitle as onetitle			dim firstline,secondline,s as string			ps = new printersetup			if pagesetup <>"" then			ps.setupstring=pagesetup			pagewidth = ps.width			pageheight = ps.height			g = openprinterdialog(ps)			else			if ps.pagesetupDialog then			pagesetup= ps.setupString			app.pagesetup = ps.setupstring			end			if ps=nil then			pagewidth = 72*7.5			pageheight = 72*9			else			pagewidth = ps.width			pageheight = ps.height			end			g = openprinterdialog(ps)			end			if g<> nil then			xt = pagewidth*0.98			yt = pageheight*0.95			xd = pagewidth*0.07			yd = pageheight*0.05			xp = 10						g.textfont = style.font			g.textsize = 12			textsize = 12			commentsize = 10			size = g.textsize*1.5			g.textsize = commentsize			commentheight = g.textheight						pgnumber = 0			y = yt+1						for i=1 to titlelist.titlecount			x = xd						acttitle = titlelist.gettitle(i)			preview.bold =style.bold			preview.italic = style.italic			preview.underline = style.underline			'preview.setformat			preview.text acttitle.gettext			previewlabel.settext app.getlabel("print")+" "+acttitle.getfilename			firstline = preview.firstline			secondline = preview.secondline						blockheight = 0			if acttitle.comment <>"" then 			blockheight = blockheight + size  * countFields(acttitle.comment,endofline)			end			if secondline <> "" then			blockheight = blockheight + size			end						if y+blockheight > yt then			if pgnumber > 0 then			if pgnumber < g.firstPage then			g.clearrect 0,0,g.width,g.height			elseif pgnumber < g.lastPage then			g.nextpage			else			return true			end			end			pgnumber = pgnumber +1			y = yd +size			g.drawstring "Belle Nuit Subtitler " + title +" " + app.getlabel("Page") +" "+ str(pgnumber),x,y			y=y+2*size			end						g.textsize = commentsize						commenty = y+textsize-commentsize			x = xd + (xt-xd)/3 - xp						if instr(acttitle.comment,"/file")=0 then			s = "/file " + acttitle.getfilename			g.drawstring s,x-g.stringwidth(s),y			commenty=commenty+commentheight			end						if replaceall(acttitle.comment," ","") <>"" then			for j = 1 to countFields(acttitle.comment,endofline)			s = nthfield(acttitle.comment,endofline,j)			g.drawstring s,x-g.stringwidth(s),commenty			commenty=commenty+commentheight			next			end						//add duration and reading speed			g.italic = true			s = trim(acttitle.durationString + " " + acttitle.lengthString+ " " + acttitle.readingSpeedString)			g.drawstring s,x-g.stringwidth(s),commenty			commenty=commenty+commentheight			g.italic = false						x = xd + (xt-xd)/3			texty = y						g.textsize = textsize			g.drawstring firstline,x,texty			texty=texty+size						if secondline <>"" then			g.drawstring secondline,x,texty			texty=texty+size			end						y = max(texty,commenty-commentheight+size) + commentheight						x=xd			next						end			return true		End Function	#tag EndMenuHandler	#tag MenuHandler		Function FileRemoveMovie() As Boolean Handles FileRemoveMovie.Action			setmoviefile nil			return true		End Function	#tag EndMenuHandler	#tag MenuHandler		Function FileSave() As Boolean Handles FileSave.Action			savedocument(title,false)			return true		End Function	#tag EndMenuHandler	#tag MenuHandler		Function FileSaveAs() As Boolean Handles FileSaveAs.Action			savedocument(title,true)			return true		End Function	#tag EndMenuHandler	#tag MenuHandler		Function FileSaveasTemplate() As Boolean Handles FileSaveasTemplate.Action			dim sd as saveasDialog			dim file as folderitem			dim folder as folderitem									sd = new saveasDialog			sd.Filter = "Subtitler"			sd.suggestedFileName = title			folder = app.gettemplatesFolder			if folder = nil then return true			sd.InitialDirectory = folder						sd.disclosure = false //unused						file = sd.showmodal			if file <> nil then			savetoFile file			end									app.parsetemplateFolder			return true		End Function	#tag EndMenuHandler	#tag MenuHandler		Function SpottingIncreaseWavefom() As Boolean Handles SpottingIncreaseWavefom.Action			movieplayer1.wavevolume = movieplayer1.wavevolume * 2			movieplayer1.setwaveform		End Function	#tag EndMenuHandler	#tag MenuHandler		Function SpottingJoinTitle() As Boolean Handles SpottingJoinTitle.Action			jointitle			return true		End Function	#tag EndMenuHandler	#tag MenuHandler		Function SpottingMarkIn() As Boolean Handles SpottingMarkIn.Action			setmoviefocus			movieplayer1.markin movieplayer1.position			'movieplayer1.setwaveform			return true		End Function	#tag EndMenuHandler	#tag MenuHandler		Function SpottingMarkOut() As Boolean Handles SpottingMarkOut.Action			setmoviefocus			movieplayer1.markout movieplayer1.position			'movieplayer1.setwaveform			return true		End Function	#tag EndMenuHandler	#tag MenuHandler		Function SpottingMarkTitle() As Boolean Handles SpottingMarkTitle.Action			dim t as onetitle			dim tc, tcin, tcout, tcoffset as timecode						tcoffset = style.getTimeCode			tcoffset.settext movieoffsetField.text			tc = style.gettimeCode			tcin = style.getTimeCode			tcout = style.getTimeCode						t = titlelist.gettitle(titlelist.getfirstselectedtitle)			if t<>nil then			t.parsetimeCode			if t.getinpoint<>"" and t.getoutpoint<>"" then			tcin.settext t.getinpoint			tcout.settext t.getoutpoint			setmarks tcin, tcout			tcin.minus tcoffset			tcout.minus tcoffset			movieplayer1.markin tcin.gettotalSeconds			movieplayer1.markout  tcout.gettotalSeconds			movieplayer1.setwaveform			end			else			beep			end			return true		End Function	#tag EndMenuHandler	#tag MenuHandler		Function SpottingNewTitle() As Boolean Handles SpottingNewTitle.Action			newtitle			return true		End Function	#tag EndMenuHandler	#tag MenuHandler		Function SpottingPlayBackward() As Boolean Handles SpottingPlayBackward.Action			setmoviefocus			play -1			return true		End Function	#tag EndMenuHandler	#tag MenuHandler		Function SpottingPlayForward() As Boolean Handles SpottingPlayForward.Action			setmoviefocus			movieplayer1.play			movieplayer1.rate = 1			return true		End Function	#tag EndMenuHandler	#tag MenuHandler		Function SpottingReduceWaveform() As Boolean Handles SpottingReduceWaveform.Action			movieplayer1.wavevolume = movieplayer1.wavevolume / 2.0			movieplayer1.setwaveform		End Function	#tag EndMenuHandler	#tag MenuHandler		Function SpottingSortbyTimecode() As Boolean Handles SpottingSortbyTimecode.Action			app.mouseCursor = system.cursors.wait			titlelist.sortTitles			app.mouseCursor = system.cursors.standardpointer			return true		End Function	#tag EndMenuHandler	#tag MenuHandler		Function SpottingSplitTitle() As Boolean Handles SpottingSplitTitle.Action			splittitle			return true		End Function	#tag EndMenuHandler	#tag MenuHandler		Function SpottingStop() As Boolean Handles SpottingStop.Action			setmoviefocus			moviePlayer1.stop			movieplayer1.setwaveform			return true		End Function	#tag EndMenuHandler	#tag MenuHandler		Function SpottingUpdateTimecode() As Boolean Handles SpottingUpdateTimecode.Action			updatetimecode			return true		End Function	#tag EndMenuHandler	#tag MenuHandler		Function ToolsExport() As Boolean Handles ToolsExport.Action			exportwindow.show 			return true		End Function	#tag EndMenuHandler	#tag MenuHandler		Function ToolsFullScreen() As Boolean Handles ToolsFullScreen.Action			if not app.reg.online and not debugbuild then			msgBox "You need an online license to use this tool"			return true			end						fullscreenwindow.show			fullscreenwindow.parent = self			fullscreenwindow.linkTitlelist		End Function	#tag EndMenuHandler	#tag Method, Flags = &h0		Function Clone() As main		  dim m as main		  dim f as folderitem		  f = gettemporaryFolderItem		  if f<>nil then		    savetoFile(f)		    m = new main		    m.document = f		    m.openxmldocument		    m.top = self.top + 16		    m.left = self.left + 16		    if right(self.title,4) = ".stp" then		      m.title = left(self.title, len(self.title)-4) + "_copy"		    else		      m.title = self.title + " copy"		    end		    m.document = nil		    		    // these are not saved in the file		    m.titlelist.textfont = titlelist.textfont		    m.titlelist.selStart = titlelist.selstart		    m.titlelist.sellength  = titlelist.sellength		  end		  return m		End Function	#tag EndMethod	#tag Method, Flags = &h0		Sub CloseAnyway()		  closeanywayprop = true		  close 		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub Disablecontrols(disable as boolean)		  dim rc as rectcontrol		  dim i,cc as integer		  		  cc = self.controlcount-1		  for i = 0 to cc		    if control(i) isa rectControl then		      rc = rectcontrol(control(i))		      if rc = progress or rc = previewlabel then		      else		        rc.enabled = not disable		      end		    end		  next		  		  disablemenus = disable		  		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Function ExportOneTitle(i as integer, frame as picture, alpha as picture) As boolean		  dim f,g as folderitem		  dim test as tiffexport		  dim id,inn,in2, fp, gp as string		  dim firstline, secondline, rendertext as string		  dim renderer as subtitle		  dim filename, bmps as string		  dim b as binaryStream		  		  titlelist.preview i		  filename = titlelist.acttitle.getfilename		  firstline = preview.firstline		  secondline = preview.secondline		  previewlabel.settext app.getlabel("export")+" "+filename		  		  renderer = titlelist.acttitle.style		  		  rendertext = firstline+endofline+secondline		  		  select case exportformat		  case  "TIFF-DVD", "BMP-DVD", "PNG-DVD"		    renderer.renderDVD(rendertext,frame,alpha,eventreceiver1)		  else		    renderer.render(rendertext,frame,alpha,eventreceiver1)		  end		  		  app.consolelog "main.exporttitle file " + str(i)		  select case exportformat		  case "PICT"		    // old method		    fp = folderpath+prefix+filename+app.pictextension		    gp = folderpath+prefix+filename+"mask"+app.pictextension		    f = getfolderitem(fp) 		    g = getfolderitem(gp) 		    f.saveaspicture frame		    f.maccreator = app.pictcreator		    g.saveaspicture alpha		    g.maccreator = app.pictcreator		  case "PICT-alpha"		    test = new tiffexport(folderpath+prefix+filename+app.pictextension)		    test.top = renderer.top		    test.left = renderer.left.value-abs(renderer.shadowx)-renderer.size		    test.bottom = renderer.bottom		    test.right = renderer.right.value+abs(renderer.shadowx)+renderer.size		    test.compression = 32773		    test.saveaspict frame,alpha		    test.f.maccreator = app.pictcreator		  case "PNG"		    test = new tiffexport(folderpath+prefix+filename+".png")		    test.saveaspng frame,alpha		  case "TIFF"		    test = new tiffexport(folderpath+prefix+filename+app.tiffextension)		    test.top = renderer.top		    test.left = renderer.left.value-abs(renderer.shadowx)-renderer.size		    test.bottom = renderer.bottom		    test.right = renderer.right.value+abs(renderer.shadowx)+renderer.size		    test.compression = 1		    test.saveastiff frame,alpha		    test.f.maccreator = app.tiffcreator		  case "TIFF-RLE"		    test = new tiffexport(folderpath+prefix+filename+app.tiffextension)		    test.top = renderer.top		    test.left = renderer.left.value-abs(renderer.shadowx)-renderer.size		    test.bottom = renderer.bottom		    test.right = renderer.right.value+abs(renderer.shadowx)+renderer.size		    test.compression = 32773		    test.saveastiff frame,alpha		    test.f.maccreator = app.tiffcreator		  case "TIFF-mask"		    test = new tiffexport(folderpath+prefix+filename+app.tiffextension)		    test.top = renderer.top		    test.left = renderer.left.value-abs(renderer.shadowx)-renderer.size		    test.bottom = renderer.bottom		    test.right = renderer.right.value+abs(renderer.shadowx)+renderer.size		    test.compression = 32773		    test.defaultwhite = true		    test.saveastiff alpha,nil		    test.f.maccreator = app.tiffcreator		  case "TIFF-DVD"		    // transform the image into a white red blue black image		    // save seimple		    test = new tiffexport(folderpath+prefix+filename+app.tiffextension)		    test.top = renderer.top		    test.left = renderer.left.value-abs(renderer.shadowx)-renderer.size		    test.bottom = renderer.bottom		    test.right = renderer.right.value+abs(renderer.shadowx)+renderer.size		    test.compression = 32773		    test.defaultwhite = true		    test.saveastiff frame,nil		    test.f.maccreator = app.tiffcreator		  case "BMP-DVD"		    test = new tiffexport(folderpath+prefix+filename+".bmp")		    test.top = renderer.top		    test.left = renderer.left.value-abs(renderer.shadowx)-renderer.size		    test.bottom = renderer.bottom		    test.right = renderer.right.value+abs(renderer.shadowx)+renderer.size		    test.saveasbMP8(frame)		    test.f.maccreator = app.tiffcreator		    		  end select		  if renderer.error then 		    return false		  end		  		  return true		  		End Function	#tag EndMethod	#tag Method, Flags = &h0		Sub ExportText()		  dim f as folderItem		  dim t as textoutputStream		  dim i as integer		  dim st as string		  dim sd as saveasDialog		  		  sd = new saveasDialog		  sd.Filter = "TEXT"		  sd.ActionButtonCaption = "Export"		  sd.suggestedFileName = title + ".text"		  //f = sd.showmodalwithin(me )		  f = sd.showmodal		  		  if f<>nil then		    t = f.createtextfile		    t.write titlelist.text		    t.close 		  end		  		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub ExportTitle()		  dim i as integer		  dim firsttitle, lasttitle as integer		  dim frame, alpha as picture		  dim rw as renderwindow		  		  app.consolelog "main.exporttitle"		  		  app.mouseCursor = system.cursors.wait		  		  frame = newpicture(style.width,style.height,32)		  alpha = newpicture(style.width,style.height,32)		  		  if frame = nil or alpha = nil then		    msgbox "ExportTitle: Not enough memory to create frame and alpha"		    return		  end		  		  if frame.rgBSurface=nil or alpha.rgBSurface=nil then		    msgbox "ExportTitle: Not enough memory to create rgbsurface"		    return		  end		  		  firsttitle = titlelist.getfirstselectedtitle		  lasttitle = titlelist.getlastselectedtitle		  if not app.reg.online then		    lasttitle = min(lasttitle, firsttitle + 9)		  end		  		  		  if lasttitle>firsttitle then		    for i = firsttitle to lasttitle		      jobs.append i		    next		    jobframe = frame		    jobalpha = alpha		    rw = new renderwindow		    rw.hide		    rw.parent = self		    app.mouseCursor = system.cursors.standardpointer		    rw.showmodalwithin(self)		  else		    call exportoneTitle(firsttitle, frame, alpha)		    app.mouseCursor = system.cursors.standardpointer		  end		  		  		  		  'progress.visible = false		  		  beep // new 1.7b20		  app.consolelog "main.exporttitle end"		  lasttitle = 0		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Function Fileimportmoviecommand() As boolean		  dim f as folderitem		  dim DocumentsFolder as FolderItem		  dim od as openDialog		  od = new opendialog		  DocumentsFolder = SpecialFolder.Documents		  if moviepath<>"" then		    f = getfolderItem(moviepath)		  end		  if f<>nil then		    od.initialDirectory = f.parent		  elseif document <>nil then		    od.initialDirectory = document.parent		  else		    od.initialDirectory = documentsFolder		  end		  od.filter = "video/quicktime;video/x-dv;video/mp4;video/mpeg;video/MMCH;video/x-msvideo;smil"		  //f = od.showmodalwithin(self)		  f = od.showmodal		  if f<>nil then		    setmovieFile f		    haschanged = true		  end		  return true		End Function	#tag EndMethod	#tag Method, Flags = &h0		Sub find(st as string, first as integer, last as integer,capitalcheck as boolean)		  // 1.1π2 parameter first new external    // <-- CONVERTED		  // " findtext set to empty if not found		  		  dim foundat as integer		  dim found as boolean		  dim textfound as string		  dim i as integer		  dim lookat as integer		  		  foundat = findfunction(st,first,last,capitalcheck)		  		  if foundat > 0 and foundat <= last then		    findtext = st		    titlelist.selstart=foundat-1		    titlelist.sellength=len(st)		    titlelist.scrollToSelection		    return		  else		    findtext = ""		    beep		    msgbox st + " " +app.getlabel("NotFound")		  end		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Function findfunction(st as string, first as integer, last as integer, capitalcheck as boolean) As integer		  dim foundat as integer		  dim found as boolean		  dim lookat as integer		  		  lookat = first		  PCapitalcheck = capitalcheck		  found = false		  do 		    foundat = instr(lookat,titlelist.text,st)		    if Pcapitalcheck then		      if strcomp(st,mid(titlelist.text,foundat,len(st)),0)=0 then		        found = true		      else		        lookat = lookat+1 		      end		    elseif foundat > 0 and foundat <= last then		      found = true		    end		  loop until foundat = 0 or foundat > last or found		  return foundat		End Function	#tag EndMethod	#tag Method, Flags = &h0		Function HasChanged() As boolean		  #if targetcarbon		    // disabled dependency MBS COSMETIC FEATURE MISSING		    #if kMBSused		      return self.modifiedMBS		    #endif		    return phaschanged		    // end		  #else		    return phaschanged		  #endif		End Function	#tag EndMethod	#tag Method, Flags = &h0		Sub HasChanged(assigns v as boolean)		  #if targetcarbon		    // disabled dependency MBS COSMETIC FEATURE MISSING		    #if kMBSused		      self.ModifiedMBS = v		    #endif		  #endif		  phaschanged = v		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub import(f as folderitem)		  dim t as textinputStream		  dim st as string		  dim count,i,iwill as integer		  if not f.exists then		    msgbox StErrorImportNoFile		    return		  end		  mousecursor=system.cursors.wait		  t =f.openastextFile		  st = t.readall		  		  count = countfields(st,titlelist.getsep) //detecting if there are already double returns		  if count = 1 then		    st = replaceall(st,endofline,titlelist.getsep)		    st = replaceall(st,chr(9),titlelist.geteol)		  end		  		  titlelist.text = st		  haschanged = true		  mousecursor=system.cursors.standardpointer		End Sub	#tag EndMethod	#tag Method, Flags = &h1		Protected Sub Jog(v as integer)		  dim altpos as double		  altpos = movieplayer1.position		  movieplayer1.position = movieplayer1.position + v		  app.doevents		  if movieplayer1.position = altpos then		    movieplayer1.position = movieplayer1.position + v*2		  end		End Sub	#tag EndMethod	#tag Method, Flags = &h1		Protected Sub JoinTitle()		  dim tc, tcin, tcout as timecode		  dim tcoffset as timecode		  dim onet as onetitle		  		  if movieplayer1.movie<>nil and moviesyncOption.value then		    		    tcoffset = style.getTimeCode		    tcoffset.settext movieoffsetField.text		    		    tc = style.getTimeCode		    tc.settotalSeconds(movieplayer1.position)		    tc.plus tcoffset		    		    tcin = style.getTimeCode		    tcin.settotalSeconds(movieplayer1.inpoint)		    tcin.plus tcoffset		    		    tcout = style.getTimeCode		    tcout.settotalSeconds(movieplayer1.outpoint)		    tcout.plus tcoffset		    		    movieplayer1.stop		  else		    tc = style.getTimeCode		    onet = titlelist.gettitle(titlelist.getfirstselectedtitle)		    if onet<>nil then		      tc.settext onet.getinpoint		    else		      beep		    end		  end		  		  titlelist.joinfromtimecode tc		  setmovieFocus false		  titlelist.setFocus		End Sub	#tag EndMethod	#tag Method, Flags = &h1		Protected Sub NewTitle()		  dim tc, tcin, tcout as timecode		  dim tcoffset as timecode		  		  tcoffset = style.getTimeCode		  tcoffset.settext movieoffsetField.text		  		  tc = style.getTimeCode		  tc.settotalSeconds(movieplayer1.position)		  tc.plus tcoffset		  		  tcin = style.getTimeCode		  tcin.settotalSeconds(movieplayer1.inpoint)		  tcin.plus tcoffset		  		  tcout = style.getTimeCode		  tcout.settotalSeconds(movieplayer1.outpoint)		  tcout.plus tcoffset		  		  		  movieplayer1.stop		  'movieplayer1.position = movieplayer1.inpoint  // 1.7.3b5		  titlelist.insertWithTimecode tcin, tcout		  setmovieFocus false		  		  titlelist.setFocus		End Sub	#tag EndMethod	#tag Method, Flags = &h1		Protected Sub OfflineWarning()		  if not app.reg.online then		    msgBox "Offline license" + endofline + endofline  + "Only 10 titles will be exported."		  end		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub opendocument()		  dim b as binarystream		  dim m as memoryblock		  dim i,j,k, u,test,directorystart, nentries  as integer		  dim tag, type, arraydim, val as integer		  dim st as string		  dim pos as integer		  dim unencoded,encoded as string		  dim idpos,firstpos,secondpos, cols as integer		  dim utf8encoded as boolean		  dim conv as textconverter		  		  if not document.exists then		    msgbox StErrorNoDoc		    return		  end		  b = document.openasbinaryFile(false)		  b.littleEndian = false		  st = b.read(4)		  if st<> "SICT" then		    st = st + b.read(100)		    b.close		    if instr(st,"<?xml") > 0 then		      openxmldocument		      app.actmain = self		      return		    else		      msgbox StErrorNoSubtitlerDoc		      return		    end		  end if		  st = b.read(4) //testing type		  if st<> "STLI" then		    msgbox StErrorDocType		    b.close		    return		  end if		  test = b.readshort //testing type		  if test<> 3 then		    msgbox StErrorVersion		    b.close		    return		  end if		  directorystart = b.readlong		  b.position = directorystart		  nentries = b.readshort		  for i = 1 to nentries		    tag = b.readshort		    type = b.readshort		    arraydim = b.readlong		    val = b.readlong		    pos = b.position		    select case tag		    case 256		      b.position = val		      left = b.readshort		      		      top = b.readshort		      		      width = min(screen(0).width,b.readshort)		      height = min(screen(0).height-32,b.readshort)		    case 271		      b.position = val		      exportformat = b.readpstring		      app.exportformat = exportformat		    case 512		      b.position = val		      u = b.readshort		      m = newmemoryBlock(u)		      m.littleEndian = false		      m.short(0) = u 		      for j = 2 to u-1		        m.byte(j)=b.readbyte 		      next		      style.restore m		    case 513		      b.position = val		      folderpath = b.readpstring		      folderpath = folderpath.defineEncoding(encodings.macroman)		    case 514		      b.position  =val		      pagesetup = b.readpstring		    case 1025		      b.position = val		      if "utf8"=b.readpString then		        utf8encoded = true		      end		    case 1026		      b.position = val		      u = b.readlong		      unencoded =  b.read(u)		      		      if utf8encoded then		        conv = gettextconverter(gettextencoding(&h0100,0,2),gettextencoding(&h0100,0,2))		        encoded = conv.convert(unencoded)		      else		        encoded = unencoded		      end		      		      titlelist.text = replaceall(encoded,endofline.macintosh,endofLine.macintosh)		    end select 		    b.position = pos		  next		  b.close		  		  		  app.actmain = self		  		exception err as nilobjectException		  msgBox "Serious error in Main.OpenDocument. Please contact developer"		  		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub openxmldocument()		  dim f,picturef, testf as folderitem		  dim m as memoryblock		  dim dict, docdict, d as dictionary		  dim test as string		  dim testinteger as integer		  dim testdouble as double		  dim p as picture		  dim s as string		  dim b as boolean		  		  dict = new dictionary		  if not dict.loadxml(document) then		    return		  end		  		  'if dict.getdictionary("document",docdict) then		  'if not (docdict.getstring("creator", test) and test="SICT") then		  'return		  'end		  'if not (docdict.getstring("type", test) and test="PREF") then		  'return		  'end		  'if not (docdict.getdouble("version", testdouble) and testdouble = 1.4) then		  'return		  'end		  'else		  'return 		  'end		  		  if dict.getinteger("mainleft", testinteger) then left = testinteger		  if left <0 or left > screen(0).width then		    left = 12		  end		  if dict.getinteger("maintop", testinteger) then top = testinteger		  if top <48 or top > screen(0).height then		    top = 48		  end		  if dict.getinteger("mainwidth", testinteger) then width = testinteger		  width = min(screen(0).width-24,width)		  if dict.getinteger("mainheight", testinteger) then height = testinteger		  height = min(screen(0).height-72,height)		  		  if dict.getboolean("styledt",b) then styledt.value = b		  if dict.getboolean("exportdt",b)  then exportdT.value = b		  if dict.getboolean("moviedt",b) then moviedt.value = b		  if dict.getboolean("previewdt",b) then previewdt.value = b		  		  		  call dict.getstring("exportformat",exportformat)		  		  if dict.getdictionary("style",d) then		    style.restorefromDict d		  end		  		  call dict.getstring("folderpath",folderpath)		  testf = getfolderItem(folderpath)		  if testf = nil or not testf.directory then		    folderpath = ""		  end		  		  if dict.getstring("prefix",test) then		    prefix = test		  end		  		  call dict.getstring("moviepath", moviepath)		  if dict.getstring("movieoffset",s) then		    movieoffsetField.text = s		  end		  		  if moviepath<>"" then		    f = getfolderItem(moviepath)		    if f<>nil and f.exists then setmovieFile f		    if movieplayer1.movie=nil then moviepath = ""  // 1.7b17		  end		  		  if dict.getstring("titlelist",s) then 		    s = replacelineEndings(s,endofLine.macintosh) // windows editfield wants this		    s = s.defineEncoding(encodings.utf8)  // 1.7b17		    titlelist.text = s		  end		  		  if dict.getboolean("moviesyncoption",b) then		    if b then titlelisthasfocus = true		    moviesyncOption.value = b		  end		  		  		  		  call dict.getbinary("pagesetup",pagesetup)		  		  touchhack		  		  		exception err as nilobjectException		  msgBox "Serious error in Main.OpenXMLDocument. Please contact developer"		  		  		End Sub	#tag EndMethod	#tag Method, Flags = &h1		Protected Sub Play(speed as double =1.0)		  		  if speed = 0 then		    moviePlayer1.stop		    return		  end		  		  if speed < 0 then		    if movieplayer1.position = movieplayer1.duration then  // prevent from going to start		      movieplayer1.position = movieplayer1.position - 1 / movieplayer1.framerate		    end 		  end		  		  movieplayer1.play		  movieplayer1.rate = speed		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Function Prefix() As string		  return exportprefixfield.text		End Function	#tag EndMethod	#tag Method, Flags = &h0		Sub Prefix(assigns s as string)		  exportprefixfield.text = ""		  exportprefixfield.seltext = s		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub Replace(st as string, first as integer, last as integer,capitalcheck as boolean, rt as string, repall as boolean)		  dim foundat, reallast, lookat, changes, pos as integer		  dim text0, prologtext, epilogtext, worktext as string		  		  		  if repall then		    text0 = titlelist.text		    prologtext = left(text0,first-1)		    worktext = mid(text0,first,last-first+1)		    epilogtext = mid(text0,last+1)		    		    if capitalcheck then		      do 		        pos = instrb(pos+1,worktext,st)		        if pos>0 then changes = changes + 1		      loop until pos = 0		      worktext = replaceallB(worktext,st,rt)		    else		      changes = countfields(worktext,st)-1		      worktext = replaceall(worktext,st,rt)		    end		    titlelist.text = prologtext + worktext + epilogtext		    if changes>0 then		      msgbox str(changes) + " " +app.getlabel("Changes")		      titlelist.selstart = len(prologtext) + len(worktext)		      titlelist.sellength = 0		    else		      msgbox st + " " + app.GetLabel("NotFound")		      titlelist.selstart = len(prologtext)		      titlelist.sellength = len(worktext)		    end		    return		  end		  		  		  		  foundat = findfunction(st,first,last,capitalcheck)		  reallast = last		  if foundat > 0 and foundat <= last then		    //found something		    if repall then		      app.mouseCursor = system.cursors.wait		      findtext = st		      titlelist.selstart = foundat-1		      titlelist.sellength = len(st)		      titlelist.seltext = rt		      reallast = last + len(rt)-len(st)		      changes = 1		      		      do		        foundat = findfunction(st,titlelist.selstart,reallast,capitalcheck)		        if foundat > 0 and foundat <= reallast then		          findtext = st		          titlelist.replace(foundat-1,st,rt)		          reallast = reallast + len(rt)-len(st)		          changes = changes + 1		        end		      loop until foundat = 0 or foundat > reallast		      app.mouseCursor = system.cursors.standardpointer		      msgbox str(changes) + " " +app.getlabel("Changes")		    else		      findtext = st		      titlelist.selstart=foundat-1		      titlelist.sellength=len(st)		      findWindow.showreplacebutton titlelist.text		      findwindow.show		    end		  else		    findtext = ""		    beep		    msgbox st + " " + app.GetLabel("NotFound")		  end		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub savedocument(filename as string, displaysavedialog as boolean, oldformat as boolean = false)		  dim b as binarystream		  dim m as memoryblock		  dim i,u,v as integer		  dim numberofentries, dataoffset,startstyle, pos, startheadings, starttitles  as integer		  dim diroffset as integer		  dim unencoded,utf8string as string		  dim conv as textConverter		  dim sd as saveAsDialog		  		  if not oldformat then		    savexmldocument(filename, displaysavedialog)		    return		  end		  		  if document = nil or displaysavedialog=true then		    sd = new saveasDialog		    sd.Filter = "Subtitler"		    if right(filename,4)<>".stp" then 		      sd.suggestedFileName = filename+ ".stp"		    else		      sd.suggestedFileName = filename		    end		    //document = sd.showmodalwithin(me )		    document = sd.showmodal		    if document = nil then		      return		    end if		    title = document.name		    b = document.createBinaryFile("Subtitler") // type pref, creator as signature		    b.littleEndian = false		  else		    b = document.openasbinaryfile(true)		    b.littleEndian = false		  end 		  		  if b = nil  then		    msgbox StErrorbinarystream		    return		  end if		  		  b.write "SICT"		  b.write "STLI" 		  b.writeshort 3//version		  		  diroffset = 20		  numberOfEntries = 10 		  dataoffset = diroffset+2+12*(numberofentries+1)		  		  b.writelong diroffset		  		  for i= b.position to dataoffset		    b.writebyte 0		  next		  		  b.position = diroffset		  b.writeshort numberOfEntries		  diroffset = b.position		  		  b.position = diroffset		  writetag(b,256,3,4,dataoffset) //docwindow		  diroffset = b.position		  b.position = dataoffset		  b.writeshort left		  b.writeshort top		  b.writeshort width		  b.writeshort height		  dataoffset = b.position		  		  b.position = diroffset		  writetag(b,257,3,4,dataoffset)  //monitorwindow		  diroffset = b.position		  b.position = dataoffset		  b.writeshort app.settingsleft		  b.writeshort app.settingstop		  dataoffset = b.position		  		  b.position = diroffset		  writetag(b,258,3,2,dataoffset) //settingswindow		  diroffset = b.position		  b.position = dataoffset		  b.writeshort app.monitorleft		  b.writeshort app.monitortop		  dataoffset = b.position		  		  b.position = diroffset		  writetag(b,259,3,2,dataoffset) //registerwindow		  diroffset = b.position		  b.position = dataoffset		  b.writeshort app.registerleft		  b.writeshort app.registertop		  dataoffset = b.position		  		  b.position = diroffset		  writetag(b,271,2,1,dataoffset) //exportformat		  diroffset = b.position		  b.position = dataoffset		  b.writepstring exportformat		  dataoffset = b.position		  		  b.position = diroffset		  writetag(b,512,10,1,dataoffset)		  diroffset = b.position		  b.position = dataoffset		  m = style.backup		  u = m.short(0)		  for i = 0 to u-1 		    b.writebyte m.byte(i)		  next		  dataoffset = b.position		  		  b.position = diroffset		  writetag(b,513,2,1,dataoffset) //folderprpath		  diroffset = b.position		  b.position = dataoffset		  b.writepstring folderpath		  dataoffset = b.position		  		  b.position = diroffset		  writetag(b,514,2,1,dataoffset) //pagesetup		  diroffset = b.position		  b.position = dataoffset		  b.writepstring pagesetup		  dataoffset = b.position		  		  b.position = diroffset		  writetag(b,1025,2,1,dataoffset) //encoding 		  diroffset = b.position		  b.position = dataoffset		  b.writepstring "utf8"		  dataoffset = b.position		  		  b.position = diroffset		  writetag(b,1026,18,1,dataoffset)		  diroffset = b.position		  b.position = dataoffset		  unencoded = titlelist.text  // assume...		  		  conv = gettextconverter(guessjapaneseencoding(unencoded),gettextencoding(&h0100,0,2))		  utf8string = replaceall(conv.convert(unencoded),endofLine.macintosh,endofLine.macintosh)		  		  v=lenb(utf8string)		  b.writelong v		  b.write utf8string		  dataoffset = b.position		  		  b.position = diroffset		  writetag(b,0,0,0,0)		  		  b.close		  		  titlelist.resetundo		  		  haschanged = false		End Sub	#tag EndMethod	#tag Method, Flags = &h1		Protected Sub SaveToFile(file as folderitem)		  dim f as folderitem		  dim dict as dictionary		  dim t as textoutputStream		  dim d as date		  dim s as string		  		  		  dict = new dictionary		  dict.value("document") = app.getdocdict("STLI", documentcreationdate)		  		  dict.value("mainleft") = left		  dict.value("maintop") = top		  dict.value("mainwidth") = width		  dict.value("mainheight") = height		  dict.value("styledt")= styledt.value		  dict.value("exportdt") = exportdt.value		  dict.value("previewdt") = previewdt.value		  dict.value("moviedt") = moviedt.value		  		  dict.value("exportformat") = exportformat		  		  dict.value("style") = style.BackupToDict		  		  dict.value("folderpath") = folderpath		  dict.value("prefix") = prefix		  		  dict.value("moviepath") = moviepath		  dict.value("movieoffset") = movieoffsetField.text		  dict.value("moviesyncoption") = moviesyncOption.value		  		  dict.binaryvalue("pagesetup") = pagesetup		  		  dict.value("titlelist") = xmlCharacterFilter(replacelineEndings(titlelist.text,endofLine.macintosh))		  		  if file <> nil then		    d = nil		    if file.exists then d = file.creationDate		    t = file.createtextFile		    if t<>nil then		      s = dict.exportXMLString		      if s =  "" then		        msgBox "savexmldocument: error xml"		      end		      t.Write s		      t.close		      if d<>nil then file.creationDate = d		      file.maccreator = "SICT"		      file.mactype = "STLI"		      app.addRecent file		    else		      msgBox "savetofile: error textoutputstream"		    end 		    		  else		    msgBox "savetofile: document could not be created"		  end		  		Exception err as NilObjectException		  // ignore		  		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub savexmldocument(filename as string, displaysavedialog as boolean)		  dim sd as saveAsDialog		  dim DocumentsFolder as FolderItem		  DocumentsFolder = SpecialFolder.Documents		  		  if document = nil or displaysavedialog=true then		    sd = new saveasDialog		    if document = nil then		      sd.initialDirectory = documentsFolder		    else		      sd.initialDirectory = document.parent		    end		    sd.disclosure = false //unused		    sd.Filter = "Subtitler"		    if right(filename,4)<>".stp" then 		      sd.suggestedFileName = filename+ ".stp"		    else		      sd.suggestedFileName = filename		    end		    document = sd.showmodalwithin(me )		    //document = sd.showmodal		    if document = nil then		      return		    end if		    title = document.name		  else		  end		  		  savetoFile(document)		  		  titlelist.resetundo		  		  haschanged = false		  		  		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub setformat()		  if opening then return		  		  preview.textfont = style.font		  preview.settextsize app.previewtextsize		  preview.bold = style.bold		  preview.italic = style.italic		  preview.underline = style.underline		  preview.textalign = style.halign		  preview.wrapmethod = style.wrapmethod		  if style.size<>0 then		    preview.spacing = style.spacing * preview.gettextsize / style.size		  end		  if preview.visible then		    preview.setformat		  end		  		  if titlelist.text <> "" then		    titlelist.preview		  end		  		  //***		  'preview.style = style		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub setlanguage()		  dim value as string		  dim s0, s1, s2 as string		  dim i as integer		  dim languagedict as dictionary		  languagedict = app.languagedict		  if languagedict =nil then return		  		  // set for menu		  if languagedict.getstring("maintextgroup", value) then groupbox1.caption = value		  if languagedict.getstring("mainbordergroup", value) then groupbox2.caption = value		  if languagedict.getstring("mainshadowgroup", value) then shadowgroup.caption = value		  if languagedict.getstring("mainboxgroup", value) then groupbox8.caption = value		  if languagedict.getstring("mainhorizontalgroup", value) then groupbox3.caption = value		  if languagedict.getstring("mainverticalgroup", value) then groupbox4.caption = value		  if languagedict.getstring("mainvideoformatgroup", value) then groupbox5.caption = value		  if languagedict.getstring("mainfileformatgroup", value) then groupbox6.caption = value		  if languagedict.getstring("movie", value) then pmovie = value else pmovie = "Movie"		  movielabel.text = pmovie + mid(movielabel.text ,len(nthfield(movielabel.text," ",1))+1)		  		  if languagedict.getstring("maincheckbold", value) then checkbold.caption = value		  if languagedict.getstring("maincheckitalic", value) then checkitalic.caption = value		  if languagedict.getstring("maincheckunderline", value) then checkunderline.caption = value		  if languagedict.getstring("mainexportfolderbutton", value) and folderpath = "" then		     folderbutton.caption = value		  end		  if languagedict.getstring("mainlevel", value) then groupbox4.caption = value		  if languagedict.getstring("moviesync", value) then moviesyncOption.caption = value		  		  if languagedict.getstring("mainboxformfixed",s0) and _		    languagedict.getstring("mainboxform1rect",s1) and _		    languagedict.getstring("mainboxform2rect",s2) then		    i = rectform.listindex		    rectform.init array(s1,s2,s0)		    rectform.listindex = i		  end		  		  setlayout		  previewlabel.text = app.getlabel("Preview")		  		  		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub setlayout()		  dim i,j,k,l as integer		  dim sv as boolean		  dim ev, mv as boolean		  dim s as string		  const kmoviecontrollerheight = 16		  		  sv = styledt.value		  groupbox1.visible = sv		  fontmenu.visible = sv		  sizemenu.visible = sv		  checkbold.visible = sv		  checkitalic.visible = sv		  checkunderline.visible = sv		  textcolorbox.visible = sv		  textalpha.visible = sv		  textsoft.visible = sv		  groupbox2.visible = sv		  borderalpha.visible = sv		  bordersoft.visible = sv		  borderwidth.visible = sv		  bordercolorBox.visible = sv		  shadowalpha.visible = sv		  shadowsoft.visible = sv		  shadowcolorBox.visible = sv		  shadowmarker.visible = sv		  rectalpha.visible = sv		  rectform.visible = sv		  rectsoft.visible = sv		  rectcolorBox.visible = sv		  shadowgroup.visible = sv		  groupbox8.visible = sv		  groupbox3.visible = sv		  groupbox4.visible = sv		  statictext1.visible = sv		  ltextlabel.visible = sv		  statictext3.visible = sv		  'statictext4.visible = sv		  'statictext5.visible = sv		  halignMenu.visible = sv		  lslider.visible = sv		  llabel.visible = sv		  rslider.visible = sv		  rlabel.visible = sv		  valignMenu.visible = sv		  wrapmenu.visible=sv		  vslider.visible = sv		  vlabel.visible = sv		  littleArrows1.visible = sv		  littleArrows2.visible = sv		  littleArrows3.visible = sv		  if sv then		    stylelabel.text  = app.getlabel("Style")		  else		    stylelabel.text = app.getlabel("Style")+ ": " + style.stylestring		  end		  if sv then 		    i = 115		  else		    i= 0		  end		  		  ev = exportdt.value		  groupbox5.visible = ev		  groupbox6.visible = ev		  videoformatMenu.visible = ev		  exportformatmenu.visible = ev		  folderbutton.visible = ev		  exportprefixlabel.visible = ev		  exportprefixfield.visible = ev		  'folderpathlabel.visible = ev		  		  exportdt.top = 24 + i		  exportlabel.top = 24+i		  groupbox5.top = 36 + i		  groupbox6.top = 36+i		  exportformatmenu.top = 55 +i		  videoFormatMenu.top = 55 + i		  folderbutton.top = 54+i		  exportprefixlabel.top = 54 + i		  exportprefixfield.top = 54 + i		  'folderpathlabel.top = 50+i		  		  if  ev then		    exportlabel.text = app.getlabel("export")		  else		    s = app.getlabel("ExportLabel")		    s = replace(s,"^1",style.standard)		    s = replace(s,"^2",exportformat)		    s = replace(s,"^3",folderpath)		    exportlabel.text = s		  end		  if ev then		    j = 40		  else		    j = 5		  end		  		  mv = movieDT.value		  		  moviedt.top = 38 + i + j		  movielabel.top = 38 + i + j		  movieplayer1.visible = mv		  movieplayer1.top = 55 + i + j		  'movieplayer1.height = 256		  		  moviecanvas.top = movieplayer1.top-2		  moviecanvas.left = movieplayer1.left-2		  moviecanvas.width = movieplayer1.width+4		  moviecanvas.height = max(movieplayer1.height,180) +4-16		  moviecanvas.visible = mv		  		  moviegroup.visible = mv		  moviegroup.top = movieplayer1.top		  moviegroup.left = movieplayer1.left + movieplayer1.width + 10		  		  		  		  timeline1.Visible =  (mv and movieplayer1.movie<>nil)		  timeline1.top = movieplayer1.top + movieplayer1.height + 4		  timeline1.left = movieplayer1.left		  timeline1.Width = 600		  		  WaveCanvas.Visible =  (mv and movieplayer1.movie<>nil)		  WaveCanvas.top = timeline1.top + timeline1.height + 4		  WaveCanvas.left = movieplayer1.left		  WaveCanvas.Width = 600		  		  if mv then		    l = max(movieplayer1.height+WaveCanvas.height + timeline1.height + 4 + 4 + 4,256)+16		  else		    l = 18		  end		  		  if previewdt.value then 		    k = preview.height + 8		  else		    k= 0		  end		  previewdt.top = 38 + i + j + l		  previewlabel.top = 38 + i + j+l		  if preview.visible then		    preview.top = 53 + i + j+ l		    preview.setformat		  end		  		  titlelist.top = 58 + i +j+ k + l		  titlelist.height = 241-i-j-k-l+height-minheight		  		  if titlelist.height < 50 then		    height = height + 50 - titlelist.height		  end		  		  titlelistselector.top = titlelist.top-1		  titlelistselector.height = titlelist.height+2		  		  if exportformat = "TIFF-DVD"  or  exportformat = "BMP-DVD" then		    shadowgroup.enabled = false		    if style.borderalpha>0 and style.rectalpha>0 then		      'textsoft.listindex = 0		      textsoft.enabled = false		    else		      textsoft.enabled = true		    end		    bordersoft.enabled = false		    rectsoft.enabled = false		    shadowmarker.enabled = false		  else		    shadowgroup.enabled = true		    textsoft.enabled = true		    bordersoft.enabled = true		    rectsoft.enabled = true		    shadowmarker.enabled = true		  end		  		  		  		  		  		  		End Sub	#tag EndMethod	#tag Method, Flags = &h1		Protected Sub SetMarks(markin as timecode, markout as timecode)		  dim tc1, tc2 as timeCode		  if markin<>nil then		    moviemarkinLabel.text  = markin.gettext		    tc1 = markin.clone		    tc2 = markin.clone		    tc1.settext moviemarkoutLabel.text		    tc1.minus tc2		  end		  if markout <> nil then		    moviemarkoutLabel.text = markout.gettext		    tc1 = markout.clone		    tc2 = markout.clone		    tc2.settext moviemarkinLabel.text		    tc1.minus tc2		  end		  if tc1<>nil then moviedurationlabel.text = tc1.gettext else moviedurationlabel.text = ""		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub SetMovieFile(f as folderitem)		  dim m as editableMovie		  dim m2 as movie		  dim aspectratio as double		  dim tc as timecode		  if f <> nil and f.exists then		    		    m2 = f.openasmovie		    if m2<>nil then		      // removed dependency not needed, we have it when we set the movie		      //movieplayer1.duration = m2.durationMBS 		      		      if style<>nil then		        aspectratio = style.widthreal / style.height		        if style.height < 320 then		          movieplayer1.height = style.height + 16		        elseif style.height < 720 then		          movieplayer1.height = style.height / 2 + 16		        else		          movieplayer1.height = style.height / 4 + 16		        end		        movieplayer1.width = aspectratio * (movieplayer1.height -16)		      end		      movieplayer1.movie = m2		      tc = style.getTimeCode		      movieplayer1.framerate = tc.speedP		      moviepath = f.absolutePath		      movieplayer1.moviepath = f.AbsolutePath		      moviefilename = f.name		      movielabel.text = pmovie + " " + moviepath		      setmovieinterestingpoints		    end		    waveCanvas.visible = true		    movieplayer1.waveformcache = new dictionary		    movieplayer1.setwaveform		  else		    movieplayer1.waveformcache = new dictionary		    movieplayer1.movie = nil		    moviepath = ""		    moviefilename = ""		    movielabel.text =pmovie		    waveCanvas.visible = false		  end		  		  'myeditablemovie  = m		  		  setlayout		  		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub SetMovieFocus(value as boolean = true)		  		  if moviedt.value = false then return		  		  moviefocus = value		  if value then		    clearfocus		    'moviefocusLabel.text = "Movie"		    movietimer.mode = 2		    moviecanvas.setFocus		  else		    'moviefocusLabel.text = ""		    movietimer.mode = 1		  end		  setmovieinterestingpoints		  		  movielabel.underline = value		  		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub setmovieinterestingpoints()		  dim i, fc, offset as integer		  dim fps as double		  dim tcoffset as timecode		  		  movieplayer1.clearinterestingPoints		  fc = ubound(titlelist.titletcstarts)		  		  tcoffset = style.getTimeCode		  tcoffset.settext movieoffsetField.text		  offset = tcoffset.getframes		  		  fps = tcoffset.getfps		  		  for i = 0 to fc		    movieplayer1.addInterestingPoint (titlelist.titletcstarts(i) - offset ) / fps 		  next		  		  		  i = i		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub SetMoviePosition(tc as timecode)		  dim offsettc as timeCode		  if movieplayer1.visible and moviesyncOption.value then		    offsettc = style.getTimeCode		    offsettc.settext movieoffsetField.text		    tc.minus offsettc		    movieplayer1.stop		    movieplayer1.setposition tc.gettotalseconds + 0.01 // rounding '(tc.getframes+0.5) / tc.speedP		    if targetcarbon then		      movieplayer1.refresh		    end		    updatenow		    movietimer.mode = 1		    'elseif movieplayer1.visible = false then		    'moviepositionLabel.text = tc.gettext		  end		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub SetTemplate()		  titlelist.text = ""		  folderpath = ""		  haschanged = false		  document = nil		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub setwidth()		  dim maxw as integer		  if style.right.value <= style.left.value then		    style.right.value = style.left.value+1		    rslider.value = style.right.value		  end		  maxw = (style.right.value-style.left.value)*style.widthreal/style.width		  preview.aspectratio = maxw / style.size		  maxwidth = maxw*preview.gettextsize/style.size		  'preview.width = maxwidth		  preview.settextsize preview.gettextsize		  setformat		End Sub	#tag EndMethod	#tag Method, Flags = &h1		Protected Sub SplitTitle()		  dim tc, tcin, tcout as timecode		  dim tcoffset as timecode		  dim onet as oneTitle		  		  if movieplayer1.movie <> nil and moviesyncOption.value then		    		    		    tcoffset = style.getTimeCode		    tcoffset.settext movieoffsetField.text		    		    tc = style.getTimeCode		    tc.settotalSeconds(movieplayer1.position)		    tc.plus tcoffset		    		    tcin = style.getTimeCode		    tcin.settotalSeconds(movieplayer1.inpoint)		    tcin.plus tcoffset		    		    tcout = style.getTimeCode		    tcout.settotalSeconds(movieplayer1.outpoint)		    tcout.plus tcoffset		    		    movieplayer1.stop		    		  else		    tc = style.getTimeCode		    onet = titlelist.gettitle(titlelist.getfirstselectedtitle)		    if onet<>nil then		      tcin = style.gettimecode		      tcin.settext onet.getinPoint		      tcout = style.gettimeCode		      tcout.settext onet.getoutPoint		      tc.setframes (tcin.getframes + tcout.getframes - app.splitdistance) / 2		    end		  end		  		  titlelist.splitFromTimeCode tc, app.splitdistance		  setmovieFocus false		  titlelist.setFocus		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub touchhack()		  // 2.0.0b1 test		  // TitleList.TextChangeMethod		  // force build all titles hack		  TitleList.text = TitleList.text+" "		  TitleList.text = left(titlelist.text,len(titlelist.text)-1)		  		  		  setmovieinterestingpoints		End Sub	#tag EndMethod	#tag Method, Flags = &h1		Protected Sub UpdateTimecode()		  dim tc, tcin, tcout as timecode		  dim tcoffset as timecode		  		  tcoffset = style.getTimeCode		  tcoffset.settext movieoffsetField.text		  		  tc = style.getTimeCode		  tc.settotalSeconds(movieplayer1.position)		  tc.plus tcoffset		  		  tcin = style.getTimeCode		  tcin.settotalSeconds(movieplayer1.inpoint)		  tcin.plus tcoffset		  		  tcout = style.getTimeCode		  tcout.settotalSeconds(movieplayer1.outpoint)		  tcout.plus tcoffset		  		  		  movieplayer1.stop		  movieplayer1.position = movieplayer1.inpoint  // 1.7.3b5		  titlelist.updateWithTimecode tcin, tcout		  'setmovieFocus false		  'titlelist.setFocus		  		  		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub writetag(b as binarystream,  tag as integer,type as integer,size as integer, value as integer)		  		  b.writeshort tag		  b.writeshort type		  b.writelong size		  if type = 3 and size = 1then		    b.writeshort value		    b.writeshort 0		  else		    b.writelong value		  end if		  		End Sub	#tag EndMethod	#tag Note, Name = events titlelist				getcurrentTC								------								-----		BuildTitleMapEvent									#tag EndNote	#tag Property, Flags = &h0		acttitle As onetitle	#tag EndProperty	#tag Property, Flags = &h0		closeanywayprop As boolean	#tag EndProperty	#tag Property, Flags = &h0		disablemenus As boolean	#tag EndProperty	#tag Property, Flags = &h0		dobuildtitlemap As boolean	#tag EndProperty	#tag Property, Flags = &h0		document As folderitem	#tag EndProperty	#tag Property, Flags = &h0		documentcreationdate As date	#tag EndProperty	#tag Property, Flags = &h0		exportformat As string	#tag EndProperty	#tag Property, Flags = &h0		findtext As string	#tag EndProperty	#tag Property, Flags = &h0		folderpath As string	#tag EndProperty	#tag Property, Flags = &h0		jobalpha As picture	#tag EndProperty	#tag Property, Flags = &h0		jobframe As picture	#tag EndProperty	#tag Property, Flags = &h0		jobs(-1) As integer	#tag EndProperty	#tag Property, Flags = &h1		Protected lastposition As double	#tag EndProperty	#tag Property, Flags = &h0		moviefilename As string	#tag EndProperty	#tag Property, Flags = &h0		moviefocus As boolean	#tag EndProperty	#tag Property, Flags = &h0		moviepath As string	#tag EndProperty	#tag Property, Flags = &h0		myeditablemovie As editableMovie	#tag EndProperty	#tag Property, Flags = &h0		opening As boolean	#tag EndProperty	#tag Property, Flags = &h0		PageSetup As string	#tag EndProperty	#tag Property, Flags = &h0		Pcapitalcheck As boolean	#tag EndProperty	#tag Property, Flags = &h0		phaschanged As boolean	#tag EndProperty	#tag Property, Flags = &h0		pmovie As string	#tag EndProperty	#tag Property, Flags = &h0		style As subtitle	#tag EndProperty	#tag Property, Flags = &h0		titlelisthasfocus As boolean	#tag EndProperty	#tag Property, Flags = &h0		voldat As double	#tag EndProperty#tag EndWindowCode#tag Events ExportPrefixField	#tag Event		Sub MouseExit()		  if left(me.text,1) = "." then		    msgBox "Warning: A prefix with starting period ""."" will export invisible files."		  end		End Sub	#tag EndEvent	#tag Event		Sub TextChange()		  titlelist.prefix = prefix		  haschanged = true		End Sub	#tag EndEvent#tag EndEvents#tag Events LittleArrows1	#tag Event		Sub Up()		  lslider.value = lslider.value +1		End Sub	#tag EndEvent	#tag Event		Sub Down()		  lslider.value = lslider.value -1		End Sub	#tag EndEvent#tag EndEvents#tag Events LittleArrows2	#tag Event		Sub Down()		  rslider.value = rslider.value -1		End Sub	#tag EndEvent	#tag Event		Sub Up()		  rslider.value = rslider.value +1		End Sub	#tag EndEvent#tag EndEvents#tag Events LittleArrows3	#tag Event		Sub Up()		  vslider.value = vslider.value +1		End Sub	#tag EndEvent	#tag Event		Sub Down()		  vslider.value = vslider.value -1		End Sub	#tag EndEvent#tag EndEvents#tag Events Titlelist	#tag Event		Sub LostFocus()		  titlelisthasfocus = false		  previewlabel.underline = false		End Sub	#tag EndEvent	#tag Event		Sub CurrentTC(tc as timecode, always as boolean = false)		  dim offsettc as timecode		  if titlelisthasfocus or always then		    setmovieposition tc		  end		End Sub	#tag EndEvent	#tag Event		Function Keydown(key as string) As boolean		  		  if key = chr(27) then // escape then		    setmoviefocus 		    return true		  end		End Function	#tag EndEvent	#tag Event		Sub GotFocus()		  dim cf, linec as integer		  dim tc, tcoffset as timecode		  dim ot  as onetitle		  setmoviefocus false		  titlelisthasfocus = true		  		  tcoffset = style.getTimeCode		  tcoffset.settext movieoffsetField.text		  		  tc = style.getTimeCode		  tc.settotalSeconds(movieplayer1.position)		  tc.plus tcoffset		  moviepositionLabel.text = tc.gettext		  		  'me.changeignore = true		  		  if movieplayer1.visible and moviesyncOption.value then		    titlelist.previewfromtimecode(tc)		    titlelist.selectFromTimecode(tc)		    		    ot = titlelist.gettitle(titlelist.getfirstselectedtitle)		    'ot.parse		    if ot<>nil then		      linec = countfields(ot.source, endofLine.macintosh)-countfields(ot.gettext,endofLine.macintosh)+2		    end		    		    cf = countfields(left(me.text, me.selstart), endofline.macintosh)		    me.scrollposition = max(0,cf-linec)		    // title has 5 lines		  end		  'me.changeignore = false		  		  previewlabel.underline = true		  		  		End Sub	#tag EndEvent	#tag Event		Sub Open()		  style = new subtitle		  style.clone app.style		  acttitle = new onetitle(style)		  me.edittitle(preview,previewlabel,style,acttitle)		  me.textsize = app.editortextsize		End Sub	#tag EndEvent	#tag Event		Sub BuildTitleMapEvent()		  dim i,ub,ub2,fr as integer		  dim offset as integer		  dim tc as timecode		  		  ub = timeline1.InitMapSize		  ub2 = movieplayer1.duration * val(style.framerate) // hack		  		  tc = style.gettimeCode		  tc.settext movieoffsetField.text		  offset = tc.getframes		  		  for i = 0 to ub		    fr = i * ub2 / ub + offset		    if fr < ubound(me.titlemap) and fr>=0 then		      if me.titlemap(fr) > 0 then		        timeline1.map(i) = 1		      else		        timeline1.map(i) = 0		      end		    end		  next		  		  timeline1.buildWaveform		  movieplayer1.setWaveform		  		  		Exception err as OutOfBoundsException		  MsgBox "OutOfBoundsException in Main.BuildTitleMapEvent"		End Sub	#tag EndEvent	#tag Event		Function GetCurrentTC() As timecode		  dim tc, tcin, tcout as timecode		  dim tcoffset as timecode		  		  tcoffset = style.getTimeCode		  tcoffset.settext movieoffsetField.text		  		  tc = style.getTimeCode		  tc.settotalSeconds(movieplayer1.position)		  tc.plus tcoffset		  		  return tc		End Function	#tag EndEvent	#tag Event		Sub TextChangeEvent()		  		  dim i, fc, offset as integer		  dim fps as double		  dim tcoffset as timecode		  		  if movieplayer1.visible and movieSyncOption.value then		    		    movietimer.mode = max(movietimer.mode,1)		    'setmovieinterestingpoints		  end		  haschanged=true		End Sub	#tag EndEvent	#tag Event		Function SyncEnabled() As boolean		  return MovieSyncOption.Value		End Function	#tag EndEvent#tag EndEvents#tag Events FontMenu	#tag Event		Sub Change()		  dim altselstart, altsellength as integer		  style.font = me.text		  haschanged = true		  setformat		  		  altselstart=titlelist.selstart		  altsellength=titlelist.sellength		  titlelist.textFont = me.text		  titlelist.selstart = altselstart		  titlelist.sellength  = altsellength		  		  		exception err as nilObjectException		  msgBox "Nil Object Exception Main.FontMenu.Change"+endofLine+endofLine +"Please report to developer"		exception err2 as outOfBoundsException		  msgBox "Out of Bounds Exception Main.FontMenu.Change"+endofLine+endofLine +"Please report to developer"		  		End Sub	#tag EndEvent	#tag Event		Sub Open()		  dim i as integer		  dim list(-1) as string		  		  for i = 0 to fontcount - 1		    list.append font(i)		  next		  		  for i = 0 to ubound(list)		    me.addrow list(i)		  next		  		  		exception err as nilObjectException		  msgBox "Nil Object Exception Main.FontMenu.Open"+endofLine+endofLine +"Please report to developer"		exception err2 as outOfBoundsException		  msgBox "Out of Bounds Exception Main.FontMenu.Open"+endofLine+endofLine +"Please report to developer"		End Sub	#tag EndEvent#tag EndEvents#tag Events CheckBold	#tag Event		Sub Action()		  style.bold = me.value		  haschanged = true		  setformat		End Sub	#tag EndEvent#tag EndEvents#tag Events CheckItalic	#tag Event		Sub Action()		  style.italic = me.value		  haschanged = true		  setformat		End Sub	#tag EndEvent#tag EndEvents#tag Events CheckUnderline	#tag Event		Sub Action()		  style.underline = me.value		  haschanged = true		  setformat		End Sub	#tag EndEvent#tag EndEvents#tag Events TextColorBox	#tag Event		Sub ColorChange(c as color)		  style.textc = c		  haschanged = true		End Sub	#tag EndEvent#tag EndEvents#tag Events SizeMenu	#tag Event		Sub Change()		  dim i as integer		  dim test as integer		  dim found as boolean		  if me.text = app.Getlabel("Other") then		    NumInput.message.text = app.getlabel("EnterValue")		    NumInput.title = app.getlabel("TextSize")		    NumInput.showModalWithin self		    test = NumInput.value\1		    if test <= 0 then		      NumInput.buttonPressed = "Cancel"		    end		    select case NumInput.buttonPressed		    case "CancelButton"		      for i = 0 to me.listcount-1		        if style.size = val(me.list(i)) then		          me.listindex = i		          exit		        end		      next		    case "OKButton"		      style.size = test		      for i = 0 to me.listcount-1		        if style.size = val(me.list(i)) then		          me.listindex = i		          found = true		        end		      next		      if not found then		        me.addrow str(style.size)		        me.listindex = me.listcount - 1		      end		      setformat		      setwidth		      haschanged = true		    end select		    NumInput.close		  else		    if val(me.text) > 0 then		      style.size = val(me.text)		      setformat		      setwidth		      haschanged = true		    else		      for i = 0 to me.listcount-1		        if style.size = val(me.list(i)) then		          me.listindex = i		          exit		        end		      next		    end		  end		End Sub	#tag EndEvent	#tag Event		Sub Open()		  dim i as integer		  me.deleteAllRows		  me.addrow "24"		  me.addrow "27"		  me.addrow "30"		  me.addrow "33"		  me.addrow "36"		  me.addrow "40"		  me.addrow "44"		  me.addrow "48"		  me.addrow "54"		  me.addrow "60"		  me.addrow "72"		  me.addrow "84"		  me.addrow "96"		  me.addrow "108"		  me.addrow "120"		  me.addrow "132"		  me.addrow "144"		  me.addrow "-"		  me.addrow app.getlabel("Other")		End Sub	#tag EndEvent#tag EndEvents#tag Events TextAlpha	#tag Event		Sub Open()		  dim i as integer		  me.deleteAllRows		  me.addrow "0% "+app.getlabel("Level")		  me.addrow "10%"		  me.addrow "20%"		  me.addrow "30%"		  me.addrow "40%"		  me.addrow "50%"		  me.addrow "60%"		  me.addrow "70%"		  me.addrow "80%"		  me.addrow "90%"		  me.addrow "100%"		End Sub	#tag EndEvent	#tag Event		Sub Change()		  style.textalpha= val(me.text)/100		  haschanged = true		  setformat		End Sub	#tag EndEvent#tag EndEvents#tag Events TextSoft	#tag Event		Sub Open()		  dim i as integer		  me.deleteAllRows		  me.addrow "0 "+app.getlabel("Soft")		  me.addrow "1"		  me.addrow "2"		  me.addrow "3"		  me.addrow "4"		  me.addrow "5"		  me.addrow "6"		  me.addrow "7"		  me.addrow "8"		End Sub	#tag EndEvent	#tag Event		Sub Change()		  style.textsoft = val(me.text)		  haschanged = true		  setformat		End Sub	#tag EndEvent#tag EndEvents#tag Events LeadingMenu	#tag Event		Sub Open()		  dim i as integer		  me.deleteAllRows		  me.addrow "-2"		  me.addrow "-1"		  me.addrow "0 " + app.getlabel("Leading")		  me.addrow "1"		  me.addrow "2"		  me.addrow "3"		  me.addrow "4"		  me.addrow "5"		  me.addrow "6"		  me.addrow "7"		  me.addrow "8"		  me.addrow "9"		  me.addrow "10"		  me.addrow "11"		  me.addrow "12"		  me.addrow "13"		  me.addrow "14"		  me.addrow "15"		  me.addrow "16"		  me.addrow "17"		  me.addrow "18"		  me.addrow "19"		  me.addrow "20"		  me.addrow "21"		  me.addrow "22"		  me.addrow "23"		  me.addrow "24"		End Sub	#tag EndEvent	#tag Event		Sub Change()		  style.leading = val(me.text)		  haschanged = true		  setformat		End Sub	#tag EndEvent#tag EndEvents#tag Events SpacingMenu	#tag Event		Sub Change()		  style.spacing = val(me.text)		  haschanged = true		  setformat		End Sub	#tag EndEvent	#tag Event		Sub Open()		  dim i as integer		  me.deleteAllRows		  me.addrow "-2"		  me.addrow "-1"		  me.addrow "0 " + app.getlabel("Spacing")		  me.addrow "1"		  me.addrow "2"		  me.addrow "3"		  me.addrow "4"		  me.addrow "5"		  me.addrow "6"		  me.addrow "7"		  me.addrow "8"		  me.addrow "9"		  me.addrow "10"		  me.addrow "11"		  me.addrow "12"		  		  		  		End Sub	#tag EndEvent#tag EndEvents#tag Events StyleDT	#tag Event		Sub Action()		  setlayout		End Sub	#tag EndEvent#tag EndEvents#tag Events VideoFormatMenu	#tag Event		Sub Open()		  me.deleteAllRows		  me.addrow "PAL"		  me.addrow "PAL 16:9"		  me.addrow "PAL DVD"		  me.addrow "NTSC"		  me.addrow "NTSC 16:9"		  me.addrow "NTSC DV"		  me.addrow "NTSC 16:9 DV"		  me.addrow "NTSC DVD"		  me.addrow "VGA"		  me.addrow "HD 720p"		  me.addrow "HD 720i"		  me.addrow "HD 1080p"		  me.addrow "HD 1080i"		  me.addrow "2K"		  me.addrow "2K 1.85"		  me.addrow "2K 2.35"		  me.addrow "4K"		  me.addrow "4K 1.85"		  me.addrow "4K 2.35"		  me.addrow "HDV 1080i"		  me.addrow "iPod"		  me.addrow "iPod 16:9"		End Sub	#tag EndEvent	#tag Event		Sub Change()		  dim i as integer		  		  style.setstandard me.text		  		  if windowcount > 0 then		    for i = 0 to windowcount-1		      if window(i) isa monitor then		        monitor.size(monitor.psize)		        monitor.update		        'monitor.close		        'monitor.show		      end if		    next		  end		  		  lslider.maximum = style.width		  style.left.value = min(style.left.value,style.width)		  lslider.value = style.left.value		  lslider.default = style.width*0.1		  		  		  rslider.maximum = style.width		  style.right.value = min(style.right.value,style.width)		  rslider.value = style.right.value		  rslider.default = style.width*0.9		  		  		  vslider.maximum = style.height		  style.ver.value = min(style.ver.value,style.height)		  vslider.value = style.ver.value		  vslider.default = style.height*0.75		  		  setmovieFile getfolderItem(moviepath)		  		  haschanged = true		  setwidth		End Sub	#tag EndEvent#tag EndEvents#tag Events Preview	#tag Event		Sub haspainted(p as picture)		  dim p2, m, m2 as picture		  		  dim s as string		  s = preview.firstline+EndOfLine+preview.secondline		  		  		End Sub	#tag EndEvent	#tag Event		Function Textsizeevent() As integer		  return app.previewtextsize		End Function	#tag EndEvent	#tag Event		Sub Open()		  me.settextsize app.previewtextsize		End Sub	#tag EndEvent#tag EndEvents#tag Events ValignMenu	#tag Event		Sub Open()		  me.addrow app.GetLabel("Top")		  me.addrow app.GetLabel("Center")		  me.addrow app.GetLabel("Bottom")		End Sub	#tag EndEvent	#tag Event		Sub Change()		  style.valign = me.listindex		  haschanged=true		End Sub	#tag EndEvent#tag EndEvents#tag Events VSlider	#tag Event		Sub ValueHasChanged()		  HasChanged = true		End Sub	#tag EndEvent#tag EndEvents#tag Events HalignMenu	#tag Event		Sub Change()		  style.halign = me.listindex		  haschanged=true		  setwidth		End Sub	#tag EndEvent	#tag Event		Sub Open()		  me.deleteAllRows		  me.addrow app.getlabel("Left")		  me.addrow app.getlabel("Center")		  me.addrow app.getlabel("Right")		  me.addrow app.getlabel("Center Left")		  		End Sub	#tag EndEvent#tag EndEvents#tag Events LSlider	#tag Event		Sub ValueHasChanged()		  HasChanged = true		End Sub	#tag EndEvent#tag EndEvents#tag Events RSlider	#tag Event		Sub ValueHasChanged()		  HasChanged = true		End Sub	#tag EndEvent#tag EndEvents#tag Events WrapMenu	#tag Event		Sub Open()		  me.deleteAllRows		  me.addrow app.getlabel("NoWrap")		  me.addrow app.getlabel("SimpleWrap")		  me.addrow app.getlabel("SmartWrap")		  		End Sub	#tag EndEvent	#tag Event		Sub Change()		  style.wrapmethod = me.listindex		  haschanged=true		  setwidth		End Sub	#tag EndEvent#tag EndEvents#tag Events BorderColorBox	#tag Event		Sub ColorChange(c as color)		  style.borderc = c		  haschanged=true		End Sub	#tag EndEvent#tag EndEvents#tag Events BorderWidth	#tag Event		Sub Open()		  dim i as integer		  me.deleteAllRows		  me.addrow "0 "+app.getlabel("Width")		  me.addrow "1"		  me.addrow "2"		  me.addrow "3"		  me.addrow "4"		  me.addrow "5"  // 1.6.2 added 5-8		  me.addrow "6"		  me.addrow "7"		  me.addrow "8"		  me.addrow "9"		  me.addrow "10"		  me.addrow "11"		  me.addrow "12"		End Sub	#tag EndEvent	#tag Event		Sub Change()		  style.borderwidth = val(me.text)		  haschanged = true		  setformat		End Sub	#tag EndEvent#tag EndEvents#tag Events BorderAlpha	#tag Event		Sub Open()		  dim i as integer		  me.deleteAllRows		  me.addrow "0% "+app.getlabel("Level")		  me.addrow "10%"		  me.addrow "20%"		  me.addrow "30%"		  me.addrow "40%"		  me.addrow "50%"		  me.addrow "60%"		  me.addrow "70%"		  me.addrow "80%"		  me.addrow "90%"		  me.addrow "100%"		End Sub	#tag EndEvent	#tag Event		Sub Change()		  style.borderalpha= val(me.text)/100		  haschanged = true		  setformat		  setlayout		End Sub	#tag EndEvent#tag EndEvents#tag Events Bordersoft	#tag Event		Sub Open()		  dim i as integer		  me.deleteAllRows		  me.addrow "0 "+app.getlabel("Soft")		  me.addrow "1"		  me.addrow "2"		  me.addrow "3"		  me.addrow "4"		  me.addrow "5"		  me.addrow "6"		  me.addrow "7"		  me.addrow "8"		End Sub	#tag EndEvent	#tag Event		Sub Change()		  style.bordersoft = val(me.text)		  haschanged = true		  setformat		End Sub	#tag EndEvent#tag EndEvents#tag Events ShadowMarker	#tag Event		Sub MouseUp(X As Integer, Y As Integer)		  if style.shadowx = me.oldx - 10 and style.shadowy = me.oldy - 10 then		  else		    style.shadowx = me.oldx - 10		    style.shadowy = me.oldy - 10		    haschanged = true		  end if		End Sub	#tag EndEvent#tag EndEvents#tag Events Timer1	#tag Event		Sub Action()		  setwidth		End Sub	#tag EndEvent#tag EndEvents#tag Events PreviewDT	#tag Event		Sub Action()		  preview.visible = me.value		  if not me.value then		    previewlabel.text = app.getlabel("Preview")		  end		  setlayout		End Sub	#tag EndEvent#tag EndEvents#tag Events FolderButton	#tag Event		Sub Action()		  dim sd as selectFolderDialog		  dim f as folderitem		  dim documentsfolder as FolderItem		  		  DocumentsFolder = SpecialFolder.Documents		  		  sd = new selectFolderDialog		  if document = nil then		    if documentsfolder<>nil then		      sd.initialDirectory = documentsFolder		    end		  else		    if document.parent<>nil then		      sd.initialDirectory = document.parent		    end		  end		  //f = sd.ShowModalWithin(self)		  f = sd.showmodal		  if f<>nil then		    titlelist.exportfolder = f		    me.caption = f.absolutepath		    'Folderpathlabel.text = f.absolutepath		    Folderpath = f.absolutepath		    haschanged = true		  end		End Sub	#tag EndEvent#tag EndEvents#tag Events ExportFormatMenu	#tag Event		Sub Change()		  dim i as integer		  exportformat = me.text		  app.exportformat = me.text		  if me.text = "PICT" and screen(0).depth < 32 then		    msgbox StErrorMonitorDepth		  end if		  select case left(exportformat,3)		  case "PIC"		    titlelist.suffix = app.pictextension		  case "TIF"		    titlelist.suffix = app.tiffextension		  case "BMP"		    titlelist.suffix = ".bmp"		  case "PNG"		    titlelist.suffix = ".png"		  end		  if exportformat = "TIFF-DVD"  or exportformat = "BMP-DVD" then		    shadowgroup.enabled = false		  else		    shadowgroup.enabled = true		  end		  haschanged = true		  setlayout		End Sub	#tag EndEvent	#tag Event		Sub Open()		  dim i as integer		  me.deleteAllRows		  me.addrow "BMP-DVD"		  #if targetmacos		    me.addrow "PICT"		    me.addrow "PICT-alpha"		  #endif		  me.addrow "PNG"		  me.addrow "TIFF-RLE"		  me.addrow "TIFF"		  me.addrow "TIFF-DVD"		End Sub	#tag EndEvent#tag EndEvents#tag Events ExportDT	#tag Event		Sub Action()		  setlayout		End Sub	#tag EndEvent#tag EndEvents#tag Events RectColorBox	#tag Event		Sub ColorChange(c as color)		  style.rectc = c		  haschanged=true		End Sub	#tag EndEvent#tag EndEvents#tag Events ShadowSoft	#tag Event		Sub Change()		  style.shadowsoft= val(me.text)		  haschanged = true		  setformat		End Sub	#tag EndEvent	#tag Event		Sub Open()		  dim i as integer		  me.deleteAllRows		  me.addrow "0 "+app.getLabel("Soft")		  me.addrow "1"		  me.addrow "2"		  me.addrow "3"		  me.addrow "4"		  me.addrow "5"		  me.addrow "6"		  me.addrow "7"		  me.addrow "8"		End Sub	#tag EndEvent#tag EndEvents#tag Events ShadowAlpha	#tag Event		Sub Open()		  dim i as integer		  me.deleteAllRows		  me.addrow "0% "+app.getlabel("Level")		  me.addrow "10%"		  me.addrow "20%"		  me.addrow "30%"		  me.addrow "40%"		  me.addrow "50%"		  me.addrow "60%"		  me.addrow "70%"		  me.addrow "80%"		  me.addrow "90%"		  me.addrow "100%"		End Sub	#tag EndEvent	#tag Event		Sub Change()		  style.shadowalpha= val(me.text)/100		  haschanged = true		  setformat		End Sub	#tag EndEvent#tag EndEvents#tag Events ShadowColorBox	#tag Event		Sub ColorChange(c as color)		  style.shadowc = c		  haschanged=true		End Sub	#tag EndEvent#tag EndEvents#tag Events RectSoft	#tag Event		Sub Open()		  dim i as integer		  me.deleteAllRows		  me.addrow "0 "+app.getlabel("Soft")		  me.addrow "1"		  me.addrow "2"		  me.addrow "3"		  me.addrow "4"		  me.addrow "5"		  me.addrow "6"		  me.addrow "8"		  me.addrow "7"		End Sub	#tag EndEvent	#tag Event		Sub Change()		  style.rectsoft = val(me.text)		  haschanged = true		  setformat		End Sub	#tag EndEvent#tag EndEvents#tag Events RectAlpha	#tag Event		Sub Change()		  style.rectalpha= val(me.text)/100		  haschanged = true		  setformat		  setlayout		End Sub	#tag EndEvent	#tag Event		Sub Open()		  dim i as integer		  me.deleteAllRows		  me.addrow "0% "+app.getlabel("Level")		  me.addrow "10%"		  me.addrow "20%"		  me.addrow "30%"		  me.addrow "40%"		  me.addrow "50%"		  me.addrow "60%"		  me.addrow "70%"		  me.addrow "80%"		  me.addrow "90%"		  me.addrow "100%"		End Sub	#tag EndEvent#tag EndEvents#tag Events RectForm	#tag Event		Sub Change()		  style.rectform = me.listindex+1 // fixed not yet supported		  haschanged = true		  setformat		End Sub	#tag EndEvent	#tag Event		Sub Open()		  me.init array("1 Rect","2 Rect","Fixed")		  		  me.listindex = max(style.rectform -1,0)		  		End Sub	#tag EndEvent#tag EndEvents#tag Events MovieDT	#tag Event		Sub Action()		  setlayout		End Sub	#tag EndEvent#tag EndEvents#tag Events MoviePlayer1	#tag Event		Function GetOffsetFrames() As integer		  dim tcoffset as timecode		  tcoffset = style.getTimeCode		  tcoffset.settext movieoffsetField.text		  return tcoffset.getframes		  		  		End Function	#tag EndEvent	#tag Event		Sub PositionChangedEvent()		  movietimer.mode =max(movietimer.mode,1)		End Sub	#tag EndEvent	#tag Event		Function HasTitleEvent(pos as double) As integer		  dim i as integer		  if pos<0 then return -1		  if pos>ubound(titlelist.titlemap) then return -1		  I = titlelist.titlemap(pos)		  if i>0 then		    return titlelist.titlereadingspeed(i-1) 		  end		  return -1		End Function	#tag EndEvent	#tag Event		Sub MarkOutEvent(pos as double)		  wavecanvas.setout pos		End Sub	#tag EndEvent	#tag Event		Sub MarkInEvent(pos as double)		  wavecanvas.setin pos		End Sub	#tag EndEvent	#tag Event		Sub WaveFormEvent(p as picture)		  wavecanvas.setpicture p, movieplayer1.position, movieplayer1.samplespersecond		  		End Sub	#tag EndEvent	#tag Event		Sub KeyDownEvent(key as string)		  dim tc, tcin, tcout as timecode		  dim tcoffset as timecode		  dim t as onetitle		  		  tcoffset = style.getTimeCode		  tcoffset.settext movieoffsetField.text		  		  tc = style.getTimeCode		  tc.settotalSeconds(movieplayer1.position)		  tc.plus tcoffset		  		  tcin = style.getTimeCode		  tcin.settotalSeconds(movieplayer1.inpoint)		  tcin.plus tcoffset		  		  tcout = style.getTimeCode		  tcout.settotalSeconds(movieplayer1.outpoint)		  tcout.plus tcoffset		  		  select case key		  case "n"		    movieplayer1.stop		    'movieplayer1.position = movieplayer1.inpoint  // 1.7.3b5		    if tcout.getframes > tcin.getframes then		      titlelist.insertWithTimecode tcin, tcout		      setmovieFocus false		      titlelist.setFocus		    else		      beep		    end		  case "t"		    t = titlelist.gettitle(titlelist.getfirstselectedtitle)		    if t<>nil then		      t.parsetimeCode		      if t.getinpoint<>"" and t.getoutpoint<>"" then		        tcin.settext t.getinpoint		        tcout.settext t.getoutpoint		        setmarks tcin, tcout		        tcin.minus tcoffset		        tcout.minus tcoffset		        movieplayer1.markin tcin.gettotalSeconds		        movieplayer1.markout tcout.gettotalSeconds		      end		    else		      beep		    end		  case "m"		    movieplayer1.stop		    movieplayer1.position = movieplayer1.inpoint  // 1.7.3b5		    if tcout.getframes > tcin.getframes then		      titlelist.updateWithTimecode tcin, tcout		      'setmovieFocus false		      'titlelist.setFocus		    elseif tcout.getframes = 0 and tcin.getframes = 0 then		      titlelist.updateWithTimecode tcin,tcout		    else		      beep		    end		  case "u"		    movieplayer1.stop		    titlelist.joinfromtimecode tc		    setmovieFocus false		    titlelist.setFocus		  case "y"		    movieplayer1.stop		    titlelist.splitFromTimeCode tc, app.splitdistance		    setmovieFocus false		    'tc.setFrames tc.getframes-1 // this one is out		    titlelist.selectFromTimecode tc		    titlelist.setFocus		    'movieplayer1.jog -1		  case "1"		    // option geht nicht, denn das ist ein anderes buchstabe		    movieplayer1.stop		    if keyboard.asyncoptionKey then		      titlelist.trim tc, true, false, -10		      'movieplayer1.jog -10		    else		      titlelist.trim tc, true, false, -1		      'movieplayer1.jog -1		    end		  case "2"		    movieplayer1.stop		    if keyboard.asyncoptionKey then		      		      titlelist.trim tc, true, false, 10		      'movieplayer1.jog 10		      		    else		      		      titlelist.trim tc, true, false, 1		      'movieplayer1.jog 1		      		    end		  case "5"		    movieplayer1.stop		    if keyboard.asyncoptionKey then		      titlelist.trim tc, true, true, -10		      'movieplayer1.jog -10		    else		      titlelist.trim tc, true, true, -1		      movieplayer1.jog -1		    end		  case "6"		    movieplayer1.stop		    if keyboard.asyncoptionKey then		      titlelist.trim tc, true, true, 10		      'movieplayer1.jog 10		    else		      titlelist.trim tc, true, true, 1		      'movieplayer1.jog 1		    end		  case "8"		    movieplayer1.stop		    if keyboard.asyncoptionKey then		      		      titlelist.trim tc, false, true, -10		      'movieplayer1.jog -10		      		    else		      		      titlelist.trim tc, false, true, -1		      'movieplayer1.jog -1		      		    end		  case "9"		    movieplayer1.stop		    if keyboard.asyncoptionKey then		      titlelist.trim tc, false, true, 10		      'movieplayer1.jog 10		    else		      titlelist.trim tc, false, true, 1		      'movieplayer1.jog 1		    end		    		    		    		  end		End Sub	#tag EndEvent	#tag Event		Sub Play()		  movietimer.mode = 2		End Sub	#tag EndEvent#tag EndEvents#tag Events MovieGroup	#tag Event		Function MouseDown(X As Integer, Y As Integer) As Boolean		  'setmovieFocus true		End Function	#tag EndEvent#tag EndEvents#tag Events MovieOffsetField	#tag Event		Sub TextChange()		  haschanged = true		  titlelist.buildTitleMap		End Sub	#tag EndEvent	#tag Event		Sub GotFocus()		  setmovieFocus false		End Sub	#tag EndEvent	#tag Event		Function KeyDown(Key As String) As Boolean		  if key = chr(27) then		    setmovieFocus		    return true		  end		End Function	#tag EndEvent#tag EndEvents#tag Events MovieSyncOption	#tag Event		Sub Action()		  movietimer.mode = max(movietimer.mode,1)		  if titlelisthasfocus then		    setmovieposition titlelist.getselectedTC		  end		End Sub	#tag EndEvent#tag EndEvents#tag Events FrameRateMenu	#tag Event		Sub Open()		  me.deleteAllRows		  me.addrow "23.98"		  me.addrow "24"		  me.addrow "25"		  me.addrow "29.97 DF"		  me.addrow "29.97 NDF"		  me.addrow "30"		  me.addrow "50"		  me.addrow "59.94"		End Sub	#tag EndEvent	#tag Event		Sub Change()		  style.framerate = me.text		  movieplayer1.framerate = style.getTimeCode.speedP		  haschanged = true		  setformat		End Sub	#tag EndEvent#tag EndEvents#tag Events MovieTimer	#tag Event		Sub Action()		  dim tc,tc2 as timecode		  dim tcoffset as timecode		  dim mpr as double		  		  if moviedt.value = false then return // looking for crash bug		  		  moviestatusLabel.settext movieplayer1.status		  		  if movieplayer1.movie = nil then		    tc = style.getTimeCode		    moviepositionLabel.text = tc.gettext		    return		  end		  		  if movieplayer1.keydelay>0 then movieplayer1.keydelay = movieplayer1.keydelay-1		  		  // avid style JKL does interfere with the playback		  if movieplayer1.rate = 0.25 then		    if not keyboard.asyncKeyDown(37) then 		      movieplayer1.stop		      'elseif not keyboard.asynckeyDown(40) then		      'movieplayer1.rate = 1.0		    end		  elseif movieplayer1.rate = -0.25 then		    if not keyboard.asyncKeyDown(38) then 		      movieplayer1.stop		      'elseif not keyboard.asynckeyDown(40) then		      'movieplayer1.rate = -1.0		    end		  end		  		  		  tcoffset = style.getTimeCode		  tcoffset.settext movieoffsetField.text		  		  tc = style.getTimeCode		  tc.settotalSeconds(movieplayer1.position)		  tc.plus tcoffset		  moviepositionLabel.text = tc.gettext		  		  if movieplayer1.visible and moviesyncOption.value then		    		    //1.7.6 neu nur ändern wenn nicht titlelistfocus		    'titlelist.previewfromtimecode(tc)		    		    // 1.7.7. nur ändern, wenn die position geändert hat.		    		    		    if not titlelisthasfocus then		      if movieplayer1.rate<>0 or movieplayer1.position<>lastposition then		        		        titlelist.previewfromtimecode(tc)		        titlelist.scrolltoSelection		        'titlelist.selectFromTimecode(tc)		        		      end		    end		  end		  		  lastposition = movieplayer1.position		  tc.settotalSeconds(movieplayer1.inpoint)		  tc.plus tcoffset		  		  tc2 = tc.clone		  tc2.settotalSeconds(movieplayer1.outpoint)		  tc2.plus tcoffset		  		  setmarks tc, tc2		  		  		  timeline1.duration = movieplayer1.duration		  timeline1.position = movieplayer1.position		  timeline1.redraw		  		  wavecanvas.setposition movieplayer1.position		  		  updatenow		End Sub	#tag EndEvent#tag EndEvents#tag Events MovieCanvas	#tag Event		Sub GotFocus()		  		  if not moviefocus then		    setmoviefocus true		  end		  		  me.useFocusRing = true		End Sub	#tag EndEvent	#tag Event		Function MouseDown(X As Integer, Y As Integer) As Boolean		  if movieplayer1.movie <>nil  then		    setmovieFocus true		  end		  return true		End Function	#tag EndEvent	#tag Event		Sub MouseUp(X As Integer, Y As Integer)		  if movieplayer1.movie = nil  then		    call Fileimportmoviecommand		  end		End Sub	#tag EndEvent#tag EndEvents#tag Events Timeline1	#tag Event		Sub MouseDownEvent()		  if movieplayer1.movie <> nil then		    setmovieFocus true		  end		End Sub	#tag EndEvent	#tag Event		Sub PositionEvent(pos as double)		  if movieplayer1.movie <> nil then		    movieplayer1.setposition pos		  end		End Sub	#tag EndEvent#tag EndEvents#tag Events EventReceiver1	#tag Event		Sub DoEventsEvent()		  self.updatenow		End Sub	#tag EndEvent#tag EndEvents#tag Events WaveCanvas	#tag Event		Function GetLastPosition() As double		  return movieplayer1.position		End Function	#tag EndEvent	#tag Event		Sub PositionEvent(d as double)		  if movieplayer1.movie <> nil then		    movieplayer1.setposition d		  end		End Sub	#tag EndEvent	#tag Event		Sub GetWaveformEvent()		  'if movieplayer1.rate=0 then  // cannot do it while playing		  		  if movieplayer1.movie <> nil then		    movieplayer1.setwaveform		  end		End Sub	#tag EndEvent	#tag Event		Sub Mousedownevent()		  if movieplayer1.movie <> nil then		    setmovieFocus true		  end		End Sub	#tag EndEvent#tag EndEvents#tag Events Titlelistselector	#tag Event		Function MouseDown(X As Integer, Y As Integer) As Boolean		  titlelist.setfocus		End Function	#tag EndEvent#tag EndEvents