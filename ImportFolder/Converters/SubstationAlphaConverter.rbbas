#tag ClassProtected Class SubstationAlphaConverterInherits cTitlelistConverter	#tag Event		Sub DoConvert(s as string)		  dim i,j,countlines,item, fieldcount as integer		  dim start, ende, tctext as string		  dim tit as ctitle		  dim separator as string		  dim field, fields(-1), titles(-1), title, substring, id, body as string		  dim state as string		  dim d, titledict as dictionary		  		  separator = guessseparator(s)		  substring = nthfield(s,separator + "[Events]",2)		  		  		  titles = split(substring,separator)		  countlines = ubound(titles)		  		  for i = 0 to ubound(titles) // ignore first		    if titles(i)<>"" then		      id = nthfield(titles(i),":",1)		      body = ltrim(mid(titles(i),len(id)+2))		      fields = split(body,",")		      select case id		      case "Format"		        d = new dictionary		        for j = 0 to ubound(fields)		          d.value(trim(fields(j))) = j		        next		        fieldcount = ubound(fields)		      case "Dialogue"		        titledict = new dictionary		        for j = 0 to fieldcount		          titledict.value(j) = fields(j)		        next		        for j = fieldcount+1 to ubound(fields)		          titledict.value(fieldcount) = titledict.value(fieldcount)+","+fields(j)		        next		        tit = new ctitle		        item = item + 1		        if d.hasKey("Start") then		          if titledict.hasKey(d.value("Start")) then		            tit.start = ConvertTC(titledict.value(d.value("Start")))		          end		        end		        if d.hasKey("End") then		          if titledict.hasKey(d.value("End")) then		            tit.ende = ConvertTC(titledict.value(d.value("End")))		          end		        end		        if d.hasKey("Name") then		          if titledict.hasKey(d.value("Name")) and titledict.value(d.value("Name")) <> "NTP" then		            tit.filename = titledict.value(d.value("Name"))		          end		        end		        tit.eventnr = item		        if d.hasKey("Text") then		          if titledict.hasKey(d.value("Text")) then		            tit.lines.append titledict.value(d.value("Text"))		          end		        end		        titlelist.titles.append tit		      end		      if i mod 10 = 0 then		        progress 33+66*i/countlines		      end		      if userCancelled then		        exit		      end		    end		  next		  		  createedl uppercase(documentname),0,ubound(titlelist.titles) 		  		End Sub	#tag EndEvent	#tag Method, Flags = &h0		Sub Constructor()		  label = "Substation Alpha (.ssa)"		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Function ConvertTC(s as string) As string		  // 00:01:46,850 --> 00:01:49,770		  		  dim seconds, frames,result as string		  dim count as integer		  		  		  seconds = nthfield(s,".",1)+":00"		  frames = nthfield(s,".",2)		  		  count = tc.tctoFrames(tc.textToTC(seconds))		  count = count + val(frames) * framerate / 100		  		  		  result = tc.tctotext(tc.framestotc(count))		  		  		  		  		  return result		End Function	#tag EndMethod	#tag ViewBehavior		#tag ViewProperty			Name="binaryfile"			Group="Behavior"			InitialValue="0"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="charactercount"			Group="Behavior"			InitialValue="0"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="clipnames"			Group="Behavior"			InitialValue="0"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="documentname"			Group="Behavior"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="endline"			Group="Behavior"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="framerate"			Group="Behavior"			InitialValue="0"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="Index"			Visible=true			Group="ID"			InitialValue="-2147483648"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="italicstring"			Group="Behavior"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="label"			Group="Behavior"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="Left"			Visible=true			Group="Position"			InitialValue="0"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="Name"			Visible=true			Group="ID"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="Super"			Visible=true			Group="ID"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="Top"			Visible=true			Group="Position"			InitialValue="0"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty	#tag EndViewBehaviorEnd Class#tag EndClass