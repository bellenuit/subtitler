#tag ClassProtected Class FilmTextStudioConverterInherits cTitlelistConverter	#tag Event		Sub DoConvert(s as string)		  dim i,j,counttitles, countlines, item as integer		  dim line, source, headersep as string		  dim firstline as string		  dim evt as cedlevent		  dim tit as ctitle		  dim fieldsep as string		  dim lines(-1) as string		  dim titles(-1) as string		  dim words(-1) as string		  dim title, word as string		  dim startline, wordval as integer		  dim state as string		  dim startframes, endframes as integer		  dim tc as TimeCodeOld		  		  		  headersep = "----------"		  endline = guessseparator(s)		  source = nthfield(s,headersep,countfields(s,headersep))		  titles = split(source,endline + endline + endline)		  		  // remove header		  		  tc = new TimeCodeOld(framerate)		  		  counttitles = ubound(titles)		  		  for each title in titles		    if left(title,1) <> "F" then //filestruktur ignore		      tit = new ctitle		      titlelist.titles.append tit		      lines = split(title,endline)		      for i = ubound(lines) downto 0		        if lines(i) = "" then		          lines.remove i		        end		      next		      if ubound(lines) > -1 then		        line = lines(0)		        line = replaceall(line,"-"," ")		        words = split(line, " ")		        for i = ubound(words) downto 0		          if words(i) = "" then		            words.remove i		          end		        next		        if ubound(words) >= 5 then		          tit.eventnr = val(words(0))		          startframes = 16 * val(words(1)) + val(words(2))		          endframes = 16 * val(words(4)) + val(words(5)) + 1		          tit.start = tc.tCtoText(tc.framesTotC(startframes))		          tit.ende = tc.tCtoText(tc.framesTotC(endframes))		        end		      end		      for i = 1 to ubound(lines)		        word = trim(lines(i))		        if word <> "" then		          tit.lines.append word		        end		      next		    end		    		    i = i + 1		    if i > 0 and i mod 10 = 0 then		      progress 33+66*i/(counttitles+1)		    end		    if userCancelled then		      exit		    end		  next		  		  		  createEDL uppercase(documentname),0,ubound(titlelist.titles)		  		End Sub	#tag EndEvent	#tag Method, Flags = &h0		Sub Constructor()		  label = "Filmtext Studio"		End Sub	#tag EndMethod	#tag Note, Name = sample		F I L S T R U K T U R 		--------------------------------------------------------------------------------		TEXTNR    START SKIFTE  STOPP SKIFTE  KOPPLING  TYPSNITT      POSITION          		÷ V E R T E X T                                     		U N D E R T E X T                                   		--------------------------------------------------------------------------------				   0         0- 0  N       0- 0  N    N                                       				                  COMPADRE AKT1                   		                  F B S : 68-15                   						   2       275- 0  N     278- 0  N    N                                       				                   Vi gÂr hem.                    		                                                  						   3       304- 7  N     307-14  N    J                                       				                 ñ Var ‰r Sandra?                 		                ñ Hon ‰r d‰rinne.                 					#tag EndNote	#tag ViewBehavior		#tag ViewProperty			Name="binaryfile"			Group="Behavior"			InitialValue="0"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="charactercount"			Group="Behavior"			InitialValue="0"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="clipnames"			Group="Behavior"			InitialValue="0"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="documentname"			Group="Behavior"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="endline"			Group="Behavior"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="framerate"			Group="Behavior"			InitialValue="0"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="Index"			Visible=true			Group="ID"			InitialValue="-2147483648"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="italicstring"			Group="Behavior"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="label"			Group="Behavior"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="Left"			Visible=true			Group="Position"			InitialValue="0"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="Name"			Visible=true			Group="ID"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="Super"			Visible=true			Group="ID"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="Top"			Visible=true			Group="Position"			InitialValue="0"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty	#tag EndViewBehaviorEnd Class#tag EndClass