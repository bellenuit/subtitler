#tag ClassProtected Class TitraConverterInherits cTitlelistConverter	#tag Event		Sub DoConvert(s as string)		  dim i,j,countlines,item as integer		  dim start, ende, tctext as string		  dim tit as ctitle		  dim separator as string		  dim line, lines(-1), titles(-1), title as string		  dim state as string		  		  tc.gauge 35		  		  separator = guessseparator(s)		  titles = split(s,"@" +separator)		  countlines = ubound(titles)		  		  for i = 1 to ubound(titles) // ignore first		    title = titles(i)		    lines = split(title,separator)		    tit = new ctitle		    		    if ubound(lines) >= 0 then		      tctext = replaceall(lines(0),"*","")		      tctext = trim(tctext)		      tctext = nthfield(tctext," ",1)		      start = nthfield(tctext,"-",1)		      start = tc.tctotext(tc.feettotc(val(start)))		      ende = nthfield(tctext,"-",2)		      ende = tc.tctotext(tc.framestotc(tc.feettoframes(val(ende))+1))		      tit.start = start		      tit.ende = ende		    end		    for j = 1 to ubound(lines)		      line = lines(j)		      if left(line,2) = "**" then		        tit.lines.append "/ " + line		      elseif line<>"" then		        tit.lines.append line		      end		    next		    		    if ubound(tit.lines) > -1 then		      item = item + 1		      tit.eventnr = item		      titlelist.titles.append tit		    end		    if i mod 10 = 0 then		      progress 33+66*i/countlines		    end		    if userCancelled then		      exit		    end		  next		  		  createedl uppercase(documentname),0,ubound(titlelist.titles) 		  		End Sub	#tag EndEvent	#tag Method, Flags = &h0		Sub Constructor()		  label = "Titra"		End Sub	#tag EndMethod	#tag ViewBehavior		#tag ViewProperty			Name="binaryfile"			Group="Behavior"			InitialValue="0"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="charactercount"			Group="Behavior"			InitialValue="0"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="clipnames"			Group="Behavior"			InitialValue="0"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="documentname"			Group="Behavior"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="endline"			Group="Behavior"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="framerate"			Group="Behavior"			InitialValue="0"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="Index"			Visible=true			Group="ID"			InitialValue="-2147483648"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="italicstring"			Group="Behavior"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="label"			Group="Behavior"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="Left"			Visible=true			Group="Position"			InitialValue="0"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="Name"			Visible=true			Group="ID"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="Super"			Visible=true			Group="ID"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="Top"			Visible=true			Group="Position"			InitialValue="0"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty	#tag EndViewBehaviorEnd Class#tag EndClass