#tag ClassProtected Class SUBCavenaConverterInherits cTitleListConverter	#tag Event		Sub DoConvert(s as string)		  dim s2,lines(-1),line, textlines(-1), textline, titles(-1), title as string		  dim tit as ctitle		  dim start,ende, text as string		  dim t, i,l as integer		  		  s2 = replacelineEndings(s,endofLine)		  		  		  lines =split(s2,endofline)		  		  for each line in lines		    if left(line,2) <> "* " then		      // recognize tc by format: length = 23 characters and contains a \		      if len(line) = 23 and instr(line,"\") > 0 then		        if tit<> nil then		          titlelist.titles.append tit		        end		        tit = new cTitle		        start =NthField(line,"\",1)		        ende = NthField(line,"\",2)		        start = tc.tctotext(tc.texttotc(start)) // clean tc		        ende = tc.tctotext(tc.texttotc(ende))		        tit.start = start		        tit.ende = ende		      else		        if tit<>nil then		          tit.lines.append striptags(line)		        end		      end		      		      		    end		  next		  if tit<> nil then		    titlelist.titles.append tit		  end		  		  		  		  createedl uppercase(documentname),0,ubound(titlelist.titles)		  		End Sub	#tag EndEvent	#tag Method, Flags = &h0		Sub Constructor()		  label = "Cavena SUB"		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Function StripTags(s as string) As string		  dim r as RegEx		  		  r = new regex		  r.SearchPattern = "<.*>"		  r.ReplacementPattern = ""		  return r.replace(s)		  		End Function	#tag EndMethod	#tag ViewBehavior		#tag ViewProperty			Name="binaryfile"			Group="Behavior"			InitialValue="0"			Type="boolean"			InheritedFrom="cTitleListConverter"		#tag EndViewProperty		#tag ViewProperty			Name="charactercount"			Group="Behavior"			InitialValue="0"			Type="integer"			InheritedFrom="cTitleListConverter"		#tag EndViewProperty		#tag ViewProperty			Name="clipnames"			Group="Behavior"			InitialValue="0"			Type="boolean"			InheritedFrom="cTitleListConverter"		#tag EndViewProperty		#tag ViewProperty			Name="documentname"			Group="Behavior"			Type="string"			EditorType="MultiLineEditor"			InheritedFrom="cTitleListConverter"		#tag EndViewProperty		#tag ViewProperty			Name="endline"			Group="Behavior"			Type="string"			EditorType="MultiLineEditor"			InheritedFrom="cTitleListConverter"		#tag EndViewProperty		#tag ViewProperty			Name="framerate"			Group="Behavior"			InitialValue="0"			Type="double"			InheritedFrom="cTitleListConverter"		#tag EndViewProperty		#tag ViewProperty			Name="Index"			Visible=true			Group="ID"			InitialValue="-2147483648"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="italicstring"			Group="Behavior"			Type="string"			EditorType="MultiLineEditor"			InheritedFrom="cTitleListConverter"		#tag EndViewProperty		#tag ViewProperty			Name="label"			Group="Behavior"			Type="string"			EditorType="MultiLineEditor"			InheritedFrom="cTitleListConverter"		#tag EndViewProperty		#tag ViewProperty			Name="Left"			Visible=true			Group="Position"			InitialValue="0"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="Name"			Visible=true			Group="ID"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="Super"			Visible=true			Group="ID"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="Top"			Visible=true			Group="Position"			InitialValue="0"			InheritedFrom="Object"		#tag EndViewProperty	#tag EndViewBehaviorEnd Class#tag EndClass