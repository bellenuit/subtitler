#tag ClassProtected Class QuickTimeConverterInherits cTitlelistConverter	#tag Event		Sub DoConvert(s as string)		  dim i,countlines,item as integer		  dim line,firstword as string		  dim start, ende as string		  dim tit as ctitle		  dim s2 as string		  dim fr as integer		  		  if instr(s,"{QTtext}") = 0 then		    msgBox "This is not a Quicktime text file"		    return		  end		  		  s2 = replacelineEndings(s,endofLine)		  s2 = replaceall(s2,"} ","}"+endofLine)		  countlines = countfields(s2,endofLine)		  		  for i = 1 to countlines		    line = nthfield(s2,endofLine,i)		    firstword = left(line,1)		    		    if firstword = "[" then		      start =  replaceall(replaceall(line,"[",""),"]","")		      		      // calculate hundreds and thousands		      if instr(start,".")>0 then		        fr = round(val("0." +nthfield(start,".",2))*tc.fps)		        if tc.fps= 29.97 then		          start = nthField(start,".",1) + ";"+right("0"+str(fr),2)		        else		          start = nthField(start,".",1) + ":"+right("0"+str(fr),2)		        end		      end		      		      if tit<>nil then 		        tit.ende = tc.tctotext(tc.framestotc(tc.tctoframes(tc.textToTC(start))-app.splitdistance))		         		        if ubound(tit.lines)>=0 then titlelist.titles.append tit		      end		      		      item = item + 1		      tit = new ctitle		      tit.eventnr = item		      tit.start = start		    elseif firstword = "{" then		      // ignore QT format tags		      		      		      // ignore only until closing tag, can have some text.		      		    elseif line<>"" then		      if tit<>nil then		        tit.lines.append line		      end		    end		    if i mod 10 = 0 then		      progress 33+66*i/countlines		    end		    if userCancelled then		      exit		    end		  next		  if tit<>nil and ubound(tit.lines)>=0 then		    titlelist.titles.append tit		  end		  createEDL uppercase(documentname),0,ubound(titlelist.titles)		  		End Sub	#tag EndEvent	#tag Method, Flags = &h0		Sub Constructor()		  label = "QuickTime"		End Sub	#tag EndMethod	#tag ViewBehavior		#tag ViewProperty			Name="binaryfile"			Group="Behavior"			InitialValue="0"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="charactercount"			Group="Behavior"			InitialValue="0"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="clipnames"			Group="Behavior"			InitialValue="0"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="documentname"			Group="Behavior"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="endline"			Group="Behavior"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="framerate"			Group="Behavior"			InitialValue="0"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="Index"			Visible=true			Group="ID"			InitialValue="-2147483648"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="italicstring"			Group="Behavior"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="label"			Group="Behavior"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="Left"			Visible=true			Group="Position"			InitialValue="0"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="Name"			Visible=true			Group="ID"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="Super"			Visible=true			Group="ID"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="Top"			Visible=true			Group="Position"			InitialValue="0"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty	#tag EndViewBehaviorEnd Class#tag EndClass