#tag ClassProtected Class Titra4ConverterInherits cTitlelistConverter	#tag Event		Sub DoConvert(s as string)		  dim i,j,countlines,item as integer		  dim start, ende, tctext as string		  dim tit as ctitle		  dim separator as string		  dim line, lines(-1), titles(-1), titles2(-1), title, titlenum as string		  dim state as string		  dim s2 as string		  		  tc.gauge 35		  		  s2 = replacelineEndings(s,endofLine)		  		  // remove header		  'titles = split(s2,endofLine)		  'for each line in titles		  'if left(line,1)<>"@" then titles2.Append line		  'next		  's2 = join(titles2,EndOfLine)		  		  titles = split(s2,endofLine+endofLine)		  countlines = ubound(titles)		  		  for each title in titles		    lines =split(title,endofLine)		    if left(lines(0),1) = "@" then continue // header		    if ubound(lines)>-4 then		      titlenum = lines(0)		      start = trim(lines(1))		      ende = trim(lines(2))		      start = tc.tctotext(tc.feettotc(val(start)))		      ende = tc.tctotext(tc.feettotc(val(ende)))		      tit = new ctitle		      tit.start = start		      tit.ende = ende		      tit.eventnr = val(titlenum)		      		      for j = 3 to ubound(lines)		        line = lines(j)		        if left(line,1) = "#" and right(line,1)="#" then		          tit.lines.append "<i>" + mid(line,2,len(line)-2) + "</i>"		        elseif line<>"" then		          tit.lines.append line		        end		      next		      		      titlelist.titles.append tit		      		    end		    		    i = i+1		    if i mod 10 = 0 then		      progress 33+66*i/countlines		    end		    if userCancelled then		      exit		    end		  next		  		  createedl uppercase(documentname),0,ubound(titlelist.titles) 		  		End Sub	#tag EndEvent	#tag Method, Flags = &h0		Sub Constructor()		  label = "Titra 4"		End Sub	#tag EndMethod	#tag Note, Name = Untitled						@ 25/08/10		@ TITRA TEST		@ C:\Documents and Settings\titrapro-operateur\Bureau\CARINE BOB.E05		@ Images/Pieds   : 16		@ START          : 0:00		@ PremiŠre Image :    12.00		@ DerniŠre Image :  1437.12				1.		36.07		38.03		C'est cadenassé.				2.		39.09		44.10		Personne n'a parlé		d'une barrière cadenassée.				3.		44.14		47.08		Ruth, détends-toi.				4.		47.13		49.08		#Tout va bien.#				5.		62.00		64.10		On va y aller à pied.				6.		129.07		131.02		Venez !				7.		203.05		206.13		Hailsham doit ressembler à ça maintenant.				8.		211.14		216.01		Tu as des nouvelles		des élèves de Hailsham?				9.		216.05		218.06		Parfois, oui.				10.		221.09		223.09		#J'ai entendu dire	#tag EndNote	#tag ViewBehavior		#tag ViewProperty			Name="binaryfile"			Group="Behavior"			InitialValue="0"			Type="boolean"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="charactercount"			Group="Behavior"			InitialValue="0"			Type="integer"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="clipnames"			Group="Behavior"			InitialValue="0"			Type="boolean"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="documentname"			Group="Behavior"			Type="string"			EditorType="MultiLineEditor"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="endline"			Group="Behavior"			Type="string"			EditorType="MultiLineEditor"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="framerate"			Group="Behavior"			InitialValue="0"			Type="double"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="Index"			Visible=true			Group="ID"			InitialValue="-2147483648"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="italicstring"			Group="Behavior"			Type="string"			EditorType="MultiLineEditor"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="label"			Group="Behavior"			Type="string"			EditorType="MultiLineEditor"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="Left"			Visible=true			Group="Position"			InitialValue="0"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="Name"			Visible=true			Group="ID"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="Super"			Visible=true			Group="ID"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="Top"			Visible=true			Group="Position"			InitialValue="0"			InheritedFrom="Object"		#tag EndViewProperty	#tag EndViewBehaviorEnd Class#tag EndClass