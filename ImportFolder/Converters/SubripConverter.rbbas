#tag ClassProtected Class SubripConverterInherits cTitlelistConverter	#tag Event		Sub DoConvert(s as string)		  dim i,j,countlines,item as integer		  dim start, ende, tctext as string		  dim tit as ctitle		  dim separator as string		  dim line, lines(-1), titles(-1), title, substring as string		  dim state as string		  		  substring = s		  		  separator = guessseparator(substring)		  titles = split(substring,separator+separator)		  countlines = ubound(titles)		  		  for i = 0 to ubound(titles) 		    if titles(i)<>"" then		      title = titles(i)		      lines = split(title,separator)		      tit = new ctitle		      		      if ubound(lines) >= 0 then item = val(lines(0))		      		      if ubound(lines) >= 1 then		        tit.start = converttc(trim(nthfield(lines(1),"-->",1)))		        tit.ende = converttc(trim(nthfield(lines(1),"-->",2)))		      end		      for j = 2 to ubound(lines)		        if lines(j) <> "" then tit.lines.append lines(j)		      next		      		      if ubound(tit.lines) > -1 then		        tit.eventnr = item		        titlelist.titles.append tit		      end		      if i mod 10 = 0 then		        progress 33+66*i/countlines		      end		      if userCancelled then		        exit		      end		    end		  next		  		  createedl uppercase(documentname),0,ubound(titlelist.titles) 		  		End Sub	#tag EndEvent	#tag Method, Flags = &h0		Sub Constructor()		  label = "Subrip (.srt)"		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Function ConvertTC(s as string) As string		  // 00:01:46,850 --> 00:01:49,770		  		  dim seconds, frames,result as string		  dim count as integer		  		  		  seconds = left(s,8)+":00"		  frames = mid(s,10)		  		  count = tc.tctoFrames(tc.textToTC(seconds))		  count = count + val(frames) * framerate / 1000		  		  		  result = tc.tctotext(tc.framestotc(count))		  		  		  		  		  return result		End Function	#tag EndMethod	#tag ViewBehavior		#tag ViewProperty			Name="binaryfile"			Group="Behavior"			InitialValue="0"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="charactercount"			Group="Behavior"			InitialValue="0"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="clipnames"			Group="Behavior"			InitialValue="0"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="documentname"			Group="Behavior"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="endline"			Group="Behavior"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="framerate"			Group="Behavior"			InitialValue="0"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="Index"			Visible=true			Group="ID"			InitialValue="-2147483648"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="italicstring"			Group="Behavior"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="label"			Group="Behavior"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="Left"			Visible=true			Group="Position"			InitialValue="0"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="Name"			Visible=true			Group="ID"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="Super"			Visible=true			Group="ID"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="Top"			Visible=true			Group="Position"			InitialValue="0"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty	#tag EndViewBehaviorEnd Class#tag EndClass