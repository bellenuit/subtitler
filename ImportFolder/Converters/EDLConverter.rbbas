#tag ClassProtected Class EDLConverterInherits cTitlelistConverter	#tag Event		Sub DoConvert(s as string)		  dim i,countlines,item, filenamestart as integer		  dim line, first as string		  dim start, ende, test as string		  dim evt as cedlevent		  dim tit as ctitle		  dim fieldsep as string		  dim lines(-1), words(-1) as string		  		  endline = guessseparator(s)		  		  lines = split(s,endline)		  		  for each line in lines		    first = left(line,1)		    select case first		    case "0","1","2","3","4","5","6","7","8","9"		      // if it starts with a number, it is an event		      		      // we will be flexible. we look for a space after 50 characters and take then the next two words		      test = mid(line,50)		      words = split(test," ")		      		      if ubound(words) >= 2 then		        // find the start		        start = words(1)		        // find the end		        ende = words(2)		        		        item = item + 1		        tit = new ctitle		        tit.eventnr = item		        tit.start = start		        tit.ende = ende		        titlelist.titles.append tit		      end		      		    case "*"		      // if it starts with a "*", it is a comment. we catch the comment file		      filenamestart = instr(line,"CLIP NAME: ")		      if instr(line,"CLIP NAME: ") > 0 then		        if filenamestart > 0 then		          filenamestart = filenamestart + LEN("CLIP NAME: ")		          if tit<>nil then		            tit.filename = trim(mid(line,filenamestart))		          end		        end		      end		      		    else		      // we ignore all the rest		    end select		    		    		    if item > 0 and item mod 10 = 0 then		      progress 33+66*item/ubound(lines)		    end		    if userCancelled then		      exit		    end		  next		  		  createEDL uppercase(documentname),0,ubound(titlelist.titles)		  		End Sub	#tag EndEvent	#tag Method, Flags = &h0		Sub Constructor()		  label = "CMX 3600"		End Sub	#tag EndMethod	#tag ViewBehavior		#tag ViewProperty			Name="binaryfile"			Group="Behavior"			InitialValue="0"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="charactercount"			Group="Behavior"			InitialValue="0"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="clipnames"			Group="Behavior"			InitialValue="0"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="documentname"			Group="Behavior"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="endline"			Group="Behavior"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="framerate"			Group="Behavior"			InitialValue="0"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="Index"			Visible=true			Group="ID"			InitialValue="-2147483648"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="italicstring"			Group="Behavior"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="label"			Group="Behavior"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="Left"			Visible=true			Group="Position"			InitialValue="0"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="Name"			Visible=true			Group="ID"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="Super"			Visible=true			Group="ID"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="Top"			Visible=true			Group="Position"			InitialValue="0"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty	#tag EndViewBehaviorEnd Class#tag EndClass