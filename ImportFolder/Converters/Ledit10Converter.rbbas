#tag ClassProtected Class Ledit10ConverterInherits cTitlelistConverter	#tag Event		Sub DoConvert(s as string)		  dim i,j,k,countlines,item, counttextlines as integer		  dim line,firstword,newline as string		  dim start, ende, timemark, text, textline, words(-1), word, filename as string		  dim tit as ctitle		  dim pos as integer		  dim s2 as string		  dim bi as boolean		  		  		  		  endline = guessseparator(s)		  		  countlines = countfields(s,endline)		  		  		  pos = 1		  for i = 1 to countlines		    line = nthfield(s,endline,i)		    if left(line,1) = "*" then		      line = replaceall(line,chr(9)," ")		      		      words= split(line," ")		      for j = ubound(words) downto 0		        if words(j) = "" then words.remove j		      next		      		      if ubound(words)>1 then		        timemark = words(1)		        		        start = nthfield(timemark,"-",1)		        ende = nthfield(timemark,"-",2)		        if instr(start,":")>0 then		          // timecode		        elseif instr(start,".")>0 then 		          // feet frames		          start = tc.tctotext(tc.FeetToTC(val(start)))		          ende = tc.tctotext(tc.FeetToTC(val(ende)))		        else 		          // frames		          start = tc.tctotext(tc.framestotc(val(start)))		          ende = tc.tctotext(tc.framestotc(val(ende)))		        end		        		        item = item + 1		        		        tit = new ctitle		        titlelist.titles.append tit		        tit.filename = filename		        tit.eventnr = item		        tit.start = trim(start)		        tit.ende = trim(ende)		      end		      if i mod 10 = 0 then		        progress 33+66*i/countlines		      end		      if userCancelled then		        exit		      end		    elseif left(line,1) = "@" then		      tit = nil		    elseif tit<>nil then 		      		      bi = false		      newline = ""		      for k = 1 to len(line)		        if isitalic(pos+k-1) then		          if not bi then newline = newline + "<i>"		          bi = true		          newline = newline + mid(line,k,1)		        else		          if bi then newline = newline + "</i>"		          bi = false		          newline = newline + mid(line,k,1)		        end		      next		      if bi then newline = newline + "</i>"		      tit.lines.append newline		    end		    pos = pos + len(line)+len(endline)		  next		  		  createEDL uppercase(documentname),0,ubound(titlelist.titles)		  		End Sub	#tag EndEvent	#tag Method, Flags = &h0		Sub Constructor()		  label = "Ledit10"		End Sub	#tag EndMethod	#tag ViewBehavior		#tag ViewProperty			Name="binaryfile"			Group="Behavior"			InitialValue="0"			Type="boolean"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="charactercount"			Group="Behavior"			InitialValue="0"			Type="integer"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="clipnames"			Group="Behavior"			InitialValue="0"			Type="boolean"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="documentname"			Group="Behavior"			Type="string"			EditorType="MultiLineEditor"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="endline"			Group="Behavior"			Type="string"			EditorType="MultiLineEditor"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="framerate"			Group="Behavior"			InitialValue="0"			Type="double"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="Index"			Visible=true			Group="ID"			InitialValue="-2147483648"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="italicstring"			Group="Behavior"			Type="string"			EditorType="MultiLineEditor"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="label"			Group="Behavior"			Type="string"			EditorType="MultiLineEditor"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="Left"			Visible=true			Group="Position"			InitialValue="0"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="Name"			Visible=true			Group="ID"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="Super"			Visible=true			Group="ID"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="Top"			Visible=true			Group="Position"			InitialValue="0"			InheritedFrom="Object"		#tag EndViewProperty	#tag EndViewBehaviorEnd Class#tag EndClass