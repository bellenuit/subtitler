#tag ClassProtected Class AdobeEncoreConverterInherits cTitlelistConverter	#tag Event		Sub DoConvert(s as string)		  dim i,j,counttitles, countlines, item as integer		  dim tit as ctitle		  dim lines(-1), line as string		  dim words(-1), word as string		  dim tctest as timecode		  dim first as boolean		  		  endline = guessseparator(s)		  		  lines = split(s,endline)		  		  counttitles = ubound(lines)		  		  first = true		  		  tctest= new timecode		  tctest.SetFps tc.fps		  		  for each line in lines		    // if first word is a number and second word is a timecode 		    //or second word is a  timecode then this is a new title		    // else it is a second line of an existing title		    		    // can be taken as: if second word is a timecode (either in with number or out without)		    		    words = split(line," ")		    // remove all empty words		    for j = ubound(words) downto 0		      if words(j) = "" then words.remove j		    next		    		    		    		    		    if first or ubound(words) >= 1 and tctest.IsTC(words(1))  then		      i = i + 1		      tit = new ctitle		      tit.eventnr = i		      if instr(words(0),":")>0 then		        tit.start = words(0)		        tit.ende = words(1)		      else		        tit.start = words(1)		        tit.ende = words(2)		      end		      j = instr(line,tit.ende) + len(tit.ende) +1		      tit.lines.append mid(line,j)		      titlelist.titles.append tit		    else		      tit.lines.append line		    end		    		    if i > 0 and i mod 10 = 0 then		      progress 33+66*i/counttitles		    end		    if userCancelled then		      exit		    end		    first = false		  next		  		  createEDL uppercase(documentname),0,ubound(titlelist.titles)		  		End Sub	#tag EndEvent	#tag Method, Flags = &h0		Sub Constructor()		  label ="Adobe Encore Text"		End Sub	#tag EndMethod	#tag ViewBehavior		#tag ViewProperty			Name="binaryfile"			Group="Behavior"			InitialValue="0"			Type="boolean"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="charactercount"			Group="Behavior"			InitialValue="0"			Type="integer"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="clipnames"			Group="Behavior"			InitialValue="0"			Type="boolean"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="documentname"			Group="Behavior"			Type="string"			EditorType="MultiLineEditor"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="endline"			Group="Behavior"			Type="string"			EditorType="MultiLineEditor"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="framerate"			Group="Behavior"			InitialValue="0"			Type="double"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="Index"			Visible=true			Group="ID"			InitialValue="-2147483648"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="italicstring"			Group="Behavior"			Type="string"			EditorType="MultiLineEditor"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="label"			Group="Behavior"			Type="string"			EditorType="MultiLineEditor"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="Left"			Visible=true			Group="Position"			InitialValue="0"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="Name"			Visible=true			Group="ID"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="Super"			Visible=true			Group="ID"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="Top"			Visible=true			Group="Position"			InitialValue="0"			InheritedFrom="Object"		#tag EndViewProperty	#tag EndViewBehaviorEnd Class#tag EndClass