#tag ClassProtected Class PowerSubtitlingConverterInherits cTitlelistConverter	#tag Event		Sub DoConvert(s as string)		  dim i,j,countlines,item as integer		  dim firstline, secondline as string		  dim start, ende, tctext, titletext as string		  dim header as string		  dim tit as ctitle		  dim separator as string		  dim lines(-1) as string		  dim words(-1) as string		  		  separator = guessseparator(s)		  		  lines = split(s,separator)		  		  		  // remove empty lines at start and end		  while trim(lines(0)) = "" 		    lines.remove 0		  wend		  while trim(lines(ubound(lines))) = "" 		    lines.remove ubound(lines)		  wend		  		  // ensure we have at least a multiple of 4		  if ubound(lines) mod 4 <> 3 then		    redim lines( (ubound(lines) \ 4) * 4  + 3 )		  end		  		  countlines = ubound(lines)		  for i = 0 to countlines step 4		    header = lines(i)		    words = split(header," ")		    redim words(2)		    item= val(replace(words(0),")",""))		    if words(1) <> "" then start = words(1) else start = ""		    if words(2) <> "" then ende = words(2) else ende = ""		    firstline = lines(i+1)		    if lines(i+2) <> "" then secondline = lines(i+2) else secondline = ""		    tit = new ctitle		    titlelist.titles.append tit		    tit.eventnr = item		    tit.start = start		    tit.ende = ende		    tit.lines.append firstline		    if secondline <> "" then tit.lines.append secondline		    		    if i mod 10 = 0 then		      progress 33+66*i/countlines		    end		    if userCancelled then		      exit		    end		  next		  		  createedl uppercase(documentname),0,ubound(titlelist.titles) 		  		End Sub	#tag EndEvent	#tag Method, Flags = &h0		Sub Constructor()		  label = "Power Subtitling"		End Sub	#tag EndMethod	#tag ViewBehavior		#tag ViewProperty			Name="binaryfile"			Group="Behavior"			InitialValue="0"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="charactercount"			Group="Behavior"			InitialValue="0"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="clipnames"			Group="Behavior"			InitialValue="0"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="documentname"			Group="Behavior"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="endline"			Group="Behavior"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="framerate"			Group="Behavior"			InitialValue="0"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="Index"			Visible=true			Group="ID"			InitialValue="-2147483648"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="italicstring"			Group="Behavior"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="label"			Group="Behavior"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="Left"			Visible=true			Group="Position"			InitialValue="0"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="Name"			Visible=true			Group="ID"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="Super"			Visible=true			Group="ID"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="Top"			Visible=true			Group="Position"			InitialValue="0"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty	#tag EndViewBehaviorEnd Class#tag EndClass