#tag ClassProtected Class STLConverterInherits cTitlelistConverter	#tag Event		Sub DoConvert(s as string)		  dim i,j,countlines,item, counttextlines as integer		  dim line,firstword as string		  dim start, ende, text, textline as string		  dim tit as ctitle		  		  endline = guessseparator(s)		  		  countlines = countfields(s,endline)		  		  for i = 1 to countlines		    line = nthfield(s,endline,i)		    firstword = left(line,1)		    		    if firstword = "$" then		      // ignore formatting at that time		    elseif firstword = "" then		      // ignore empty lines		    elseif left(line,2)="//" then		      // ignore comments		    else		      if instr(line,chr(9))>0 then		        start = nthfield(line,chr(9),1)		        ende = nthfield(line,chr(9),2)		        text = nthfield(line,chr(9),3) 		        if countfields(line,chr(9))>3 then		          text = nthfield(line,chr(9),3) + "|" + nthfield(line,chr(9),4)		        end		      else		        start = nthfield(line,",",1)		        ende = nthfield(line,",",2)		        text = mid(line, len(start) + len(ende) + 2 * len(",") + 1)		      end		      counttextlines = countfields(text,"|")		      item = item + 1		      		      tit = new ctitle		      titlelist.titles.append tit		      tit.eventnr = item		      tit.start = trim(start)		      tit.ende = trim(ende)		      for j = 1 to counttextlines		        textline = nthField(text,"|",j)		        textline = trim(textline)		        		        // remove  inline formatting		        while instr(textline,"^b") > 0 		          textline = replace(textline,"^b","<b>")		          textline = replace(textline,"^b","</b>")		        wend		        while instr(textline,"^i") > 0 		          textline = replace(textline,"^i","<i>")		          textline = replace(textline,"^i","</i>")		        wend		        while instr(textline,"^u") > 0 		          textline = replace(textline,"^u","<u>")		          textline = replace(textline,"^u","</u>")		        wend		        tit.lines.append trim(textline)		      next		    end		    if i mod 10 = 0 then		      progress 33+66*i/countlines		    end		    if userCancelled then		      exit		    end		  next		  		  createEDL uppercase(documentname),0,ubound(titlelist.titles)		  		End Sub	#tag EndEvent	#tag Method, Flags = &h0		Sub Constructor()		  label = "STL Text"		End Sub	#tag EndMethod	#tag ViewBehavior		#tag ViewProperty			Name="binaryfile"			Group="Behavior"			InitialValue="0"			Type="boolean"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="charactercount"			Group="Behavior"			InitialValue="0"			Type="integer"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="clipnames"			Group="Behavior"			InitialValue="0"			Type="boolean"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="documentname"			Group="Behavior"			Type="string"			EditorType="MultiLineEditor"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="endline"			Group="Behavior"			Type="string"			EditorType="MultiLineEditor"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="framerate"			Group="Behavior"			InitialValue="0"			Type="double"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="Index"			Visible=true			Group="ID"			InitialValue="-2147483648"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="italicstring"			Group="Behavior"			Type="string"			EditorType="MultiLineEditor"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="label"			Group="Behavior"			Type="string"			EditorType="MultiLineEditor"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="Left"			Visible=true			Group="Position"			InitialValue="0"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="Name"			Visible=true			Group="ID"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="Super"			Visible=true			Group="ID"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="Top"			Visible=true			Group="Position"			InitialValue="0"			InheritedFrom="Object"		#tag EndViewProperty	#tag EndViewBehaviorEnd Class#tag EndClass