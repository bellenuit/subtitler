#tag ClassProtected Class CinetypConverterInherits cTitlelistConverter	#tag Event		Sub DoConvert(s as string)		  dim i,countlines,offset,act,item,startframe,endframe,titleoffset as integer		  dim line,firstword,edlname,words(-1) as string		  dim evt as cedlevent		  dim tit as ctitle		  dim j as integer		  		  endline = guessseparator(s)		  		  countlines = countfields(s,endline)		  		  for i = 1 to countlines		    line = nthfield(s,endline,i)		    firstword = nthfield(line," ",1)		    		    select case firstword		    case "input"		    case "output"		    case "convert"		    case "ACT"		      if ubound(titlelist.titles)>=titleoffset then		        createEDL edlname,titleoffset,ubound(titlelist.titles)		        titleoffset = ubound(titlelist.titles) + 1		      end		      edlname = uppercase(documentname)+" "+line		      offset = val(nthfield(line," ",countfields(line," ")))		      act = act+1000000		    else		      if left(line,1) = chr(9) then		        if tit<>nil then		          tit.lines.append mid(line,2)		        end		      elseif val(firstword)>0 then		        item = val(firstword)		        words = split(line," ")		        for j = ubound(words) downto 0		          if words(j) = "" then words.remove j		        next		        if ubound(words)>=2 then		          startframe = val(words(1))		          endframe = val(words(2))		          if instr(words(1),":")>0 then		            startframe = feettoframes(words(1))		            endframe = feettoframes(words(2))		          end		        end		        tit = new ctitle		        titlelist.titles.append tit		        tit.eventnr = item		        tit.start = tc.tctotext(tc.framestotc(startframe-offset)+act)		        tit.ende = tc.tctotext(tc.framestotc(endframe-offset)+act)		      end		    end		    if i mod 10 = 0 then		      progress 33+66*i/countlines		    end		    if userCancelled then		      exit		    end		  next		  		  if ubound(titlelist.titles)>=titleoffset then		    createEDL edlname,titleoffset,ubound(titlelist.titles)		    titleoffset = ubound(titlelist.titles) + 1		  end		  		  		  		End Sub	#tag EndEvent	#tag Method, Flags = &h0		Sub Constructor()		  label = "Cinetyp Film"		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Function FeetToFrames(s as string) As integer		  dim feet, frames as integer		  		  feet = val(nthField(s,":",1))		  frames = val(nthField(s,":",2))		  		  return 16*feet+frames		End Function	#tag EndMethod	#tag ViewBehavior		#tag ViewProperty			Name="binaryfile"			Group="Behavior"			InitialValue="0"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="charactercount"			Group="Behavior"			InitialValue="0"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="clipnames"			Group="Behavior"			InitialValue="0"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="documentname"			Group="Behavior"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="endline"			Group="Behavior"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="framerate"			Group="Behavior"			InitialValue="0"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="Index"			Visible=true			Group="ID"			InitialValue="-2147483648"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="italicstring"			Group="Behavior"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="label"			Group="Behavior"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="Left"			Visible=true			Group="Position"			InitialValue="0"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="Name"			Visible=true			Group="ID"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="Super"			Visible=true			Group="ID"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="Top"			Visible=true			Group="Position"			InitialValue="0"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty	#tag EndViewBehaviorEnd Class#tag EndClass