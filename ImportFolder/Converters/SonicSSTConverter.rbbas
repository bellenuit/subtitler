#tag ClassProtected Class SonicSSTConverterInherits cTitlelistConverter	#tag Event		Sub DoConvert(s as string)		  dim i,j,countlines,item as integer		  dim start, ende, tctext as string		  dim tit as ctitle		  dim separator as string		  dim word, words(-1), titles(-1), title, substring as string		  dim state as string		  dim tab as string		  dim maxbound as integer		  dim d as dictionary		  		  separator = guessseparator(s)		  tab = chr(9)		  		  if instr(s,separator+"##"+separator)>0 then		    substring = nthfield(s,separator+"##"+separator,2)		  else		    substring = s		  end		  		  // replace tabs with spaces		  substring = replaceall(substring,tab," ")		  		  titles = split(substring,separator)		  countlines = ubound(titles)		  		  d = new dictionary		  d.value("NUMBER") = 0		  d.value("START") = 1		  d.value("END") = 2		  d.value("FILE_NAME") = 3		  if ubound(titles) > -1 then		    words = split(titles(0)," ")		    for i = 0 to ubound(words)		      d.value(words(i)) = i		    next		    maxbound = max(ubound(words),3)		  end		  		  for i = 1 to ubound(titles) // ignore first		    words = split(titles(i)," ")		    redim words(max(ubound(words),maxbound))		    		    tit = new ctitle		    if d.haskey("START") then		      tit.start = words(d.value("START"))		    end		    if d.haskey("END") then		      tit.ende = words(d.value("END"))		    end		    if d.haskey("FILE_NAME") then		      tit.filename = words(d.value("FILE_NAME"))		      		    end		    		    titlelist.titles.append tit		    		    if i mod 10 = 0 then		      progress 33+66*i/countlines		    end		    if userCancelled then		      exit		    end		    		  next		  		  createedl uppercase(documentname),0,ubound(titlelist.titles) 		  		End Sub	#tag EndEvent	#tag Method, Flags = &h0		Sub Constructor()		  label = "Sonic Scenarist (.sst)"		End Sub	#tag EndMethod	#tag ViewBehavior		#tag ViewProperty			Name="binaryfile"			Group="Behavior"			InitialValue="0"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="charactercount"			Group="Behavior"			InitialValue="0"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="clipnames"			Group="Behavior"			InitialValue="0"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="documentname"			Group="Behavior"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="endline"			Group="Behavior"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="framerate"			Group="Behavior"			InitialValue="0"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="Index"			Visible=true			Group="ID"			InitialValue="-2147483648"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="italicstring"			Group="Behavior"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="label"			Group="Behavior"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="Left"			Visible=true			Group="Position"			InitialValue="0"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="Name"			Visible=true			Group="ID"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="Super"			Visible=true			Group="ID"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty		#tag ViewProperty			Name="Top"			Visible=true			Group="Position"			InitialValue="0"			InheritedFrom="cTitlelistConverter"		#tag EndViewProperty	#tag EndViewBehaviorEnd Class#tag EndClass