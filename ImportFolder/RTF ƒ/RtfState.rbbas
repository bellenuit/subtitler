#tag ClassProtected Class RtfState	#tag Method, Flags = &h0		Function Clone() As RTFState		  dim out as RTFstate		  out = new RTFstate		  out.backgroundcolor = backgroundcolor		  out.bold = bold		  out.encoding = encoding		  out.expanded = expanded		  out.font = font		  out.foregroundcolor = foregroundcolor		  out.italic = italic		  out.outline = outline		  out.shadow = shadow		  out.textsize = textsize		  out.underline = underline		  out.capitals = capitals		  out.smallcapitals = smallcapitals		  out.alignment  = alignment		  out.nativeencoding = nativeencoding		  		  return out		End Function	#tag EndMethod	#tag Method, Flags = &h0		Sub Constructor()		  font = "System"		  textsize = 12		  setplain		  foregroundcolor = rgb(0,0,0)		  //change 1.1		  alignment = 1		  		  #if targetmacOS then		    nativeencoding = encodings.utf8		  #else		    nativeencoding = encodings.utf8		  #endif		  encoding = encodings.uTF8		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Function Decode(parameter as integer) As string		  'dim s as string		  's = nativeencoding.chr(parameter)		  '		  '		  '		  '		  '		  '		  'if encoding <>nil then		  's = s.convertEncoding(encoding)		  'end		  '		  'return s		  		  		  // seems to be completely wrong		  		  		  dim s as string		  		  if encoding<>nil then		    s = encoding.chr(parameter)		    s = s.convertencoding(nativeencoding)		  else		    s = nativeencoding.chr(parameter)		  end		  		  return s		  		End Function	#tag EndMethod	#tag Method, Flags = &h0		Function DecodeUnicode(parameter as integer) As string		  Dim c as TextConverter		  dim s as string		  		  s = encodings.utf8.chr(parameter)		  		  		  // exceptions		  if parameter = 8213 then		    s = encodings.utf8.chr(2015) // see http://www.fileformat.info/info/unicode/char/2015/index.htm		    // apparently someone mixes entity and unicode character		  end		  		  if encoding <>nil then		    //new		    return s.convertEncoding(encoding)		  else		    return s		  end		End Function	#tag EndMethod	#tag Method, Flags = &h0		Sub SetEncoding(enc as string, par as integer)		  select case enc		  case "mac"		    encoding = encodings.macroman		    //new		  case "unicode"		    encoding = encodings.utf8		  case "ansi" //à vérifier    // <-- CONVERTED		    encoding = encodings.windowsaNSI '&h500		  case "pc"//à vérifier    // <-- CONVERTED		    encoding = encodings.windowsaNSI '&h500		  case "pca"//à vérifier    // <-- CONVERTED		    encoding = encodings.windowsaNSI '&h500		  case "ansicpg"		    encoding = encodings.windowsaNSI ' &h500		  case "ansicp"		    select case par		      '\ansicpgNThis keyword represents the ANSI code page that is used to perform the Unicode to ANSI conversion when writing RTF text. N represents the code page in decimal. 		      'This is typically set to the default ANSI code page of the run-time environment (for example \ansicpg1252 for U.S. Windows). 		      'The reader can use the same ANSI code page to convert ANSI text back to Unicode. Possible values include: 		    case 437  // United States IBM		    case 708  // Arabic (ASMO 708)		    case 709  // Arabic (ASMO 449+, BCON V4)		    case 710  // Arabic (transparent Arabic)		    case 711  // Arabic (Nafitha Enhanced)		    case 720  // Arabic (transparent ASMO)		    case 819  // Windows 3.1 (United States and Western Europe)		    case 850  // IBM multilingual		    case 852  // Eastern European		      		    case 860  // Portuguese		      encoding = encodings.dosportuguese		      'encoding = &h0415		    case 862  // Hebrew		      encoding = encodings.doshebrew		      'encoding = &h0417		    case 863  // French Canadian		      encoding = encodings.dosCanadianFrench		      'encoding = &h0418		    case 864  // Arabic		      encoding = encodings.dosarabic		      'encoding = &h0419		    case 865  // Norwegian		      encoding = encodings.dosnordic		      'encoding = &h041A		    case 866 // Soviet Union		      encoding = encodings.dosCyrillic		      'encoding = &h041B		    case 874  // Thai		      encoding = encodings.dosthai		      'encoding = &h041D		    case 932  // Japanese		      encoding = encodings.dosjapanese		      'encoding = &h0420		    case 936  // Simplified Chinese		      encoding = encodings.doschineseSimplif		      'encoding = &h0421		    case 949  // Korean		      encoding = encodings.doskorean		      'encoding = &h0422		    case 950  // Traditional Chinese		      encoding = encodings.doschineseTrad		      'encoding = &h0423		    case 1250  // Windows 3.1 (Eastern European)		      encoding = encodings.windowsLatin2		      'encoding = &h501		    case 1251  //Windows 3.1 (Cyrillic)		      encoding = encodings.windowscyrillic		      'encoding = &h502		    case 1252  //Western European		      encoding = encodings.windowsLatin1		      'encoding = &h500		    case 1253  // Greek		      encoding = encodings.windowsgreek		      'encoding = &h503		    case 1254  // Turkish		      encoding = encodings.dosturkish		      'encoding = &h504 //?		    case 1255  // Hebrew		      encoding = encodings.windowsHebrew		      'encoding = &h505		    case 1256  //Arabic		      encoding = encodings.windowsarabic		      'encoding = &h506		    case 1257  //Baltic		      encoding = encodings.windowsbalticRim		      'encoding = &h507		    case 1258 // Vietnamese		      encoding = encodings.windowsvietnamese		      'encoding = &h508		    case 1361  // Johab		      encoding = encodings.windowsKoreanJohab		      'encoding = &h510		    end		  case "deflang"		    // not sure this belongs really to here		  case "fcharset"		    select case par		    case 0 // ANSI		      encoding = encodings.windowsaNSI		      'encoding = &h500		    case 1 // Default		    case 2  //Symbol		    case 3  // Invalid		    case 77 // Mac		      encoding = encodings.macroman		      'encoding = 0		    case 128  //Shift Jis		    case 129  //Hangul		    case 130  //Johab		    case 134  // GB2312		    case 136  // Big5		      'encoding = encodings.		      'encoding =  &h0A03		    case 161  //Greek		    case 162 //Turkish		    case 163  //Vietnamese		    case 177  //Hebrew		    case 178  //Arabic		    case 179  //Arabic Traditional		    case 180  //Arabic user		    case 181  //Hebrew user		    case 186  //Baltic		    case 204  //Russian		    case 222  //Thai		    case 238  //Eastern European		    case 254  //PC 437		    case 255  //OEM		    case 256		      // unicode?		    end		  end		  		  'base		  'MacRoman 0		  'MacJapanese 1		  'MacChineseTrad 2		  'MacKorean 3		  'MacArabic 4		  'MacHebrew 5		  'MacGreek 6		  'MacCyrillic 7		  'MacDevanagari 9		  'MacGurmukhi 10		  'MacGujarati 11		  'MacOriya 12		  'MacBengali 13		  'MacTamil 14		  'MacTelugu 15		  'MacKannada 16		  'MacMalayalam 17		  'MacSinhalese 18		  'MacBurmese 19		  'MacKhmer 20		  'MacThai 21		  'MacLaotian 22		  'MacGeorgian 23		  'MacArmenian 24		  'MacChineseSimp 25		  'MacTibetan 26		  'MacMongolian 27		  'MacEthiopic 28		  'MacCentralEurRoman 29		  'MacVietnamese 30		  'MacExtArabic 31		  'MacSymbol 33		  'MacDingbats 34		  'MacTurkish 35		  'MacCroatian 36		  'MacIcelandic 37		  'MacRomanian 38		  'MacCeltic 39		  'MacGaelic 40		  'MacUnicode &h7E		  'MacFarsi &h8C		  'MacUkrainian &h98		  'MacInuit &hEC		  'MacVT100 &hFC		  'MacHFS &hFF		  'UnicodeDefault &h0100		  'UnicodeV1_1 &h0101		  'ISO10646_1933 &h0101		  'UnicodeV2_0 &h0103		  'Unicodev2_1 &h0103		  'ISOLatin1 &h0201		  'ISOLatin2 &h0202		  'ISOLatin3 &h0203		  'ISOLatin4 &h0204		  'ISOLatinCyrillic &h0205		  'ISOLatinArabic &h0206		  'ISOLatinGreek &h0207		  'ISOLatinHebrew &h0208		  'ISOLatin5 &h0209		  'DOSLatinUS &h0400		  'DOSGreek &h0405		  'DOSBalticRim &h0405		  'DOSLatin1 &h0410		  'DOSGreek1 &h0411		  'DOSLatin2 &h0412		  'DOSCyrillic &h0413		  'DOSTurkish &h0414		  'DOCPortuguese &h0415		  'DOSIslandic &h0416		  'DOSHebrew &h0417		  'DOSCanadianFrench &h0418		  'DOSArabic &h0419		  'DOSNordic &h041A		  'DOSRussian &h041B		  'DOSGreek2 &h041C		  'DOSThai &h041D		  'DOSJapanese &h0420		  'DOSChineseSimplif &h0421		  'DOSKorean &h0422		  'DOSChineseTrad &h0423		  'WindowsLatin1 &h0500		  'WindowsANSI &h0500		  'WindowsLatin2 &h0501		  'WindowsCryillic &h0502		  'WindowsGreek &h0503		  'WindowsLatin5 &h0504		  'WindowsHebrew &h0505		  'WindowsArabic &h0506		  'WindowsBalticRim &h0507		  '461		  'WindowsVietnamese &h0508		  'WindowsKoreanJohab &h0510		  'US_ASCII &h0600		  'JIS_X0201_76 &h0620		  'JIS_X0208_83 &h0621		  'JIS_X0208_90 &h0622		  'JIS_X0212_90 &h0623		  'JIS_C6226_78 &h0624		  'GB_2312_80 &h0630		  'GBK_95 &h0631		  'KSC_5601_87 &h0640		  'KSC_5601_92_Johab &h0641		  'CNS_11643_92_P1 &h0651		  'CNS_11643_92_P2 &h0652		  'CNS_11643_92_P3 &h0653		  'ISO_2022_JP &h0820		  'ISO_2022_JP_2 &h0821		  'ISO_2022_CN &h0830		  'ISO_2022_CN_EXT &h0831		  'ISO_2022_KR &h0840		  'EUC_JP &h0920		  'EUC_CN &h0930		  'EUC_TW &h0931		  'EUC_KR &h0940		  'ShiftJIS &h0A01		  'KOI8_R &h0A02		  'Big5 &h0A03		  'MacRomanLatin1 &h0A04		  'HZ_GB_2312 &h0A05		  'NextStepLatin &h0B01		  'EBCDIC_US &h0C01		  'EBCDIC_CP037 &h0C02		  'MultiRun &h0FFF		  'MacTradChinese 2		  'MacRSSymbol 8		  'MacSimpChinese 25		  'MacGeez 28		  'MacEastEurRoman 29		  'MacUninterp 32		  		  // microsoft deflang table		  		  'Afrikaans0x04361078		  'Albanian0x041c1052		  'Arabic0x04011025		  'Arabic Algeria0x14015121		  'Arabic Bahrain0x3c0115361		  'Arabic Egypt0x0c013073		  'Arabic General0x00011		  'Arabic Iraq0x08012049		  'Arabic Jordan0x2c0111265		  'Arabic Kuwait0x340113313		  'Arabic Lebanon0x300112289		  'Arabic Libya0x10014097		  'Arabic Morocco0x18016145		  'Arabic Oman0x20018193		  'Arabic Qatar0x400116385		  'Arabic Syria0x280110241		  'Arabic Tunisia0x1c017169		  'Arabic U.A.E.0x380114337		  'Arabic Yemen0x24019217		  'Armenian0x042b1067		  'Assamese0x044d1101		  'Azeri Cyrillic0x082c2092		  'Azeri Latin0x042c1068		  'Basque0x042d1069		  'Bengali0x04451093		  'Bosnia Herzegovina0x101a4122		  'Bulgarian0x04021026		  'Burmese0x04551109		  'Byelorussian0x04231059		  'Catalan0x04031027		  'Chinese China0x08042052		  'Chinese General0x00044		  'Chinese Hong Kong0x0c043076		  'Chinese Macao0x0c043076		  'Chinese Singapore0x10044100		  'Chinese Taiwan0x04041028		  'Croatian0x041a1050		  'Czech0x04051029		  'Danish0x04061030		  'Dutch Belgium0x08132067		  'Dutch Standard0x04131043		  'English Australia0x0c093081		  'English Belize0x280910249		  'English British0x08092057		  'English Canada0x10094105		  'English Caribbean0x24099225		  'English General0x00099		  'English Ireland0x18096153		  'English Jamaica0x20098201		  'English New Zealand0x14095129		  'English Philippines0x340913321		  'English South Africa0x1c097177		  'English Trinidad0x2c0911273		  'English United States0x04091033		  'English Zimbabwe0x04091033		  'Estonian0x04251061		  'Faerose0x04381080		  'Farsi0x04291065		  'Finnish0x040b1035		  'French0x040c1036		  'French Belgium0x080c2060		  'French Cameroon0x2c0c11276		  'French Canada0x0c0c3084		  'French Cote d'Ivoire0x300c12300		  'French Luxembourg0x140c5132		  'French Mali0x340c13324		  'French Monaco0x180c6156		  'French Reunion0x200c8204		  'French Senegal0x280c10252		  'French Swiss0x100c4108		  'French West Indies0x1c0c7180		  'French Zaire0x240c9228		  'Frisian0x04621122		  'Gaelic0x043c1084		  'Gaelic Ireland0x083c2108		  'Galician0x04561110		  'Georgian0x04371079		  'German0x04071031		  'German Austrian0x0c073079		  'German Liechtenstein0x14075127		  'German Luxembourg0x10074103		  'German Switzerland0x08072055		  'Greek0x04081032		  'Gujarati0x04471095		  'Hebrew0x040d1037		  'Hindi0x04391081		  'Hungarian0x040e1038		  'Icelandic0x040f1039		  'Indonesian0x04211057		  'Italian0x04101040		  'Italian Switzerland0x08102064		  'Japanese0x04111041		  'Kannada0x044b1099		  'Kashmiri0x04601120		  'Kashmiri India0x08602144		  'Kazakh0x043f1087		  'Khmer0x04531107		  'Kirghiz0x04401088		  'Konkani0x04571111		  'Korean0x04121042		  'Korean Johab0x08122066		  'Lao0x04541108		  'Latvian0x04261062		  'Lithuanian0x04271063		  'Lithuanian Classic0x08272087		  'Macedonian0x043e1086		  'Malay0x043e1086		  'Malay Brunei Darussalam0x083e2110		  'Malayalam0x044c1100		  'Maltese0x043a1082		  'Manipuri0x04581112		  'Marathi0x044e1102		  'Mongolian0x04501104		  'Nepali0x04611121		  'Nepali India0x08612145		  'Norwegian Bokmal0x04141044		  'Norwegian Nynorsk0x08142068		  'Oriya0x04481096		  'Polish0x04151045		  'Portuguese Brazil0x04161046		  'Portuguese Iberian0x08162070		  'Punjabi0x04461094		  'Rhaeto-Romanic0x04171047		  'Romanian0x04181048		  'Romanian Moldova0x08182072		  'Russian0x04191049		  'Russian Moldova0x08192073		  'Sami Lappish0x043b1083		  'Sanskrit0x044f1103		  'Serbian Cyrillic0x0c1a3098		  'Serbian Latin0x081a2074		  'Sindhi0x04591113		  'Slovak0x041b1051		  'Slovenian0x04241060		  'Sorbian0x042e1070		  'Spanish Argentina0x2c0a11274		  'Spanish Bolivia0x400a16394		  'Spanish Chile0x340a13322		  'Spanish Colombia0x240a9226		  'Spanish Costa Rica0x140a5130		  'Spanish Dominican Republic0x1c0a7178		  'Spanish Ecuador0x300a12298		  'Spanish El Salvador0x440a17418		  'Spanish Guatemala0x100a4106		  'Spanish Honduras0x480a18442		  'Spanish Mexico0x080a2058		  'Spanish Modern0x0c0a3082		  'Spanish Nicaragua0x4c0a19466		  'Spanish Panama0x180a6154		  'Spanish Paraguay0x3c0a15370		  'Spanish Peru0x280a10250		  'Spanish Puerto Rico0x500a20490		  'Spanish Traditional0x040a1034		  'Spanish Uruguay0x380a14346		  'Spanish Venezuela0x200a8202		  'Sutu0x04301072		  'Swahili0x04411089		  'Swedish0x041d1053		  'Swedish Finland0x081d2077		  'Tajik0x04281064		  'Tamil0x04491097		  'Tatar0x04441092		  'Telugu0x044a1098		  'Thai0x041e1054		  'Tibetan0x04511105		  'Tsonga0x04311073		  'Tswana0x04321074		  'Turkish0x041f1055		  'Turkmen0x04421090		  'Ukranian0x04221058		  'Urdu0x04201056		  'Urdu India0x08202080		  'Uzbek Cyrillic0x08432115		  'Uzbek Latin0x04431091		  'Venda0x04331075		  'Vietnamese0x042a1066		  'Welsh0x04521106		  'Xhosa0x04341076		  'Yiddish0x043d1085		  'Zulu0x04351077		  '		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub SetPlain()		  bold = false		  italic = false		  underline = false		  expanded = 0		  outline = false		  shadow = false		  capitals = false		  smallcapitals = false		  		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub Version()		  // 1.2 20.2.3 tries in unicode, not working		  // 1.1. 4.2.02 alignment property: 0 def, 1 left, 2 center, 3 right, 4 justified		  //  and encoding w2k compatible		  // 1.0a2 9.11.00 no changes in this class  		   // 1.0a1 14.10.00		End Sub	#tag EndMethod	#tag Property, Flags = &h0		alignment As integer	#tag EndProperty	#tag Property, Flags = &h0		backgroundcolor As color	#tag EndProperty	#tag Property, Flags = &h0		bold As boolean	#tag EndProperty	#tag Property, Flags = &h0		capitals As boolean	#tag EndProperty	#tag Property, Flags = &h0		encoding As textencoding	#tag EndProperty	#tag Property, Flags = &h0		expanded As double	#tag EndProperty	#tag Property, Flags = &h0		font As string	#tag EndProperty	#tag Property, Flags = &h0		foregroundcolor As color	#tag EndProperty	#tag Property, Flags = &h0		italic As boolean	#tag EndProperty	#tag Property, Flags = &h0		nativeencoding As textencoding	#tag EndProperty	#tag Property, Flags = &h0		outline As boolean	#tag EndProperty	#tag Property, Flags = &h0		shadow As boolean	#tag EndProperty	#tag Property, Flags = &h0		smallcapitals As boolean	#tag EndProperty	#tag Property, Flags = &h0		textsize As double	#tag EndProperty	#tag Property, Flags = &h0		underline As boolean	#tag EndProperty	#tag ViewBehavior		#tag ViewProperty			Name="alignment"			Group="Behavior"			InitialValue="0"			Type="integer"		#tag EndViewProperty		#tag ViewProperty			Name="backgroundcolor"			Group="Behavior"			InitialValue="&h000000"			Type="color"		#tag EndViewProperty		#tag ViewProperty			Name="bold"			Group="Behavior"			InitialValue="0"			Type="boolean"		#tag EndViewProperty		#tag ViewProperty			Name="capitals"			Group="Behavior"			InitialValue="0"			Type="boolean"		#tag EndViewProperty		#tag ViewProperty			Name="expanded"			Group="Behavior"			InitialValue="0"			Type="double"		#tag EndViewProperty		#tag ViewProperty			Name="font"			Group="Behavior"			Type="string"			EditorType="MultiLineEditor"		#tag EndViewProperty		#tag ViewProperty			Name="foregroundcolor"			Group="Behavior"			InitialValue="&h000000"			Type="color"		#tag EndViewProperty		#tag ViewProperty			Name="Index"			Visible=true			Group="ID"			InitialValue="-2147483648"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="italic"			Group="Behavior"			InitialValue="0"			Type="boolean"		#tag EndViewProperty		#tag ViewProperty			Name="Left"			Visible=true			Group="Position"			InitialValue="0"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="Name"			Visible=true			Group="ID"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="outline"			Group="Behavior"			InitialValue="0"			Type="boolean"		#tag EndViewProperty		#tag ViewProperty			Name="shadow"			Group="Behavior"			InitialValue="0"			Type="boolean"		#tag EndViewProperty		#tag ViewProperty			Name="smallcapitals"			Group="Behavior"			InitialValue="0"			Type="boolean"		#tag EndViewProperty		#tag ViewProperty			Name="Super"			Visible=true			Group="ID"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="textsize"			Group="Behavior"			InitialValue="0"			Type="double"		#tag EndViewProperty		#tag ViewProperty			Name="Top"			Visible=true			Group="Position"			InitialValue="0"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="underline"			Group="Behavior"			InitialValue="0"			Type="boolean"		#tag EndViewProperty	#tag EndViewBehaviorEnd Class#tag EndClass