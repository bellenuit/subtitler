#tag ClassProtected Class RtfColor	#tag Method, Flags = &h0		Sub addcolor(col as color)		  c.append col		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Function count() As integer		  return ubound(c)		End Function	#tag EndMethod	#tag Method, Flags = &h0		Function getcolor(n as integer) As color		  if n>0 and n<=ubound(c) then		    return c(n)		  else		    return rgb(0,0,0)		  end		End Function	#tag EndMethod	#tag Method, Flags = &h0		Function getid(col as color) As integer		  dim i as integer		  for i = 1 to count 		    if c(i)=col then		      return i		    end		  next		  return 0		End Function	#tag EndMethod	#tag Method, Flags = &h0		Function getstring() As string		  dim out as string		  dim i as integer		  out = "{\colortbl;"		  for i = 1 to count		    out = out + "\red"+str(c(i).red)		    out = out + "\green"+str(c(i).green)		    out = out + "\blue"+str(c(i).blue)+";"		  next		  out = out +"}"		  return out		End Function	#tag EndMethod	#tag Method, Flags = &h0		Function parse(input as ramstream) As boolean		  dim bracket, colid as integer		  dim car as string		  dim colcom as string		  dim r,g,b as integer		  		  bracket = 1		  redim c(-1)		  		  while not input.eof		    car = input.read(1)		    select case car		    case "{"		      rtfignoregroup(input)		    case "}"		      c.append rgb(r,g,b)		      return true		    case ";"		      c.append rgb(r,g,b)		    case "\"		      colcom=""		      colid=0		      RTFparsecommand(input,colcom,colid)		      select case colcom		      case "red"		        r = colid		      case "green"		        g = colid		      case "blue"		        b = colid		      end		    case chr(13)		    case chr(10)		    end		    		  wend		  		  return true		  		End Function	#tag EndMethod	#tag Method, Flags = &h0		Sub Version()		  // 1.1 no changes		  // 1.0a2 9.11.00 fixed bug: color array starts at 0 now		   // 1.0a1 14.10.00		End Sub	#tag EndMethod	#tag Property, Flags = &h0		c(0) As color	#tag EndProperty	#tag ViewBehavior		#tag ViewProperty			Name="Index"			Visible=true			Group="ID"			InitialValue="-2147483648"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="Left"			Visible=true			Group="Position"			InitialValue="0"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="Name"			Visible=true			Group="ID"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="Super"			Visible=true			Group="ID"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="Top"			Visible=true			Group="Position"			InitialValue="0"			InheritedFrom="Object"		#tag EndViewProperty	#tag EndViewBehaviorEnd Class#tag EndClass