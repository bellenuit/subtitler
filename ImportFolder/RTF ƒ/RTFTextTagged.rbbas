#tag ClassProtected Class RTFTextTaggedImplements RTFTarget	#tag Method, Flags = &h0		Sub Export(target as RtfTarget)		  dim st as RtfState		  		  if not target.preprocess then		    return		  end		  		  target.setstate new rtfstate		  		  target.write text		  		  'target.write left(text,1)		  '		  'for i = 2 to len(text)		  'target.write mid(text,i,1)		  'next		  		  if not target.postprocess then		    return		  end		  		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Function Postprocess() As Boolean		  		  if isitalic then		    textlines.append "</i>"		  end		  		  return true		End Function	#tag EndMethod	#tag Method, Flags = &h0		Function Preprocess() As Boolean		  redim textlines(-1)		  return true		End Function	#tag EndMethod	#tag Method, Flags = &h0		Sub SetState(st as RtfState)		  // catch for italic		  		  if not isitalic and st.italic then		    textlines.append "<i>"		  end		  if  isitalic and not st.italic then		    textlines.append "</i>"		  end		  		  isitalic = st.italic		  		  		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Function Text() As string		  return join(textlines,"")		  		End Function	#tag EndMethod	#tag Method, Flags = &h0		Sub Write(t as string)		  textlines.append t		  		End Sub	#tag EndMethod	#tag Note, Name = version		1.0 27.7.6			#tag EndNote	#tag Property, Flags = &h20		Private isitalic As boolean	#tag EndProperty	#tag Property, Flags = &h0		textlines(-1) As string	#tag EndProperty	#tag ViewBehavior		#tag ViewProperty			Name="Index"			Visible=true			Group="ID"			InitialValue="-2147483648"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="Left"			Visible=true			Group="Position"			InitialValue="0"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="Name"			Visible=true			Group="ID"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="Super"			Visible=true			Group="ID"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="Top"			Visible=true			Group="Position"			InitialValue="0"			InheritedFrom="Object"		#tag EndViewProperty	#tag EndViewBehaviorEnd Class#tag EndClass