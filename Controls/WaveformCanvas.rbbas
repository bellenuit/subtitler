#tag ClassProtected Class WaveformCanvasInherits Canvas	#tag Event		Function MouseDown(X As Integer, Y As Integer) As Boolean		  Mousedownevent		  return true		End Function	#tag EndEvent	#tag Event		Sub MouseUp(X As Integer, Y As Integer)		  		  		  if buffer<>nil then		    positionevent   origin + (x-buffer.width/2)/ pixelspersecond		  end		  		End Sub	#tag EndEvent	#tag Event		Sub Paint(g As Graphics)		  draw		End Sub	#tag EndEvent	#tag Method, Flags = &h1		Protected Sub Draw()		  dim x as integer		  dim i,c as integer		  if buffer<>nil then		    graphics.drawpicture buffer,0,0		    		    		    c = buffer.width		    graphics.foreColor = rgb(0,0,0)		    for i = 0 to c step pixelspersecond		      graphics.drawline i,buffer.height-1,i,buffer.height		    next		    		    graphics.penHeight = 2		    graphics.penwidth = 2		    graphics.foreColor = rgb(255,0,0)		    		    if markin>0 then		      x = buffer.width/2 + (markin-origin) * pixelspersecond		      graphics.drawline x,buffer.height-4,x,buffer.height-1		      graphics.drawline x,buffer.height-1,x+4,buffer.height-1		    end		    if markout>0 then		      x = buffer.width/2 + (markout-origin) * pixelspersecond		      graphics.drawline x,buffer.height-4,x,buffer.height-1		      graphics.drawline x,buffer.height-1,x-4,buffer.height-1		    end		    		    graphics.foreColor = rgb(128,128,255)		    graphics.penwidth = 1		    graphics.penheight = 1		    x = buffer.width/2 + (getlastposition-origin) * pixelspersecond		    graphics.drawline x,0,x,buffer.height		    		    		    		  end		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub SetIn(pos as double)		  if markin<>pos then		    markin = pos		    draw		  end		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub SetOut(pos as double)		  if markout<>pos then		    markout = pos		    draw		  end		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub SetPicture(p as picture, pos as double, pps as double)		  buffer = p		  origin = pos		  position = pos		  pixelspersecond = pps		  draw		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub SetPosition(pos as double)		  dim x as integer		  if pos<>position then		    position = pos		    		    if buffer<>nil then		      x = buffer.width/2 + (pos-origin) * pixelspersecond		      if x<0 or x>=buffer.width then		        getwaveformEvent		        draw		      else		        draw		      end		    else		      getwaveformEvent		    end		  end		End Sub	#tag EndMethod	#tag Hook, Flags = &h0		Event GetLastPosition() As double	#tag EndHook	#tag Hook, Flags = &h0		Event GetWaveformEvent()	#tag EndHook	#tag Hook, Flags = &h0		Event Mousedownevent()	#tag EndHook	#tag Hook, Flags = &h0		Event PositionEvent(d as double)	#tag EndHook	#tag Property, Flags = &h1		Protected buffer As picture	#tag EndProperty	#tag Property, Flags = &h0		markin As double	#tag EndProperty	#tag Property, Flags = &h0		markout As double	#tag EndProperty	#tag Property, Flags = &h1		Protected origin As double	#tag EndProperty	#tag Property, Flags = &h1		Protected pixelspersecond As double	#tag EndProperty	#tag Property, Flags = &h1		Protected position As double	#tag EndProperty	#tag ViewBehavior		#tag ViewProperty			Name="AcceptFocus"			Visible=true			Group="Behavior"			Type="Boolean"			InheritedFrom="Canvas"		#tag EndViewProperty		#tag ViewProperty			Name="AcceptTabs"			Visible=true			Group="Behavior"			Type="Boolean"			InheritedFrom="Canvas"		#tag EndViewProperty		#tag ViewProperty			Name="AutoDeactivate"			Visible=true			Group="Appearance"			InitialValue="True"			Type="Boolean"			InheritedFrom="Canvas"		#tag EndViewProperty		#tag ViewProperty			Name="Backdrop"			Visible=true			Group="Appearance"			Type="Picture"			EditorType="Picture"			InheritedFrom="Canvas"		#tag EndViewProperty		#tag ViewProperty			Name="DoubleBuffer"			Visible=true			Group="Behavior"			InitialValue="False"			Type="Boolean"			InheritedFrom="Canvas"		#tag EndViewProperty		#tag ViewProperty			Name="Enabled"			Visible=true			Group="Appearance"			InitialValue="True"			Type="Boolean"			InheritedFrom="Canvas"		#tag EndViewProperty		#tag ViewProperty			Name="EraseBackground"			Visible=true			Group="Behavior"			InitialValue="True"			Type="Boolean"			InheritedFrom="Canvas"		#tag EndViewProperty		#tag ViewProperty			Name="Height"			Visible=true			Group="Position"			InitialValue="100"			Type="Integer"			InheritedFrom="Canvas"		#tag EndViewProperty		#tag ViewProperty			Name="HelpTag"			Visible=true			Group="Appearance"			Type="String"			EditorType="MultiLineEditor"			InheritedFrom="Canvas"		#tag EndViewProperty		#tag ViewProperty			Name="Index"			Visible=true			Group="ID"			Type="Integer"			InheritedFrom="Canvas"		#tag EndViewProperty		#tag ViewProperty			Name="InitialParent"			InheritedFrom="Canvas"		#tag EndViewProperty		#tag ViewProperty			Name="Left"			Visible=true			Group="Position"			Type="Integer"			InheritedFrom="Canvas"		#tag EndViewProperty		#tag ViewProperty			Name="LockBottom"			Visible=true			Group="Position"			Type="Boolean"			InheritedFrom="Canvas"		#tag EndViewProperty		#tag ViewProperty			Name="LockLeft"			Visible=true			Group="Position"			Type="Boolean"			InheritedFrom="Canvas"		#tag EndViewProperty		#tag ViewProperty			Name="LockRight"			Visible=true			Group="Position"			Type="Boolean"			InheritedFrom="Canvas"		#tag EndViewProperty		#tag ViewProperty			Name="LockTop"			Visible=true			Group="Position"			Type="Boolean"			InheritedFrom="Canvas"		#tag EndViewProperty		#tag ViewProperty			Name="markin"			Group="Behavior"			InitialValue="0"			Type="double"		#tag EndViewProperty		#tag ViewProperty			Name="markout"			Group="Behavior"			InitialValue="0"			Type="double"		#tag EndViewProperty		#tag ViewProperty			Name="Name"			Visible=true			Group="ID"			Type="String"			InheritedFrom="Canvas"		#tag EndViewProperty		#tag ViewProperty			Name="Super"			Visible=true			Group="ID"			InheritedFrom="Canvas"		#tag EndViewProperty		#tag ViewProperty			Name="TabIndex"			Visible=true			Group="Position"			InitialValue="0"			Type="Integer"			InheritedFrom="Canvas"		#tag EndViewProperty		#tag ViewProperty			Name="TabPanelIndex"			Group="Position"			InitialValue="0"			Type="Integer"			InheritedFrom="Canvas"		#tag EndViewProperty		#tag ViewProperty			Name="TabStop"			Visible=true			Group="Position"			InitialValue="True"			Type="Boolean"			InheritedFrom="Canvas"		#tag EndViewProperty		#tag ViewProperty			Name="Top"			Visible=true			Group="Position"			Type="Integer"			InheritedFrom="Canvas"		#tag EndViewProperty		#tag ViewProperty			Name="UseFocusRing"			Visible=true			Group="Appearance"			InitialValue="True"			Type="Boolean"			InheritedFrom="Canvas"		#tag EndViewProperty		#tag ViewProperty			Name="Visible"			Visible=true			Group="Appearance"			InitialValue="True"			Type="Boolean"			InheritedFrom="Canvas"		#tag EndViewProperty		#tag ViewProperty			Name="Width"			Visible=true			Group="Position"			InitialValue="100"			Type="Integer"			InheritedFrom="Canvas"		#tag EndViewProperty	#tag EndViewBehaviorEnd Class#tag EndClass