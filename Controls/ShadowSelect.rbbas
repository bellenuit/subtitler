#tag ClassProtected Class ShadowSelectInherits Canvas	#tag Event		Function MouseDown(X As Integer, Y As Integer) As Boolean		  if keyboard.asyncoptionKey then		    shadowselect 0,0		    return true		  else		    		    if x >= oldx and x <= oldx+20 then		      if y >= oldy and y <= oldy + 20 then		        offsetx = x - oldx		        offsety = y-oldy		        return true		      end if		    end if		  end if		  		End Function	#tag EndEvent	#tag Event		Sub MouseDrag(X As Integer, Y As Integer)		  dim g as graphics		  g = me.graphics		  if oldx<>x-offsetx or oldy<>y-offsety then		    if x>0 and y>0 and x < me.width and y < me.height then		      oldx = x - offsetx		      oldy = y - offsety		      g.forecolor = RGB(127,127,127)		      g.fillrect 0,0,me.width,me.height		      g.forecolor = RGB(0,0,0)		      g.fillrect oldx,oldy,20,20		      g.forecolor = RGB(255,255,255)		      g.fillrect 10,10,20,20		    end if		  end if		End Sub	#tag EndEvent	#tag Event		Sub Paint(g As Graphics)		  if enabled then		    		    g.forecolor = RGB(127,127,127)		    g.fillrect 0,0,me.width,me.height		    g.forecolor = RGB(0,0,0)		    g.fillrect oldx,oldy,20,20		    g.forecolor = RGB(255,255,255)		    g.fillrect 10,10,20,20		    		    		  else		    		    g.forecolor = RGB(127,127,127)		    g.fillrect 0,0,me.width,me.height		    g.forecolor = RGB(64,64,64)		    g.fillrect oldx,oldy,20,20		    g.forecolor = RGB(192,192,192)		    g.fillrect 10,10,20,20		  end		  		  		End Sub	#tag EndEvent	#tag Method, Flags = &h0		Sub Constructor(x as integer, y as integer)		  dim g as graphics		  g = me.graphics		  oldx = 10 + x		  oldy = 10 + y		  g.forecolor = RGB(127,127,127)		  g.fillrect 0,0,me.width,me.height		  g.forecolor = RGB(0,0,0)		  g.fillrect oldx,oldy,20,20		  g.forecolor = RGB(255,255,255)		  g.fillrect 10,10,20,20		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub Shadowselect(x as integer, y as integer)		  constructor x,y		End Sub	#tag EndMethod	#tag Property, Flags = &h0		offsetx As integer	#tag EndProperty	#tag Property, Flags = &h0		offsety As integer	#tag EndProperty	#tag Property, Flags = &h0		oldx As integer	#tag EndProperty	#tag Property, Flags = &h0		oldy As integer	#tag EndProperty	#tag ViewBehavior		#tag ViewProperty			Name="AcceptFocus"			Visible=true			Group="Behavior"			Type="Boolean"			InheritedFrom="Canvas"		#tag EndViewProperty		#tag ViewProperty			Name="AcceptTabs"			Visible=true			Group="Behavior"			Type="Boolean"			InheritedFrom="Canvas"		#tag EndViewProperty		#tag ViewProperty			Name="AutoDeactivate"			Visible=true			Group="Appearance"			InitialValue="True"			Type="Boolean"			InheritedFrom="Canvas"		#tag EndViewProperty		#tag ViewProperty			Name="Backdrop"			Visible=true			Group="Appearance"			Type="Picture"			EditorType="Picture"			InheritedFrom="Canvas"		#tag EndViewProperty		#tag ViewProperty			Name="DoubleBuffer"			Visible=true			Group="Behavior"			InitialValue="False"			Type="Boolean"			InheritedFrom="Canvas"		#tag EndViewProperty		#tag ViewProperty			Name="Enabled"			Visible=true			Group="Appearance"			InitialValue="True"			Type="Boolean"			InheritedFrom="Canvas"		#tag EndViewProperty		#tag ViewProperty			Name="EraseBackground"			Visible=true			Group="Behavior"			InitialValue="True"			Type="Boolean"			InheritedFrom="Canvas"		#tag EndViewProperty		#tag ViewProperty			Name="Height"			Visible=true			Group="Position"			InitialValue="100"			Type="Integer"			InheritedFrom="Canvas"		#tag EndViewProperty		#tag ViewProperty			Name="HelpTag"			Visible=true			Group="Appearance"			Type="String"			EditorType="MultiLineEditor"			InheritedFrom="Canvas"		#tag EndViewProperty		#tag ViewProperty			Name="Index"			Visible=true			Group="ID"			Type="Integer"			InheritedFrom="Canvas"		#tag EndViewProperty		#tag ViewProperty			Name="InitialParent"			InheritedFrom="Canvas"		#tag EndViewProperty		#tag ViewProperty			Name="Left"			Visible=true			Group="Position"			Type="Integer"			InheritedFrom="Canvas"		#tag EndViewProperty		#tag ViewProperty			Name="LockBottom"			Visible=true			Group="Position"			Type="Boolean"			InheritedFrom="Canvas"		#tag EndViewProperty		#tag ViewProperty			Name="LockLeft"			Visible=true			Group="Position"			Type="Boolean"			InheritedFrom="Canvas"		#tag EndViewProperty		#tag ViewProperty			Name="LockRight"			Visible=true			Group="Position"			Type="Boolean"			InheritedFrom="Canvas"		#tag EndViewProperty		#tag ViewProperty			Name="LockTop"			Visible=true			Group="Position"			Type="Boolean"			InheritedFrom="Canvas"		#tag EndViewProperty		#tag ViewProperty			Name="Name"			Visible=true			Group="ID"			Type="String"			InheritedFrom="Canvas"		#tag EndViewProperty		#tag ViewProperty			Name="offsetx"			Group="Behavior"			InitialValue="0"			Type="integer"		#tag EndViewProperty		#tag ViewProperty			Name="offsety"			Group="Behavior"			InitialValue="0"			Type="integer"		#tag EndViewProperty		#tag ViewProperty			Name="oldx"			Group="Behavior"			InitialValue="0"			Type="integer"		#tag EndViewProperty		#tag ViewProperty			Name="oldy"			Group="Behavior"			InitialValue="0"			Type="integer"		#tag EndViewProperty		#tag ViewProperty			Name="Super"			Visible=true			Group="ID"			InheritedFrom="Canvas"		#tag EndViewProperty		#tag ViewProperty			Name="TabIndex"			Visible=true			Group="Position"			InitialValue="0"			Type="Integer"			InheritedFrom="Canvas"		#tag EndViewProperty		#tag ViewProperty			Name="TabPanelIndex"			Group="Position"			InitialValue="0"			Type="Integer"			InheritedFrom="Canvas"		#tag EndViewProperty		#tag ViewProperty			Name="TabStop"			Visible=true			Group="Position"			InitialValue="True"			Type="Boolean"			InheritedFrom="Canvas"		#tag EndViewProperty		#tag ViewProperty			Name="Top"			Visible=true			Group="Position"			Type="Integer"			InheritedFrom="Canvas"		#tag EndViewProperty		#tag ViewProperty			Name="UseFocusRing"			Visible=true			Group="Appearance"			InitialValue="True"			Type="Boolean"			InheritedFrom="Canvas"		#tag EndViewProperty		#tag ViewProperty			Name="Visible"			Visible=true			Group="Appearance"			InitialValue="True"			Type="Boolean"			InheritedFrom="Canvas"		#tag EndViewProperty		#tag ViewProperty			Name="Width"			Visible=true			Group="Position"			InitialValue="100"			Type="Integer"			InheritedFrom="Canvas"		#tag EndViewProperty	#tag EndViewBehaviorEnd Class#tag EndClass