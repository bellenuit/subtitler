#tag ClassProtected Class Caption1LinerExporterInherits TitleExporterBN	#tag Event		Function GetDefaultDictEvent() As dictionary		  dim d as new dictionary		  d.value("textencoding") = "UTF-8"		  d.value("lineending") = "Windows"		  return d		End Function	#tag EndEvent	#tag Event		Function GetLabelEvent() As string		  return "Caption Oneliner"		End Function	#tag EndEvent	#tag Event		Sub ImportEvent(s as string)		  dim i,j ,item as integer		  dim sources(-1), source, lines(-1), line, words(-1), word, inp, outp, textline, textlines(-1), tctext, text, oldtctext, oldtext as string		  dim found as boolean		  dim title as onetitle		  dim tc,tcdist as timecode		  tc = gettimeCodeimport		  tcdist = tc.Clone		  		  tcdist.SetFrames app.splitdistance		  		  redim titles(-1)		  		  lines = split(replaceLineEndings(s,endofLine),endofLine)		  for each line in lines		    tctext = left(line,11)		    text = mid(line,13)		    		    if oldtctext<>"" then		      inp = oldtctext		      outp = tctext		      		      tc.settext outp		      tc.Minus(tcdist)		      		      outp = tc.GetText		      		      if oldtext<>"" then		        title = new oneTitle(style)		        title.setinOut(inp,outp)		        title.setitemfilename item // must be reversed order to get /file on top		        textlines = split(oldtext,"//")		        for each textline in textlines		          title.addLine trim(textline.defineEncoding(gettextEncoding))		        next		        titles.append title		      end		    end		    		    oldtext = text		    oldtctext = tctext		    		  next		  		End Sub	#tag EndEvent	#tag Note, Name = dump		00:01:00:08 你們放心		00:01:01:19 很多公司要請我		00:01:03:25 真的嗎		00:01:04:24 當然是真的		00:01:06:23 我現在還在想		00:01:08:20 看哪一間的福利比較好		00:01:11:16 慢慢來啦		00:01:12:12 讓我考慮幾天		00:01:14:10 反正現在是我在選人家//不是人家在選我		00:01:19:10 好啦 這樣就好		00:01:20:20 來 吃飯		00:01:22:03 大家吃飯		00:01:23:22 爸爸		00:01:24:09 你一定是找不到工作//才會這樣說		00:01:27:13 你如果有工作的話//早就去做了		00:01:29:26 為什麼還要等幾天才決定		00:01:34:07		00:01:35:09 吃飯啦 閉嘴			#tag EndNote	#tag Note, Name = menuhandler		  dim f as folderItem		  dim t as textoutputStream		  dim i as integer		  dim st as string		  dim s as string		  dim sd as saveasDialog		  dim tc as timecode		  		  sd = new saveasDialog		  sd.Filter = "TEXT"		  sd.ActionButtonCaption = "Export STL Text"		  sd.suggestedFileName = title + ".stl"		  if document = nil then		    sd.initialDirectory = documentsFolder		  else		    sd.initialDirectory = document.parent		  end		  //f = sd.showmodalwithin(me)		  f = sd.showmodal		  if f<>nil then		    t = f.createtextfile		    if t<>nil then		      offlineWarning		      app.mouseCursor = system.cursors.wait		      tc = style.gettimeCode		      tc.settext movieoffsetField.text		      t.write titlelist.dumpsTLtext(app.stltapeoffset, tc)		      t.close 		      app.mouseCursor = system.cursors.standardpointer		    else		      msgbox "Error Main:FileExportSTLText: No TextOutPutStream"		    end		    		  end			#tag EndNote	#tag ViewBehavior		#tag ViewProperty			Name="documentname"			Group="Behavior"			Type="string"			EditorType="MultiLineEditor"			InheritedFrom="TitleExporterBN"		#tag EndViewProperty		#tag ViewProperty			Name="dumpstring"			Group="Behavior"			Type="string"			EditorType="MultiLineEditor"			InheritedFrom="TitleExporterBN"		#tag EndViewProperty		#tag ViewProperty			Name="Index"			Visible=true			Group="ID"			InitialValue="-2147483648"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="Left"			Visible=true			Group="Position"			InitialValue="0"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="moviename"			Group="Behavior"			Type="string"			EditorType="MultiLineEditor"			InheritedFrom="TitleExporterBN"		#tag EndViewProperty		#tag ViewProperty			Name="Name"			Visible=true			Group="ID"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="Super"			Visible=true			Group="ID"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="Top"			Visible=true			Group="Position"			InitialValue="0"			InheritedFrom="Object"		#tag EndViewProperty	#tag EndViewBehaviorEnd Class#tag EndClass