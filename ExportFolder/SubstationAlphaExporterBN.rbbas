#tag ClassProtected Class SubstationAlphaExporterBNInherits TitleExporterBN	#tag Event		Function ExportEvent() As string		  dim i,j,cf as integer		  dim title as onetitle		  dim lines(-1), textline(-1), result,  inp, outp, t, tall as string		  dim tc as timecode		  		  tc = gettimeCode		  		  lines.append "[Script Info]"		  lines.append "; This is a Sub Station Alpha v4 script."		  lines.append "; For Sub Station Alpha info and downloads,"		  lines.append "; go to http://www.eswat.demon.co.uk/"		  lines.append "; or email kotus@eswat.demon.co.uk"		  lines.append "; This file was created with Belle Nuit Subtitler"		  lines.append "; http://www.belle-nuit.com/subtitler/"		  lines.append "; Version "+app.shortVersion		  lines.append "Title: "+documentname		  lines.append "Original Script: <unknown>"		  lines.append "ScriptType: v4.00"		  lines.append "Collisions: Normal"		  lines.append "PlayResY: 768"		  lines.append "PlayDepth: 0"		  lines.append "Timer: 100,0000"		  lines.append ""		  lines.append "[V4 Styles]"		  lines.append "Format: Name, Fontname, Fontsize, PrimaryColour, SecondaryColour, TertiaryColour, BackColour, Bold, Italic, BorderStyle, Outline, Shadow, Alignment, MarginL, MarginR, MarginV, AlphaLevel, Encoding"		  lines.append "Style: Default,Arial,20,65535,65535,65535,-2147483640,-1,0,1,3,0,2,30,30,30,0,0"		  lines.append ""		  lines.append "[Events]"		  lines.append "Format: Marked, Start, End, Style, Name, MarginL, MarginR, MarginV, Effect, text"		  		  		  		  for each title in titles		    if title.getinpoint<>"" and title.getoutpoint<>"" then		      inp = left(title.getinpoint,8) + "." + format(val(mid(title.getinpoint,10))*100/tc.Getfps,"00")		      outp = left(title.getoutpoint,8) + "." + format(val(mid(title.getoutpoint,10))*100/tc.Getfps,"00")		      t = title.textclean		      t = replaceall(t,endofLine," ")		      lines.append "Dialogue: Marked=0,"+inp+","+outp+",*Default,NTP,0000,0000,0000,!Effect,"+t		    end		  next		  		  result = join(lines,endofline.windows)		  result = converttext(result)		  return result		  		End Function	#tag EndEvent	#tag Event		Function GetDefaultNameEvent() As string		  return documentname + ".ssa"		End Function	#tag EndEvent	#tag Event		Function GetLabelEvent() As string		  return "Substation Alpha"		End Function	#tag EndEvent	#tag Note, Name = dump		  dim i,j,cf as integer		  dim onet as onetitle		  dim titles(-1), textlines(-1) as string		  dim lines(-1) as string		  dim result as string		  dim title as string		  dim tc as timecode		  dim inp, outp, t, tall as string		  dim stylestr as string		  dim d as date		  		  		  		  lines.append "[Script Info]"		  lines.append "; This is a Sub Station Alpha v4 script."		  lines.append "; For Sub Station Alpha info and downloads,"		  lines.append "; go to http://www.eswat.demon.co.uk/"		  lines.append "; or email kotus@eswat.demon.co.uk"		  lines.append "; This file was created with Belle Nuit Subtitler"		  lines.append "; http://www.belle-nuit.com/subtitler/"		  lines.append "; Version "+app.shortVersion		  lines.append "Title: "+window.title		  lines.append "Original Script: <unknown>"		  lines.append "ScriptType: v4.00"		  lines.append "Collisions: Normal"		  lines.append "PlayResY: 768"		  lines.append "PlayDepth: 0"		  lines.append "Timer: 100,0000"		  lines.append ""		  lines.append "[V4 Styles]"		  lines.append "Format: Name, Fontname, Fontsize, PrimaryColour, SecondaryColour, TertiaryColour, BackColour, Bold, Italic, BorderStyle, Outline, Shadow, Alignment, MarginL, MarginR, MarginV, AlphaLevel, Encoding"		  lines.append "Style: Default,Arial,20,65535,65535,65535,-2147483640,-1,0,1,3,0,2,30,30,30,0,0"		  lines.append ""		  lines.append "[Events]"		  lines.append "Format: Marked, Start, End, Style, Name, MarginL, MarginR, MarginV, Effect, text"		  		  		  		  onet = new onetitle(style)		  		  cf = titlecount		  		  tc = style.getTimeCode		  		  for i = 1 to cf		    onet = gettitle(i)		    if onet.getinpoint<>"" and onet.getoutpoint<>"" then		      inp = left(onet.getinpoint,8) + "." + format(val(mid(onet.getinpoint,10))*100/offset.Getfps,"00")		      outp = left(onet.getoutpoint,8) + "." + format(val(mid(onet.getoutpoint,10))*100/offset.Getfps,"00")		      t = onet.text		      t = replaceall(t,endofLine," ")		      // remove style tags		      t = replaceall(t,"<b>","")		      t = replaceall(t,"</b>","")		      t = replaceall(t,"<i>","")		      t = replaceall(t,"</i>","")		      t = replaceall(t,"<u>","")		      t = replaceall(t,"</u>","")		      if not app.reg.online then		        t = "Offline" + mid(t,8)		      end		      lines.append "Dialogue: Marked=0,"+inp+","+outp+",*Default,NTP,0000,0000,0000,!Effect,"+t		    end		  next		  		  result = join(lines,endofline.windows)		  result = result.convertEncoding(encodings.windowsaNSI)		  return result		  			#tag EndNote	#tag Note, Name = menuhandler		  dim f as folderItem		  dim t as textoutputStream		  dim i as integer		  dim st as string		  dim s as string		  dim sd as saveasDialog		  dim tc as timecode		  		  sd = new saveasDialog		  sd.Filter = "TEXT"		  sd.ActionButtonCaption = "Export .ssa"		  sd.suggestedFileName = title + ".ssa"		  if document = nil then		    sd.initialDirectory = documentsFolder		  else		    sd.initialDirectory = document.parent		  end		  //f = sd.showmodalwithin(me)		  f = sd.showmodal		  if f<>nil then		    t = f.createtextfile		    if t<>nil then		      offlineWarning		      app.mouseCursor = system.cursors.wait		      tc = style.gettimeCode		      tc.settext movieoffsetField.text		      t.write titlelist.dumpsubstationAlpha(tc)		      t.close 		      app.mouseCursor = system.cursors.standardpointer		    else		      msgbox "Error Main:ExportOtherSubstationAlpha: No TextOutPutStream"		    end		    		  end			#tag EndNote	#tag ViewBehavior		#tag ViewProperty			Name="documentname"			Group="Behavior"			Type="string"			EditorType="MultiLineEditor"			InheritedFrom="TitleExporterBN"		#tag EndViewProperty		#tag ViewProperty			Name="dumpstring"			Group="Behavior"			Type="string"			EditorType="MultiLineEditor"			InheritedFrom="TitleExporterBN"		#tag EndViewProperty		#tag ViewProperty			Name="Index"			Visible=true			Group="ID"			InitialValue="-2147483648"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="Left"			Visible=true			Group="Position"			InitialValue="0"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="moviename"			Group="Behavior"			Type="string"			EditorType="MultiLineEditor"			InheritedFrom="TitleExporterBN"		#tag EndViewProperty		#tag ViewProperty			Name="Name"			Visible=true			Group="ID"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="Super"			Visible=true			Group="ID"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="Top"			Visible=true			Group="Position"			InitialValue="0"			InheritedFrom="Object"		#tag EndViewProperty	#tag EndViewBehaviorEnd Class#tag EndClass