#tag ClassProtected Class SMILTextExporterInherits TitleExporterBN	#tag Event		Function ExportEvent() As string		  dim i,j,cf as integer		  dim tapeoffset as boolean		  dim lines(-1), result, inp, outp, dur as string		  dim title as onetitle		  dim tcstart, tcend, durtc, offsettc as timecode		  dim w, h, ht, y as integer		  		  		  tcstart = gettimeCode		  tcend = gettimeCode		  offsettc = getmovieoffset		  		  		  lines.append "<?xml version=""1.0""?>"		  lines.append "<?quicktime type=""application/smil""?>"		  lines.append "<smil xmlns:qt=""http://www.apple.com/quicktime/resources/smilextensions"" qt:autoplay=""false"" qt:time-slider=""true"">"		  lines.append "<head>"		  lines.append "<meta name=""title"" content=""" + replace(documentname,"""","'") +"""/>"               		  lines.append "<layout>"		  		  w = getmovieWidth		  h = getmovieHeight		  ht = 2 * style.textHeight		  if overframe then		    y = h-ht		  else		    y = h		  end		  		  lines.append "<root-layout background-color=""black"" width="""+str(w)+""" height="""+str(y+ht)+"""/>"		  lines.append "<region id=""videoregion"" top=""0"" left=""0"" width="""+str(w)+""" height="""+str(h)+""" fit=""fill""/>"		  lines.append "<region id=""titleregion"" top="""+str(y)+""" left=""0"" width="""+str(w)+""" height="""+str(ht)+"""  fit=""fill""/>"		  lines.append "</layout>"		  lines.append "</head>"		  lines.append "<body>"		  lines.append "<par>"		  lines.append "<!-- VIDEO -->"		  lines.append "<video src="""+getmoviefilename+""" region=""videoregion""/>"                		  lines.append "<!-- QT textfile with default name -->"		  lines.append "<textstream src="""+replace(documentname,"""","'")+".txt"" region = ""titleregion""/>"		  lines.append "</par>"		  lines.append "</body>"		  lines.append "</smil>"		  lines.append "</xml>"		  		  		  result = join(lines,endofline)		  return result		End Function	#tag EndEvent	#tag Event		Function GetCreatorEvent() As string		  return "TVOD" // quicktime player?		End Function	#tag EndEvent	#tag Event		Function GetDefaultNameEvent() As string		  return documentname + ".smil.mov"		End Function	#tag EndEvent	#tag Event		Function GetDefaultPathEvent() As folderitem		  if document<>nil then		    return document.parent		  end		End Function	#tag EndEvent	#tag Event		Function GetLabelEvent() As string		  if overframe then		    return "QuickTime SMIL Text (over)"		  else		    return "QuickTime SMIL Text (under)"		  end		End Function	#tag EndEvent	#tag Event		Function GetTypeEvent() As string		  return "MooV"		End Function	#tag EndEvent	#tag Method, Flags = &h0		Sub Constructor(over as boolean)		  overframe = over		End Sub	#tag EndMethod	#tag Property, Flags = &h0		overframe As boolean	#tag EndProperty	#tag ViewBehavior		#tag ViewProperty			Name="documentname"			Group="Behavior"			Type="string"			EditorType="MultiLineEditor"			InheritedFrom="TitleExporterBN"		#tag EndViewProperty		#tag ViewProperty			Name="dumpstring"			Group="Behavior"			Type="string"			EditorType="MultiLineEditor"			InheritedFrom="TitleExporterBN"		#tag EndViewProperty		#tag ViewProperty			Name="Index"			Visible=true			Group="ID"			InitialValue="-2147483648"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="Left"			Visible=true			Group="Position"			InitialValue="0"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="moviename"			Group="Behavior"			Type="string"			EditorType="MultiLineEditor"			InheritedFrom="TitleExporterBN"		#tag EndViewProperty		#tag ViewProperty			Name="Name"			Visible=true			Group="ID"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="overframe"			Group="Behavior"			InitialValue="0"			Type="boolean"		#tag EndViewProperty		#tag ViewProperty			Name="Super"			Visible=true			Group="ID"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="Top"			Visible=true			Group="Position"			InitialValue="0"			InheritedFrom="Object"		#tag EndViewProperty	#tag EndViewBehaviorEnd Class#tag EndClass