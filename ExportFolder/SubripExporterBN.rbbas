#tag ClassProtected Class SubripExporterBNInherits TitleExporterBN	#tag Event		Function ExportEvent() As string		  dim item as integer		  dim lines(-1), textlines(-1), result, inp, outp, t as string		  dim title as onetitle		  dim tc as timecode		  		  tc = gettimeCode		  for each title in titles		    if title.getinpoint<>"" and title.getoutpoint<>"" then		      item = item + 1		      lines.append str(item)		      inp = left(title.getinpoint,8) + "," + format(val(mid(title.getinpoint,10))*1000/tc.Getfps,"000")		      outp = left(title.getoutpoint,8) + "," + format(val(mid(title.getoutpoint,10))*1000/tc.Getfps,"000")		      lines.append inp + " --> " + outp		      textlines = split(title.gettextwithstyle,endofLine)		      for each t in textlines		        lines.append t		      next		      lines.append ""		    end		  next		  		  result = join(lines,getlineEnding)		  result = converttext(result)		  return result		  		End Function	#tag EndEvent	#tag Event		Function GetDefaultDictEvent() As dictionary		  dim d as new dictionary		  d.value("textencoding") = "DOS Latin1"		  d.value("lineending") = "Windows"		  return d		End Function	#tag EndEvent	#tag Event		Function GetDefaultNameEvent() As string		  return documentname + ".srt"		End Function	#tag EndEvent	#tag Event		Function GetLabelEvent() As string		  return "Subrip"		End Function	#tag EndEvent	#tag Note, Name = dump		  dim i,j,cf as integer		  dim onet as onetitle		  dim titles(-1), textlines(-1) as string		  dim lines(-1) as string		  dim result as string		  dim title as string		  dim tc as timecode		  dim inp, outp, t as string		  dim stylestr as string		  dim d as date		  		  onet = new onetitle(style)		  		  cf = titlecount		  		  tc = style.getTimeCode		  		  for i = 1 to cf		    onet = gettitle(i)		    if onet.getinpoint<>"" and onet.getoutpoint<>"" then		      lines.append str(i)		      inp = left(onet.getinpoint,8) + "," + format(val(mid(onet.getinpoint,10))*1000/offset.Getfps,"000")		      outp = left(onet.getoutpoint,8) + "," + format(val(mid(onet.getoutpoint,10))*1000/offset.Getfps,"000")		      lines.append inp + " --> " + outp		      textlines = split(onet.text,endofline)		      for each t in textlines		        // remove style tags		        t = replaceall(t,"<b>","")		        t = replaceall(t,"</b>","")		        t = replaceall(t,"<i>","")		        t = replaceall(t,"</i>","")		        t = replaceall(t,"<u>","")		        t = replaceall(t,"</u>","")		        if not app.reg.online then		          t = "Offline" + mid(t,8)		        end		        lines.append t		      next		      lines.append ""		    end		  next		  		  result = join(lines,endofline.windows)		  result = result.convertEncoding(encodings.windowsaNSI)		  return result		  			#tag EndNote	#tag Note, Name = menuhandler		  dim f as folderItem		  dim t as textoutputStream		  dim i as integer		  dim st as string		  dim s as string		  dim sd as saveasDialog		  dim tc as timecode		  		  sd = new saveasDialog		  sd.Filter = "TEXT"		  sd.ActionButtonCaption = "Export .srt"		  sd.suggestedFileName = title + ".srt"		  if document = nil then		    sd.initialDirectory = documentsFolder		  else		    sd.initialDirectory = document.parent		  end		  //f = sd.showmodalwithin(me)		  f = sd.showmodal		  if f<>nil then		    t = f.createtextfile		    if t<>nil then		      offlineWarning		      app.mouseCursor = system.cursors.wait		      tc = style.gettimeCode		      tc.settext movieoffsetField.text		      t.write titlelist.dumpsubrip(tc)		      t.close 		      app.mouseCursor = system.cursors.standardpointer		    else		      msgbox "Error Main:ExportOtherSubrip: No TextOutPutStream"		    end		    		  end			#tag EndNote	#tag ViewBehavior		#tag ViewProperty			Name="documentname"			Group="Behavior"			Type="string"			EditorType="MultiLineEditor"			InheritedFrom="TitleExporterBN"		#tag EndViewProperty		#tag ViewProperty			Name="dumpstring"			Group="Behavior"			Type="string"			EditorType="MultiLineEditor"			InheritedFrom="TitleExporterBN"		#tag EndViewProperty		#tag ViewProperty			Name="Index"			Visible=true			Group="ID"			InitialValue="-2147483648"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="Left"			Visible=true			Group="Position"			InitialValue="0"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="moviename"			Group="Behavior"			Type="string"			EditorType="MultiLineEditor"			InheritedFrom="TitleExporterBN"		#tag EndViewProperty		#tag ViewProperty			Name="Name"			Visible=true			Group="ID"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="Super"			Visible=true			Group="ID"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="Top"			Visible=true			Group="Position"			InitialValue="0"			InheritedFrom="Object"		#tag EndViewProperty	#tag EndViewBehaviorEnd Class#tag EndClass