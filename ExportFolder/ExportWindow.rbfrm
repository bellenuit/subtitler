#tag WindowBegin Window ExportWindow   BackColor       =   16777215   Backdrop        =   0   BalloonHelp     =   ""   CloseButton     =   True   Composite       =   False   Frame           =   0   FullScreen      =   False   HasBackColor    =   False   Height          =   521   ImplicitInstance=   True   LiveResize      =   False   MacProcID       =   0   MaxHeight       =   32000   MaximizeButton  =   False   MaxWidth        =   500   MenuBar         =   2   MenuBarVisible  =   True   MinHeight       =   521   MinimizeButton  =   True   MinWidth        =   500   Placement       =   0   Resizeable      =   True   Title           =   "Export"   Visible         =   True   Width           =   500   Begin BinaryField TextField      AcceptTabs      =   True      Alignment       =   0      AutoDeactivate  =   True      AutomaticallyCheckSpelling=   True      BackColor       =   16777215      Bold            =   False      Border          =   True      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Format          =   ""      Height          =   250      HelpTag         =   ""      HideSelection   =   True      Index           =   -2147483648      InitialParent   =   ""      Italic          =   False      Left            =   0      LimitText       =   0      LockBottom      =   True      LockedInPosition=   False      LockLeft        =   True      LockRight       =   True      LockTop         =   True      Mask            =   ""      Multiline       =   True      ReadOnly        =   True      Scope           =   0      ScrollbarHorizontal=   False      ScrollbarVertical=   True      Styled          =   False      TabIndex        =   0      TabPanelIndex   =   0      TabStop         =   True      Text            =   ""      TextColor       =   0      TextFont        =   "Smallsystem"      TextSize        =   10      TextUnit        =   0      Top             =   240      Underline       =   False      UseFocusRing    =   False      Visible         =   True      Width           =   496   End   Begin PopUpMenu2 TextEncodingMenu      AutoDeactivate  =   True      Bold            =   False      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   18      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      InitialValue    =   ""      Italic          =   False      Left            =   183      ListIndex       =   0      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   False      LockTop         =   False      Scope           =   0      TabIndex        =   1      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "Smallsystem"      TextSize        =   0      TextUnit        =   0      Top             =   59      Underline       =   False      Visible         =   True      Width           =   300   End   Begin ProgressBar Progress      AutoDeactivate  =   True      Enabled         =   True      Height          =   12      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Left            =   8      LockBottom      =   True      LockedInPosition=   False      LockLeft        =   True      LockRight       =   False      LockTop         =   False      Maximum         =   100      Scope           =   0      TabIndex        =   2      TabPanelIndex   =   0      TabStop         =   True      Top             =   498      Value           =   0      Visible         =   False      Width           =   98   End   Begin PopUpMenu2 ListFormatMenu      AutoDeactivate  =   True      Bold            =   False      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      InitialValue    =   ""      Italic          =   False      Left            =   183      ListIndex       =   0      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   False      LockTop         =   False      Scope           =   0      TabIndex        =   3      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "Smallsystem"      TextSize        =   0      TextUnit        =   0      Top             =   34      Underline       =   False      Visible         =   True      Width           =   300   End   Begin Label TextEncodingLabel      Active          =   ""      AutoDeactivate  =   True      Bold            =   False      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   18      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   False      Left            =   5      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   False      LockTop         =   False      Multiline       =   False      Scope           =   0      Selectable      =   False      TabIndex        =   4      TabPanelIndex   =   0      TabStop         =   True      Text            =   "Text Encoding"      TextAlign       =   2      TextColor       =   0      TextFont        =   "Smallsystem"      TextSize        =   0      Top             =   60      Transparent     =   False      Underline       =   False      Visible         =   True      Width           =   167      Window          =   0      _mWindow        =   0   End   Begin Label ListformatLabel      Active          =   ""      AutoDeactivate  =   True      Bold            =   False      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   False      Left            =   5      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   False      LockTop         =   False      Multiline       =   False      Scope           =   0      Selectable      =   False      TabIndex        =   5      TabPanelIndex   =   0      TabStop         =   True      Text            =   "List Format"      TextAlign       =   2      TextColor       =   0      TextFont        =   "Smallsystem"      TextSize        =   0      Top             =   34      Transparent     =   False      Underline       =   False      Visible         =   True      Width           =   167      Window          =   0      _mWindow        =   0   End   Begin PushButton PreviewButton      AutoDeactivate  =   True      Bold            =   False      ButtonStyle     =   0      Cancel          =   False      Caption         =   "Preview"      Default         =   True      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   False      Left            =   183      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   False      LockTop         =   False      Scope           =   0      TabIndex        =   6      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   201      Underline       =   False      Visible         =   True      Width           =   150   End   Begin PushButton ExportButton      AutoDeactivate  =   True      Bold            =   False      ButtonStyle     =   0      Cancel          =   False      Caption         =   "Export"      Default         =   False      Enabled         =   False      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   False      Left            =   340      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   False      LockTop         =   False      Scope           =   0      TabIndex        =   7      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   201      Underline       =   False      Visible         =   True      Width           =   150   End   Begin DocumentSelector DocumentSelector1      AutoDeactivate  =   True      Bold            =   False      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   16      HelpTag         =   ""      includetemplates=   0      Index           =   -2147483648      InitialParent   =   ""      InitialValue    =   ""      Italic          =   False      Left            =   183      ListIndex       =   0      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   False      LockTop         =   False      Scope           =   0      TabIndex        =   8      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "Smallsystem"      TextSize        =   0      TextUnit        =   0      Top             =   9      Underline       =   False      Visible         =   True      Width           =   300   End   Begin Label SubtitlerDocumentLabel      Active          =   ""      AutoDeactivate  =   True      Bold            =   False      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   18      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   False      Left            =   5      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   False      LockTop         =   False      Multiline       =   False      Scope           =   0      Selectable      =   False      TabIndex        =   9      TabPanelIndex   =   0      TabStop         =   True      Text            =   "Subtitler Document"      TextAlign       =   2      TextColor       =   0      TextFont        =   "Smallsystem"      TextSize        =   0      Top             =   9      Transparent     =   False      Underline       =   False      Visible         =   True      Width           =   167      Window          =   0      _mWindow        =   0   End   Begin Label HelpLabel      Active          =   ""      AutoDeactivate  =   True      Bold            =   False      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   13      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   False      Left            =   120      LockBottom      =   True      LockedInPosition=   False      LockLeft        =   True      LockRight       =   False      LockTop         =   False      Multiline       =   False      Scope           =   0      Selectable      =   False      TabIndex        =   10      TabPanelIndex   =   0      TabStop         =   True      Text            =   ""      TextAlign       =   0      TextColor       =   0      TextFont        =   "Smallsystem"      TextSize        =   0      Top             =   500      Transparent     =   False      Underline       =   False      Visible         =   True      Width           =   358      Window          =   0      _mWindow        =   0   End   Begin CheckBox ApplyOffsetOption      AutoDeactivate  =   True      Bold            =   False      Caption         =   "Apply Offset"      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   False      Left            =   183      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   False      LockTop         =   False      Scope           =   0      State           =   0      TabIndex        =   11      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "Smallsystem"      TextSize        =   0      TextUnit        =   0      Top             =   112      Underline       =   False      Value           =   False      Visible         =   True      Width           =   150   End   Begin TextField ApplyOffsetField      AcceptTabs      =   False      Alignment       =   3      AutoDeactivate  =   True      AutomaticallyCheckSpelling=   False      BackColor       =   16777215      Bold            =   False      Border          =   True      CueText         =   ""      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Format          =   ""      Height          =   22      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   False      Left            =   388      LimitText       =   0      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   False      LockTop         =   False      Mask            =   ""      Password        =   False      ReadOnly        =   False      Scope           =   0      TabIndex        =   12      TabPanelIndex   =   0      TabStop         =   True      Text            =   "00:00:00:00"      TextColor       =   0      TextFont        =   "Smallsystem"      TextSize        =   0      TextUnit        =   0      Top             =   112      Underline       =   False      UseFocusRing    =   True      Visible         =   True      Width           =   91   End   Begin CheckBox TapeOffsetOption      AutoDeactivate  =   True      Bold            =   False      Caption         =   "$TapeOffset"      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   False      Left            =   183      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   False      LockTop         =   False      Scope           =   0      State           =   0      TabIndex        =   13      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "Smallsystem"      TextSize        =   0      TextUnit        =   0      Top             =   139      Underline       =   False      Value           =   False      Visible         =   True      Width           =   177   End   Begin PopUpMenu2 LineEndingMenu      AutoDeactivate  =   True      Bold            =   False      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   18      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      InitialValue    =   ""      Italic          =   False      Left            =   183      ListIndex       =   0      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   False      LockTop         =   False      Scope           =   0      TabIndex        =   14      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "Smallsystem"      TextSize        =   0      TextUnit        =   0      Top             =   84      Underline       =   False      Visible         =   True      Width           =   300   End   Begin Label LineEndingLabel      Active          =   ""      AutoDeactivate  =   True      Bold            =   False      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   18      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   False      Left            =   5      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   False      LockTop         =   False      Multiline       =   False      Scope           =   0      Selectable      =   False      TabIndex        =   15      TabPanelIndex   =   0      TabStop         =   True      Text            =   "Line Ending"      TextAlign       =   2      TextColor       =   0      TextFont        =   "Smallsystem"      TextSize        =   0      Top             =   84      Transparent     =   False      Underline       =   False      Visible         =   True      Width           =   167      Window          =   0      _mWindow        =   0   End   Begin Label FolderPathLabel      Active          =   ""      AutoDeactivate  =   True      Bold            =   False      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   False      Left            =   5      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   False      LockTop         =   False      Multiline       =   False      Scope           =   0      Selectable      =   False      TabIndex        =   16      TabPanelIndex   =   0      TabStop         =   True      Text            =   "Folder Path"      TextAlign       =   2      TextColor       =   0      TextFont        =   "Smallsystem"      TextSize        =   0      Top             =   167      Transparent     =   False      Underline       =   False      Visible         =   True      Width           =   167      Window          =   0      _mWindow        =   0   End   Begin TextField FolderPathField      AcceptTabs      =   False      Alignment       =   1      AutoDeactivate  =   True      AutomaticallyCheckSpelling=   False      BackColor       =   16777215      Bold            =   False      Border          =   True      CueText         =   ""      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Format          =   ""      Height          =   22      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   False      Left            =   183      LimitText       =   0      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   False      LockTop         =   False      Mask            =   ""      Password        =   False      ReadOnly        =   False      Scope           =   0      TabIndex        =   17      TabPanelIndex   =   0      TabStop         =   True      Text            =   ""      TextColor       =   0      TextFont        =   "Smallsystem"      TextSize        =   0      TextUnit        =   0      Top             =   167      Underline       =   False      UseFocusRing    =   True      Visible         =   True      Width           =   300   End   Begin CheckBox FontOption      AutoDeactivate  =   True      Bold            =   False      Caption         =   "Font Tag"      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   False      Left            =   183      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   False      LockTop         =   False      Scope           =   0      State           =   0      TabIndex        =   18      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "Smallsystem"      TextSize        =   0      TextUnit        =   0      Top             =   117      Underline       =   False      Value           =   False      Visible         =   True      Width           =   150   End   Begin Label LanguageLabel      Active          =   ""      AutoDeactivate  =   True      Bold            =   False      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   False      Left            =   5      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   False      LockTop         =   False      Multiline       =   False      Scope           =   0      Selectable      =   False      TabIndex        =   19      TabPanelIndex   =   0      TabStop         =   True      Text            =   "Language"      TextAlign       =   2      TextColor       =   0      TextFont        =   "Smallsystem"      TextSize        =   0      Top             =   60      Transparent     =   False      Underline       =   False      Visible         =   True      Width           =   167      Window          =   0      _mWindow        =   0   End   Begin TextField LanguageField      AcceptTabs      =   False      Alignment       =   1      AutoDeactivate  =   True      AutomaticallyCheckSpelling=   False      BackColor       =   16777215      Bold            =   False      Border          =   True      CueText         =   ""      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Format          =   ""      Height          =   22      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   False      Left            =   183      LimitText       =   0      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   False      LockTop         =   False      Mask            =   ""      Password        =   False      ReadOnly        =   False      Scope           =   0      TabIndex        =   20      TabPanelIndex   =   0      TabStop         =   True      Text            =   ""      TextColor       =   0      TextFont        =   "Smallsystem"      TextSize        =   0      TextUnit        =   0      Top             =   60      Underline       =   False      UseFocusRing    =   True      Visible         =   True      Width           =   300   End   Begin TextField ReelNumberField      AcceptTabs      =   False      Alignment       =   1      AutoDeactivate  =   True      AutomaticallyCheckSpelling=   False      BackColor       =   16777215      Bold            =   False      Border          =   True      CueText         =   ""      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Format          =   ""      Height          =   22      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   False      Left            =   183      LimitText       =   0      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   False      LockTop         =   False      Mask            =   ""      Password        =   False      ReadOnly        =   False      Scope           =   0      TabIndex        =   21      TabPanelIndex   =   0      TabStop         =   True      Text            =   ""      TextColor       =   0      TextFont        =   "Smallsystem"      TextSize        =   0      TextUnit        =   0      Top             =   86      Underline       =   False      UseFocusRing    =   True      Visible         =   True      Width           =   300   End   Begin Label ReelNumberLabel      Active          =   ""      AutoDeactivate  =   True      Bold            =   False      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   False      Left            =   5      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   False      LockTop         =   False      Multiline       =   False      Scope           =   0      Selectable      =   False      TabIndex        =   22      TabPanelIndex   =   0      TabStop         =   True      Text            =   "Reel Number"      TextAlign       =   2      TextColor       =   0      TextFont        =   "Smallsystem"      TextSize        =   0      Top             =   86      Transparent     =   False      Underline       =   False      Visible         =   True      Width           =   167      Window          =   0      _mWindow        =   0   End   Begin TextField FontFileField      AcceptTabs      =   False      Alignment       =   1      AutoDeactivate  =   True      AutomaticallyCheckSpelling=   False      BackColor       =   16777215      Bold            =   False      Border          =   True      CueText         =   ""      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Format          =   ""      Height          =   22      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   False      Left            =   183      LimitText       =   0      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   False      LockTop         =   False      Mask            =   ""      Password        =   False      ReadOnly        =   False      Scope           =   0      TabIndex        =   24      TabPanelIndex   =   0      TabStop         =   True      Text            =   ""      TextColor       =   0      TextFont        =   "Smallsystem"      TextSize        =   0      TextUnit        =   0      Top             =   144      Underline       =   False      UseFocusRing    =   True      Visible         =   True      Width           =   300   End   Begin Label FontFileLabel      Active          =   ""      AutoDeactivate  =   True      Bold            =   False      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   False      Left            =   5      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   False      LockTop         =   False      Multiline       =   False      Scope           =   0      Selectable      =   False      TabIndex        =   25      TabPanelIndex   =   0      TabStop         =   True      Text            =   "Font File"      TextAlign       =   2      TextColor       =   0      TextFont        =   "Smallsystem"      TextSize        =   0      Top             =   144      Transparent     =   False      Underline       =   False      Visible         =   True      Width           =   167      Window          =   0      _mWindow        =   0   EndEnd#tag EndWindow#tag WindowCode	#tag Event		Sub Activate()		  documentselector1.refreshlist		End Sub	#tag EndEvent	#tag Event		Sub Close()		  dict.value("top") = top		  dict.value("left") = left		  app.exporterdict = dict		End Sub	#tag EndEvent	#tag Event		Sub Open()		  dim s as string		  dim b as boolean		  dim i as integer		  		  registerexporters		  		  if app.exporterdict <> nil then		    dict = app.exporterdict 		  else		    dict = new dictionary		  end		  		  if dict.getinteger("top",i) then top =i		  if dict.getinteger("left",i) then left =i		  self.setbounds(left,top,width,height)		  		  if dict.getstring("listformat",s) then listFormatMenu.settext s		  		  enablecontrols		  		  setlanguage		End Sub	#tag EndEvent	#tag MenuHandler		Function FileCLose() As Boolean Handles FileCLose.Action			self.close			return true		End Function	#tag EndMenuHandler	#tag Method, Flags = &h0		Sub EnableControls()		  dim d as dictionary		  dim s as string		  dim b as boolean		  dim te as titleexporterBN		  if exporterdict.hasKey(listFormatMenu.text) then		    te = exporterdict.value(listFormatMenu.text)		    previewbutton.visible = true		  else		    previewbutton.visible = false		  end		  if te<>nil then		    d = te.getdefaultdict		    if d<>nil then 		      dict = d		      dict.value("listformat") = te.getlabel		    else		      dict = new dictionary		    end		  else		    dict = new dictionary		  end		  if dict = nil then dict = new dictionary		  		  if te<>nil then textencodingMenu.init te.gettextEncodinglist		  		  if dict.getstring("textencoding",s) then		    textencodingMenu.settext s		    textencodingMenu.visible = true		    textencodingLabel.visible = true		  else		    textencodingMenu.visible = false		    textencodingLabel.visible = false		  end		  if dict.getstring("lineending",s) then		    lineEndingMenu.settext s		    lineendingMenu.visible = true		    lineendinglabel.visible = true		  else		    lineendingMenu.visible = false		    lineendinglabel.visible = false		  end		  'if dict.getstring("framerate",s) then		  'framerateMenu.settext s		  'framerateMenu.visible = true		  'frameratelabel.visible = true		  'else		  'framerateMenu.visible = false		  'frameratelabel.visible = false		  'end		  if dict.getboolean("applyoffset",b) then		    applyoffsetOption.value = b		    applyoffsetoption.visible = true		    applyoffsetField.visible = true		    if dict.getstring("applyoffsetvalue",s) then		      applyoffsetField.text= s		    end		    setoffset		  else		    applyoffsetoption.visible = false		    applyoffsetField.visible = false		  end		  if dict.getboolean("usetapeoffset",b) then		    tapeOffsetOption.value = b		    tapeOffsetOption.visible = true		  else		    tapeOffsetOption.visible = false		  end		  if dict.getboolean("fonttag",b) then		    FontOption.value = b		    FontOption.visible = true		  else		    FontOption.visible = false		  end		  if dict.getstring("fontfile",s) then		    fontfilefield.text= s		    fontfilefield.visible = true		    fontfilelabel.visible = true		  else		    fontfilefield.visible = false		    fontfilelabel.visible = false		  end		  if dict.getstring("folderpath",s) then		    folderpathField.text= s		    folderpathField.visible = true		    folderpathLabel.visible = true		  else		    folderpathField.visible = false		    folderpathLabel.visible = false		  end		  if dict.getstring("language",s) then		    languageField.text= s		    languageField.visible = true		    languageLabel.visible = true		  else		    languageField.visible = false		    languageLabel.visible = false		  end		  if dict.getstring("reelnumber",s) then		    reelNumberField.text= s		    reelNumberField.visible = true		    reelNumberLabel.visible = true		  else		    reelNumberField.visible = false		    reelNumberLabel.visible = false		  end		  		  		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub Export(f as folderItem=nil)		  dim sd as saveAsDialog		  		  dim b as binaryStream		  		  if exporter <> nil and exporter.dumpstring<>"" then		    if f=nil then		      sd = new saveasDialog		      sd.filter = "any"		      		      sd.InitialDirectory = exporter.GetDefaultPath		      sd.SuggestedFileName = exporter.getDefaultName		      sd.PromptText = exporter.getLabel		      sd.ExtensionHidden = false // unused		      sd.ActionButtonCaption = "Export"		      f = sd.showModalwithin(self)		    end		    if f<>nil then		      b = f.createbinaryFile("any")		      if b<>nil then		        b.write exporter.dumpstring		        b.close		        f.macCreator = exporter.getCreator		        f.macType = exporter.getType		        		        if exporter isa smilExporter then		          smilExporter(exporter).flatten f		        end		        		        		        		      else		        msgbox"ExportWindow.Export error: Could not create BinaryStream"		      end		      		      		    else		      beep		    end		    		    		  end		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub Preview(limittitles as boolean = false)		  dim te as titleExporterBN		  dim m as main		  dim s as string		  dim title as oneTitle		  		  setprogress 0, true		  		  if exporterdict.hasKey(listFormatMenu.text) then		    te = exporterdict.value(listFormatMenu.text)		  end		  		  if te = nil then return		  		  te.myprogress = progress		  		  if not app.reg.online then		    msgBox "You need an online license to use this tool." + endofLine + endofLine +_		    "Only the first 10 titles will be exported."		  end		  		  m = documentselector1.getDocument		  if m<>nil then		    te.style = new subtitle		    te.style.clone(m.style)		    te.document = m.document		    te.documentname = m.title		    if right(te.documentname,4) = ".stp" then		      te.documentname = left(te.documentname,len(te.documentname)-4)		    end		    te.titles = m.titlelist.getAllTitles		    te.mainwindow = m // nur für subtitler 1.1 export		    for each title in te.titles		      title.parseTimeCode		    next		    		    if not app.reg.online then		      'msgBox "You need an online license to use this tool." + endofLine + endofLine +_		      '"Only the first 10 titles will be exported."		      if ubound(te.titles) > 10 then redim te.titles(9)		    end		    		    if limittitles then		      if ubound(te.titles) > 10 then redim te.titles(9)		    end		    		    te.dict = dict		    		    s = te.export		    		    app.mouseCursor = system.Cursors.Wait		    if te.isBinary then		      s = s.defineEncoding(getfontTextEncoding("Monaco"))		      textfield.textfont = "Monaco"		      textfield.textSize = 10		      textField.setbinary s		    else		      textfield.textfont = "Smallsystem"		      textfield.textSize = 0		      textField.settext s		    end		    app.mouseCursor = system.Cursors.StandardPointer		    		    exporter = te		    		    if exporter.dumpstring<>"" then		      exportbutton.enabled = true		    else		      textField.text = "File empty"		      exportbutton.enabled = false		    end		  end		  		  setprogress 100, false		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub Register(te as TitleExporterBN)		  dim key as string		  key = te.getLabel		  exporterdict.value(key) = te		  listFormatMenu.addrow key		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub RegisterExporters()		  exporterdict = new dictionary		  		  register new adobeEncoreImageExporterBN		  register new adobeEncoreTextExporterBN		  register new avidDSExporterBN		  register new BNDExporter		  register new cinetypTimecodeExporterBN		  register new CinecanvasExporterBN  // now dlp cinema		  register new DCDMSubtitleExporter		  register new EBUExporterBN		  register new EBUARTEExporterBN		  register new EDLExporterBN		  register new EDLExporterBN(true)		  register new FABExporterBN		  register new FCPXMLExporterBN		  register new SMILExporter		  register new SMILTextExporter(false)		  register new SMILTextExporter(true)		  register new QuickTimeTextExporterBN		  register new SAMIExporter		  register new SwedishListExporterBN		  register new SoftniSUBConverter		  register new SonicProducerExporterBN		  register new SonicScenaristExporterBN		  register new SpruceMaestroExporterBN		  register new STLGraphicExporterBN		  register new STLTextExporterBN		  register new SubripExporterBN		  register new Subtitler110ExporterBN		  register new SubstationAlphaExporterBN		  register new TextExporterBN		  register new TextSimpleExporterBN		  register new TimedTextExporterBN		  		  		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub SetLanguage()		  dim value as string		  dim languagedict as dictionary		  languagedict = app.languagedict		  		  if languagedict =nil then return		  		  		  if languagedict.getstring("exporttitle", value) then title = value		  		  if languagedict.getstring("exportsubtitlerdocument", value) then subtitlerdocumentLabel.text = value		  if languagedict.getstring("exportlistformat", value) then listformatlabel.text = value		  if languagedict.getstring("exporttextencoding", value) then textencodinglabel.text = value		  if languagedict.getstring("exportlineending", value) then LineEndingLabel.text = value		  if languagedict.getstring("exportapplyoffset", value) then applyoffsetoption.caption = value		  'if languagedict.getstring("exportusetapeoffset", value) then tapeOffsetOption.caption = value		  if languagedict.getstring("exportfolderpath", value) then folderPathlabel.text =  value		  		  if languagedict.getstring("exportpreview", value) then previewbutton.caption = value		  if languagedict.getstring("exportexport", value) then exportbutton.caption = value		  		  		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub SetOffset()		  dim tc as timecode		  dim m as main		  if dict = nil then dict = new dictionary		  if applyoffsetfield.visible then		    m = documentselector1.getDocument		    if m<>nil then		      tc = m.style.getTimeCode		      tc.settext m.movieoffsetField.text		      if tc.getFrames<>0 then		        applyOffsetField.text = "-"+tc.gettext		      else		        applyOffsetField.text = tc.gettext		      end		    end		  end		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub SetProgress(n as integer, setvisible as boolean)		  progress.visible = setvisible		  progress.value = n		  if setvisible then		    app.mouseCursor=System.Cursors.Wait		  else		    app.mousecursor = System.Cursors.StandardPointer		  end		  updatenow		End Sub	#tag EndMethod	#tag Property, Flags = &h0		dict As dictionary	#tag EndProperty	#tag Property, Flags = &h0		exporter As titleexporterBN	#tag EndProperty	#tag Property, Flags = &h0		exporterdict As dictionary	#tag EndProperty#tag EndWindowCode#tag Events TextField	#tag Event		Sub Progress(n as integer)		  setprogress 50 + n/2, true		End Sub	#tag EndEvent#tag EndEvents#tag Events TextEncodingMenu	#tag Event		Sub Open()		  dim te as new titleexporterBN		  me.init te.gettextEncodinglist		End Sub	#tag EndEvent	#tag Event		Sub Change()		  dict.value("textencoding") = me.text		  exportbutton.enabled = false		End Sub	#tag EndEvent#tag EndEvents#tag Events ListFormatMenu	#tag Event		Sub Change()		  dict.value("listformat") = me.text		  enablecontrols		  exportbutton.enabled = false		End Sub	#tag EndEvent#tag EndEvents#tag Events PreviewButton	#tag Event		Sub Action()		  preview		End Sub	#tag EndEvent#tag EndEvents#tag Events ExportButton	#tag Event		Sub Action()		  export		End Sub	#tag EndEvent#tag EndEvents#tag Events DocumentSelector1	#tag Event		Sub Change()		  setoffset		  exportbutton.enabled = false		End Sub	#tag EndEvent#tag EndEvents#tag Events ApplyOffsetOption	#tag Event		Sub Action()		  dict.value("applyoffset") = me.value		  exportbutton.enabled = false		End Sub	#tag EndEvent#tag EndEvents#tag Events ApplyOffsetField	#tag Event		Sub TextChange()		  dict.value("applyoffsetvalue") = me.text		  exportbutton.enabled = false		End Sub	#tag EndEvent#tag EndEvents#tag Events TapeOffsetOption	#tag Event		Sub Action()		  dict.value("usetapeoffset") = me.value		  exportbutton.enabled = false		End Sub	#tag EndEvent#tag EndEvents#tag Events LineEndingMenu	#tag Event		Sub Change()		  dict.value("lineending") = me.text		  exportbutton.enabled = false		End Sub	#tag EndEvent	#tag Event		Sub Open()		  dim te as new titleexporterBN		  me.init te.getlineEncodingList		  		End Sub	#tag EndEvent#tag EndEvents#tag Events FolderPathField	#tag Event		Sub TextChange()		  dict.value("folderpath") = me.text		  exportbutton.enabled = false		End Sub	#tag EndEvent#tag EndEvents#tag Events FontOption	#tag Event		Sub Action()		  dict.value("fonttag") = me.value		  exportbutton.enabled = false		End Sub	#tag EndEvent#tag EndEvents#tag Events LanguageField	#tag Event		Sub TextChange()		  dict.value("language") = me.text		  exportbutton.enabled = false		End Sub	#tag EndEvent#tag EndEvents#tag Events ReelNumberField	#tag Event		Sub TextChange()		  dict.value("reelnumber") = me.text		  exportbutton.enabled = false		End Sub	#tag EndEvent#tag EndEvents#tag Events FontFileField	#tag Event		Sub TextChange()		  dict.value("fontfile") = me.text		  exportbutton.enabled = false		End Sub	#tag EndEvent#tag EndEvents