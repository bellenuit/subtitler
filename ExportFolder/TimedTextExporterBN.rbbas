#tag ClassProtected Class TimedTextExporterBNInherits TitleExporterBN	#tag Event		Function ExportEvent() As string		  dim i,j,cf as integer		  dim tapeoffset as boolean		  dim lines(-1), result, inp, outp, dur, lang as string		  dim title as onetitle		  dim tcstart, tcend, durtc, offsettc as timecode		  dim w, h, ht as integer		  		  		  tcstart = gettimeCode		  tcend = gettimeCode		  offsettc = getmovieoffset		  		  w = style.widthreal		  h = style.height		  lang = "en"		  //lines.append "<?xml version=""1.0"" encoding=""UTF-8""?>"		  lines.append "<tt tts:extent="""+str(w)+"px "+str(h)+"480px""  ttp:frameRate="""+str(style.framerate) + """ xml:lang="""+lang+""" "		  lines.append "   xmlns=""http://www.w3.org/2006/10/ttaf1"" "		  lines.append "   xmlns:ttp=""http://www.w3.org/2006/10/ttaf1#parameter"" "		  lines.append "   xmlns:tts=""http://www.w3.org/2006/10/ttaf1#styling""> "		  lines.append "<head>"		  lines.append " <styling>"		  lines.append "   <style tts:color="""+Color2WebHex(style.textc)+"""/>"		  lines.append "   <style tts:textAlign="""+style.AlignString+"""/>"		  lines.append "   <style tts:fontSize="""+Str(style.size)+"""/>"		  lines.append " </styling>" 		  lines.append "</head>"		  lines.append "<body>"		  lines.append " <div xml:lang="""+lang+""">"		  		  for each title in titles		    lines.append cliptext(title)		  next		  		  lines.append " </div>"		  lines.append "</body>"		  lines.append "</tt>"		  		  		  result = join(lines,endofline)		  return result		  		  		  		  		End Function	#tag EndEvent	#tag Event		Function GetDefaultNameEvent() As string		  return documentname + ".tt"		End Function	#tag EndEvent	#tag Event		Function GetLabelEvent() As string		  return "Timed Text"		End Function	#tag EndEvent	#tag Method, Flags = &h1		Protected Function Cliptext(title as onetitle) As string		  dim i,j,cf as integer		  dim tapeoffset as boolean		  dim lines(-1), result, inp, outp, dur as string		  dim tcstart, tcend, durtc, offsettc as timecode		  dim w, h as integer		  		  tcstart = gettimeCode		  tcend = gettimeCode		  offsettc = getmovieoffset		  		  if title.getinpoint<>"" and title.getoutpoint<>"" then		    inp = title.getinpoint		    outp = title.getoutpoint		    tcstart.settext inp		    tcstart.minus offsettc		    inp = tcstart.gettextQT		    tcend.settext outp		    tcend.minus offsettc		    outp = tcend.gettextQT		    durtc = tcend.Clone		    durtc.Minus tcstart		    		    return "   <p begin="""+tcstart.GetText+""" dur="""+durtc.gettext+""">" + EndOfLine  + _		    "    "+ ReplaceLineEndings(title.TextClean,EndOfLine+"    ") + endofline + _		    "   </p>"		    		  end		End Function	#tag EndMethod	#tag Note, Name = timed text samples		<tt tts:extent="640px 480px" xml:lang="en"		xmlns="http://www.w3.org/2006/10/ttaf1"		xmlns:tts="http://www.w3.org/2006/10/ttaf1#styling">		<head>		<layout>		<region xml:id="r1">		<style tts:origin="10px 100px"/>		<style tts:extent="620px 96px"/>		<style tts:fontSize="40px"/>		<style tts:fontWeight="bold"/>		<style tts:backgroundColor="black"/>		<style tts:color="red"/>		<style tts:textAlign="center"/>		<style tts:displayAlign="center"/>		</region>		<region xml:id="r2">		<style tts:origin="10px 300px"/>		<style tts:extent="620px 96px"/>		<style tts:fontSize="40px"/>		<style tts:fontWeight="bold"/>		<style tts:backgroundColor="black"/>		<style tts:color="yellow"/>		<style tts:textAlign="center"/>		<style tts:displayAlign="center"/>		</region>		</layout>		</head>		<body xml:id="b1">		<div xml:id="d1" begin="0s" dur="2s">		<p xml:id="p1" region="r1">Text 1</p>		<p xml:id="p2" region="r2">Text 2</p>		</div>		<div xml:id="d2" begin="1s" dur="2s">		<p xml:id="p3" region="r2">Text 3</p>		<p xml:id="p4" region="r1">Text 4</p>		</div>		</body>		</tt>			#tag EndNote	#tag ViewBehavior		#tag ViewProperty			Name="documentname"			Group="Behavior"			Type="string"			EditorType="MultiLineEditor"			InheritedFrom="TitleExporterBN"		#tag EndViewProperty		#tag ViewProperty			Name="dumpstring"			Group="Behavior"			Type="string"			EditorType="MultiLineEditor"			InheritedFrom="TitleExporterBN"		#tag EndViewProperty		#tag ViewProperty			Name="Index"			Visible=true			Group="ID"			InitialValue="-2147483648"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="Left"			Visible=true			Group="Position"			InitialValue="0"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="moviename"			Group="Behavior"			Type="string"			EditorType="MultiLineEditor"			InheritedFrom="TitleExporterBN"		#tag EndViewProperty		#tag ViewProperty			Name="Name"			Visible=true			Group="ID"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="Super"			Visible=true			Group="ID"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="Top"			Visible=true			Group="Position"			InitialValue="0"			InheritedFrom="Object"		#tag EndViewProperty	#tag EndViewBehaviorEnd Class#tag EndClass