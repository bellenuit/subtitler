#tag ClassProtected Class SMILExporterInherits TitleExporterBN	#tag Event		Function ExportEvent() As string		  dim i,j,cf as integer		  dim tapeoffset as boolean		  dim lines(-1), result, inp, outp, dur as string		  dim title as onetitle		  dim tcstart, tcend, durtc, offsettc as timecode		  dim w, h, ht as integer		  		  		  tcstart = gettimeCode		  tcend = gettimeCode		  offsettc = getmovieoffset		  		  		  lines.append "<?xml version=""1.0""?>"		  lines.append "<?quicktime type=""application/smil""?>"		  lines.append "<smil xmlns:qt=""http://www.apple.com/quicktime/resources/smilextensions"" qt:autoplay=""false"" qt:time-slider=""true"">"		  lines.append "<head>"		  lines.append "<meta name=""title"" content=""" + replace(documentname,"""","'") +"""/>"               		  lines.append "<layout>"		  		  		  w = style.widthreal		  h = style.height		  		  lines.append "<root-layout background-color=""green"" width="""+str(w)+""" height="""+str(h)+"""/>"		  lines.append "<region id=""videoregion"" top=""0"" left=""0"" width="""+str(w)+""" height="""+str(h)+""" fit=""fill""/>"		  lines.append "<region id=""titleregion"" top=""0"" left=""0"" width="""+str(w)+""" height="""+str(h)+"""/>"		  lines.append "</layout>"		  lines.append "</head>"		  lines.append "<body>"		  lines.append "<par>"		  lines.append "<!-- VIDEO -->"		  lines.append "<video src="""+getmoviefilename+""" region=""videoregion""/>"                		  lines.append "<!-- tiffs -->"		  lines.append "<par>"		  		  for each title in titles		    lines.append cliptext(title)		  next		  		  lines.append "</par>"		  lines.append "</par>"		  lines.append "</body>"		  lines.append "</smil>"		  lines.append "</xml>"		  		  		  result = join(lines,endofline)		  return result		  		  		  		  		End Function	#tag EndEvent	#tag Event		Function GetCreatorEvent() As string		  return "TVOD" // quicktime player?		End Function	#tag EndEvent	#tag Event		Function GetDefaultNameEvent() As string		  return documentname + ".smil.mov"		End Function	#tag EndEvent	#tag Event		Function GetDefaultPathEvent() As folderitem		  return exportfolder		End Function	#tag EndEvent	#tag Event		Function GetLabelEvent() As string		  return "QuickTime SMIL"		End Function	#tag EndEvent	#tag Event		Function GetTypeEvent() As string		  return "MooV"		End Function	#tag EndEvent	#tag Method, Flags = &h1		Protected Function ClipText(title as onetitle) As string		  dim i,j,cf as integer		  dim tapeoffset as boolean		  dim lines(-1), result, inp, outp, dur as string		  dim tcstart, tcend, durtc, offsettc as timecode		  dim w, h as integer		  		  tcstart = gettimeCode		  tcend = gettimeCode		  offsettc = getmovieoffset		  		  if title.getinpoint<>"" and title.getoutpoint<>"" then		    inp = title.getinpoint		    outp = title.getoutpoint		    tcstart.settext inp		    tcstart.minus offsettc		    inp = tcstart.gettextQT		    tcend.settext outp		    tcend.minus offsettc		    outp = tcend.gettextQT		    		    return "  <img src="""+title.filenameComplete+""" region=""titleregion"" begin="""+inp+"""  end="""+outp+"""   qt:composite-mode=""alpha"" />" 		  end		End Function	#tag EndMethod	#tag Method, Flags = &h0		Sub Flatten(f as folderitem)		  		End Sub	#tag EndMethod	#tag Note, Name = sample		<?xml version="1.0"?>		<?quicktime type="application/smil"?>		<smil xmlns:qt="http://www.apple.com/quicktime/resources/smilextensions" qt:autoplay="true" qt:time-slider="true">		<head> 		<meta name="title" content="Wizard of Oz Example"/>                  		<layout> 		<root-layout background-color="green" width="720" height="576"/> 		<region id="videoregion" top="0" left="0" width="720" height="576" fit="fill"/> 		<region id="titleregion" top="0" left="0" width="720" height="576"/> 		</layout> 		</head> 		                 		<body> 		<par> 				<!-- VIDEO --> 		<video src="mooresmall.mov" region="videoregion"/>                  				<!-- tiffs -->		<seq>		<img src="0001.tif" region="titleregion" dur="00:00:02.00"   qt:composite-mode="alpha"         /> 		<img src="0002.tif" region="titleregion" dur="00:00:03.00"   qt:composite-mode="alpha"         />		</seq>		</par> 		</body> 		</smil>		</xml>			#tag EndNote	#tag ViewBehavior		#tag ViewProperty			Name="documentname"			Group="Behavior"			Type="string"			EditorType="MultiLineEditor"			InheritedFrom="TitleExporterBN"		#tag EndViewProperty		#tag ViewProperty			Name="dumpstring"			Group="Behavior"			Type="string"			EditorType="MultiLineEditor"			InheritedFrom="TitleExporterBN"		#tag EndViewProperty		#tag ViewProperty			Name="Index"			Visible=true			Group="ID"			InitialValue="-2147483648"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="Left"			Visible=true			Group="Position"			InitialValue="0"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="moviename"			Group="Behavior"			Type="string"			EditorType="MultiLineEditor"			InheritedFrom="TitleExporterBN"		#tag EndViewProperty		#tag ViewProperty			Name="Name"			Visible=true			Group="ID"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="Super"			Visible=true			Group="ID"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="Top"			Visible=true			Group="Position"			InitialValue="0"			InheritedFrom="Object"		#tag EndViewProperty	#tag EndViewBehaviorEnd Class#tag EndClass