#tag ClassProtected Class AdobeEncoreTextExporterBNInherits TitleExporterBN	#tag Event		Function ExportEvent() As string		  dim item,i as integer		  dim lines(-1), textlines(-1), result, inp, outp, tab as string		  dim first as boolean		  dim title as onetitle		  dim tc, offset as timecode		  		  tc = gettimeCode		  offset = getoffset		  tab = chr(9)		  		  for each title in titles		    		    if title.getinpoint<>"" and title.getoutpoint<>"" then		      item = item + 1		      inp = title.getinpoint		      outp = title.getoutpoint		      		      tc.settext inp		      tc.plus(offset)		      inp = tc.gettext		      tc.settext outp		      tc.plus(offset)		      outp = tc.gettext		      		      textlines= split(title.textclean,endofLine)		      for i = 0 to ubound(textlines)		        if i = 0 then		          lines.append format(item,"0")+ " " + inp + " " + outp + " " + textlines(i)		        else		          lines.append textlines(i)		        end		      next		    end		  next		  		  result = join(lines,endofLine.windows)		  result = converttext(result)		  return result		  		End Function	#tag EndEvent	#tag Event		Function GetDefaultDictEvent() As dictionary		  dim d as new dictionary		  d.value("textencoding") = "UTF-8"		  d.value("applyoffset") = true		  d.value("applyoffsetvalue") = "00:00:00:00"		  return d		End Function	#tag EndEvent	#tag Event		Function GetDefaultNameEvent() As string		  return documentname + ".txt"		End Function	#tag EndEvent	#tag Event		Function GetLabelEvent() As string		  return "Adobe Encore Text"		End Function	#tag EndEvent	#tag Method, Flags = &h0		Sub Constructor()		  		End Sub	#tag EndMethod	#tag ViewBehavior		#tag ViewProperty			Name="documentname"			Group="Behavior"			Type="string"			EditorType="MultiLineEditor"			InheritedFrom="TitleExporterBN"		#tag EndViewProperty		#tag ViewProperty			Name="dumpstring"			Group="Behavior"			Type="string"			EditorType="MultiLineEditor"			InheritedFrom="TitleExporterBN"		#tag EndViewProperty		#tag ViewProperty			Name="Index"			Visible=true			Group="ID"			InitialValue="-2147483648"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="Left"			Visible=true			Group="Position"			InitialValue="0"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="moviename"			Group="Behavior"			Type="string"			EditorType="MultiLineEditor"			InheritedFrom="TitleExporterBN"		#tag EndViewProperty		#tag ViewProperty			Name="Name"			Visible=true			Group="ID"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="Super"			Visible=true			Group="ID"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="Top"			Visible=true			Group="Position"			InitialValue="0"			InheritedFrom="Object"		#tag EndViewProperty	#tag EndViewBehaviorEnd Class#tag EndClass