#tag ModuleProtected Module HTMLModule	#tag Method, Flags = &h0		Function HTMLValue(extends c as color) As string		  dim result as string		  		  result = "#" +right("0"+hex(c.red),2)+right("0"+hex(c.green),2)+right("0"+hex(c.blue),2)		  		  return result		End Function	#tag EndMethod	#tag Method, Flags = &h21		Private Sub InitLatinTable()		  dim source,lines(-1), fields(-1), line,ent as string		  dim i,cp as integer		  		  redim entitytable(255)		  for i = 0 to 255		    entitytable(i) = encodings.isoLatin1.chr(i)		  next		  entitytable(asc("<")) = "&lt;"		  entitytable(asc(">")) = "&gt;"		  entitytable(asc("&")) = "&amp;"		  		  		   source = "&nbsp; &#160;     non-breaking space" +endofline+_		  "&iexcl; &#161; ¡ ¡ inverted exclamation mark" +endofline+_		  "&cent; &#162; ¢ ¢ cent sign" +endofline+_		  "&pound; &#163; £ £ pound sign" +endofline+_		  "&curren; &#164; ¤ ¤  currency sign" +endofline+_		  "&yen; &#165; ¥ ¥ yen sign" +endofline+_		  "&brvbar; &#166; ¦ ¦ broken bar" +endofline+_		  "&sect; &#167; § § section sign" +endofline+_		  "&uml; &#168; ¨ ¨ diaeresis" +endofline+_		  "&copy; &#169; © © copyright sign" +endofline+_		  "&ordf; &#170; ª ª feminine ordinal indicator" +endofline+_		  "&laquo; &#171; « « left-pointing double angle quotation mark" +endofline+_		  "&not; &#172; ¬ ¬ not sign" +endofline+_		  "&shy; &#173; ­ ­ soft hyphen" +endofline+_		  "&reg; &#174; ® ® registered sign" +endofline+_		  "&macr; &#175; ¯ ¯ macron" +endofline+_		  "&deg; &#176; ° ° degree sign" +endofline+_		  "&plusmn; &#177; ± ± plus-minus sign" +endofline+_		  "&sup2; &#178; ² ² superscript two" +endofline+_		  "&sup3; &#179; ³ ³ superscript three" +endofline+_		  "&acute; &#180; ´ ´ acute accent" +endofline+_		  "&micro; &#181; µ µ micro sign" +endofline+_		  "&para; &#182; ¶ ¶ pilcrow sign" +endofline+_		  "&middot; &#183; · · middle dot" +endofline+_		  "&cedil; &#184; ¸ ¸ cedilla" +endofline+_		  "&sup1; &#185; ¹ ¹ superscript one" +endofline+_		  "&ordm; &#186; º º masculine ordinal indicator" +endofline+_		  "&raquo; &#187; » » right-pointing double angle quotation mark" +endofline+_		  "&frac14; &#188; ¼ ¼ vulgar fraction one quarter" +endofline+_		  "&frac12; &#189; ½ ½ vulgar fraction one half" +endofline+_		  "&frac34; &#190; ¾ ¾ vulgar fraction three quarters" +endofline+_		  "&iquest; &#191; ¿ ¿ inverted question mark" +endofline+_		  "&Agrave; &#192; À À latin capital letter A with grave" +endofline+_		  "&Aacute; &#193; Á Á latin capital letter A with acute" +endofline+_		  "&Acirc; &#194; Â Â latin capital letter A with circumflex" +endofline+_		  "&Atilde; &#195; Ã Ã latin capital letter A with tilde" +endofline+_		  "&Auml; &#196; Ä Ä  latin capital letter A with diaeresis" +endofline+_		  "&Aring; &#197; Å Å latin capital letter A with ring above" +endofline+_		  "&AElig; &#198; Æ Æ latin capital letter AE" +endofline+_		  "&Ccedil; &#199; Ç Ç latin capital letter C with cedilla" +endofline+_		  "&Egrave; &#200; È È latin capital letter E with grave" +endofline+_		  "&Eacute; &#201; É É latin capital letter E with acute" +endofline+_		  "&Ecirc; &#202; Ê Ê latin capital letter E with circumflex" +endofline+_		  "&Euml; &#203; Ë Ë latin capital letter E with diaeresis" +endofline+_		  "&Igrave; &#204; Ì Ì latin capital letter I with grave" +endofline+_		  "&Iacute; &#205; Í Í latin capital letter I with acute" +endofline+_		  "&Icirc; &#206; Î Î latin capital letter I with circumflex" +endofline+_		  "&Iuml; &#207; Ï Ï latin capital letter I with diaeresis" +endofline+_		  "&ETH; &#208; Ð Ð latin capital letter ETH" +endofline+_		  "&Ntilde; &#209; Ñ Ñ latin capital letter N with tilde" +endofline+_		  "&Ograve; &#210; Ò Ò latin capital letter O with grave" +endofline+_		  "&Oacute; &#211; Ó Ó latin capital letter O with acute" +endofline+_		  "&Ocirc; &#212; Ô Ô latin capital letter O with circumflex" +endofline+_		  "&Otilde; &#213; Õ Õ latin capital letter O with tilde" +endofline+_		  "&Ouml; &#214; Ö Ö latin capital letter O with diaeresis" +endofline+_		  "&times; &#215; × × multiplication sign" +endofline+_		  "&Oslash; &#216; Ø Ø latin capital letter O with stroke" +endofline+_		  "&Ugrave; &#217; Ù Ù latin capital letter U with grave" +endofline+_		  "&Uacute; &#218; Ú Ú latin capital letter U with acute" +endofline+_		  "&Ucirc; &#219; Û Û latin capital letter U with circumflex" +endofline+_		  "&Uuml; &#220; Ü Ü latin capital letter U with diaeresis" +endofline+_		  "&Yacute; &#221; Ý Ý latin capital letter Y with acute" +endofline+_		  "&THORN; &#222; Þ Þ latin capital letter THORN" +endofline+_		  "&szlig; &#223; ß ß latin small letter sharp s" +endofline+_		  "&agrave; &#224; à à latin small letter a with grave" +endofline+_		  "&aacute; &#225; á á  latin small letter a with acute" +endofline+_		  "&acirc; &#226; â â latin small letter a with circumflex" +endofline+_		  "&atilde; &#227; ã ã latin small letter a with tilde" +endofline+_		  "&auml; &#228; ä ä latin small letter a with diaeresis" +endofline+_		  "&aring; &#229; å å latin small letter a with ring above" +endofline+_		  "&aelig; &#230; æ æ latin small letter ae" +endofline+_		  "&ccedil; &#231; ç ç latin small letter c with cedilla" +endofline+_		  "&egrave; &#232; è è latin small letter e with grave" +endofline+_		  "&eacute; &#233; é é latin small letter e with acute" +endofline+_		  "&ecirc; &#234; ê ê latin small letter e with circumflex" +endofline+_		  "&euml; &#235; ë ë latin small letter e with diaeresis" +endofline+_		  "&igrave; &#236; ì ì latin small letter i with grave" +endofline+_		  "&iacute; &#237; í í latin small letter i with acute" +endofline+_		  "&icirc; &#238; î î latin small letter i with circumflex" +endofline+_		  "&iuml; &#239; ï ï latin small letter i with diaeresis" +endofline+_		  "&eth; &#240; ð ð latin small letter eth" +endofline+_		  "&ntilde; &#241; ñ ñ latin small letter n with tilde" +endofline+_		  "&ograve; &#242; ò ò latin small letter o with grave" +endofline+_		  "&oacute; &#243; ó ó latin small letter o with acute" +endofline+_		  "&ocirc; &#244; ô ô latin small letter o with circumflex" +endofline+_		  "&otilde; &#245; õ õ latin small letter o with tilde" +endofline+_		  "&ouml; &#246; ö ö latin small letter o with diaeresis" +endofline+_		  "&divide; &#247; ÷ ÷ division sign" +endofline+_		  "&oslash; &#248; ø ø latin small letter o with stroke" +endofline+_		  "&ugrave; &#249; ù ù latin small letter u with grave" +endofline+_		  "&uacute; &#250; ú ú latin small letter u with acute" +endofline+_		  "&ucirc; &#251; û û latin small letter u with circumflex" +endofline+_		  "&uuml; &#252; ü ü latin small letter u with diaeresis" +endofline+_		  "&yacute; &#253; ý ý latin small letter y with acute" +endofline+_		  "&thorn; &#254; þ þ latin small letter thorn" +endofline+_		  "&yuml; &#255; ÿ ÿ latin small letter y with diaeresis"		  		  lines = split(source,endofLine)		  for each line in lines		    fields = split(line," ")		    if ubound(fields) >=1 then		      cp = val(replace(replace(fields(1),"&#",""),";",""))		      ent = fields(0)		      if cp>=0 and cp<256 then		        entitytable(cp) = ent		      end		    end		  next		  		  		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Function Latin2HTML(s as string) As string		  dim s2, chrs(-1) as string		  dim i,ub,test as integer		  s2 = s.convertEncoding(encodings.ISOLatin1)		  		  		  if ubound(entitytable)=-1 then		    initLatinTable		  end		  		  chrs = split(s2,"")		  ub = ubound(chrs)		  for i = 0 to ub		    test = asc(chrs(i))		    chrs(i) = entitytable(test)		  next		  		  return join(chrs,"")		  		End Function	#tag EndMethod	#tag Note, Name = entities iso 8859-1		&nbsp; &#160;     non-breaking space		&iexcl; &#161; ¡ ¡ inverted exclamation mark		&cent; &#162; ¢ ¢ cent sign		&pound; &#163; £ £ pound sign		&curren; &#164; ¤ ¤  currency sign		&yen; &#165; ¥ ¥ yen sign		&brvbar; &#166; ¦ ¦ broken bar		&sect; &#167; § § section sign		&uml; &#168; ¨ ¨ diaeresis		&copy; &#169; © © copyright sign		&ordf; &#170; ª ª feminine ordinal indicator		&laquo; &#171; « « left-pointing double angle quotation mark		&not; &#172; ¬ ¬ not sign		&shy; &#173; ­ ­ soft hyphen		&reg; &#174; ® ® registered sign		&macr; &#175; ¯ ¯ macron		&deg; &#176; ° ° degree sign		&plusmn; &#177; ± ± plus-minus sign		&sup2; &#178; ² ² superscript two		&sup3; &#179; ³ ³ superscript three		&acute; &#180; ´ ´ acute accent		&micro; &#181; µ µ micro sign		&para; &#182; ¶ ¶ pilcrow sign		&middot; &#183; · · middle dot		&cedil; &#184; ¸ ¸ cedilla		&sup1; &#185; ¹ ¹ superscript one		&ordm; &#186; º º masculine ordinal indicator		&raquo; &#187; » » right-pointing double angle quotation mark		&frac14; &#188; ¼ ¼ vulgar fraction one quarter		&frac12; &#189; ½ ½ vulgar fraction one half		&frac34; &#190; ¾ ¾ vulgar fraction three quarters		&iquest; &#191; ¿ ¿ inverted question mark		&Agrave; &#192; À À latin capital letter A with grave		&Aacute; &#193; Á Á latin capital letter A with acute		&Acirc; &#194; Â Â latin capital letter A with circumflex		&Atilde; &#195; Ã Ã latin capital letter A with tilde		&Auml; &#196; Ä Ä  latin capital letter A with diaeresis		&Aring; &#197; Å Å latin capital letter A with ring above		&AElig; &#198; Æ Æ latin capital letter AE		&Ccedil; &#199; Ç Ç latin capital letter C with cedilla		&Egrave; &#200; È È latin capital letter E with grave		&Eacute; &#201; É É latin capital letter E with acute		&Ecirc; &#202; Ê Ê latin capital letter E with circumflex		&Euml; &#203; Ë Ë latin capital letter E with diaeresis		&Igrave; &#204; Ì Ì latin capital letter I with grave		&Iacute; &#205; Í Í latin capital letter I with acute		&Icirc; &#206; Î Î latin capital letter I with circumflex		&Iuml; &#207; Ï Ï latin capital letter I with diaeresis		&ETH; &#208; Ð Ð latin capital letter ETH		&Ntilde; &#209; Ñ Ñ latin capital letter N with tilde		&Ograve; &#210; Ò Ò latin capital letter O with grave		&Oacute; &#211; Ó Ó latin capital letter O with acute		&Ocirc; &#212; Ô Ô latin capital letter O with circumflex		&Otilde; &#213; Õ Õ latin capital letter O with tilde		&Ouml; &#214; Ö Ö latin capital letter O with diaeresis		&times; &#215; × × multiplication sign		&Oslash; &#216; Ø Ø latin capital letter O with stroke		&Ugrave; &#217; Ù Ù latin capital letter U with grave		&Uacute; &#218; Ú Ú latin capital letter U with acute		&Ucirc; &#219; Û Û latin capital letter U with circumflex		&Uuml; &#220; Ü Ü latin capital letter U with diaeresis		&Yacute; &#221; Ý Ý latin capital letter Y with acute		&THORN; &#222; Þ Þ latin capital letter THORN		&szlig; &#223; ß ß latin small letter sharp s		&agrave; &#224; à à latin small letter a with grave		&aacute; &#225; á á  latin small letter a with acute		&acirc; &#226; â â latin small letter a with circumflex		&atilde; &#227; ã ã latin small letter a with tilde		&auml; &#228; ä ä latin small letter a with diaeresis		&aring; &#229; å å latin small letter a with ring above		&aelig; &#230; æ æ latin small letter ae		&ccedil; &#231; ç ç latin small letter c with cedilla		&egrave; &#232; è è latin small letter e with grave		&eacute; &#233; é é latin small letter e with acute		&ecirc; &#234; ê ê latin small letter e with circumflex		&euml; &#235; ë ë latin small letter e with diaeresis		&igrave; &#236; ì ì latin small letter i with grave		&iacute; &#237; í í latin small letter i with acute		&icirc; &#238; î î latin small letter i with circumflex		&iuml; &#239; ï ï latin small letter i with diaeresis		&eth; &#240; ð ð latin small letter eth		&ntilde; &#241; ñ ñ latin small letter n with tilde		&ograve; &#242; ò ò latin small letter o with grave		&oacute; &#243; ó ó latin small letter o with acute		&ocirc; &#244; ô ô latin small letter o with circumflex		&otilde; &#245; õ õ latin small letter o with tilde		&ouml; &#246; ö ö latin small letter o with diaeresis		&divide; &#247; ÷ ÷ division sign		&oslash; &#248; ø ø latin small letter o with stroke		&ugrave; &#249; ù ù latin small letter u with grave		&uacute; &#250; ú ú latin small letter u with acute		&ucirc; &#251; û û latin small letter u with circumflex		&uuml; &#252; ü ü latin small letter u with diaeresis		&yacute; &#253; ý ý latin small letter y with acute		&thorn; &#254; þ þ latin small letter thorn		&yuml; &#255; ÿ ÿ latin small letter y with diaeresis			#tag EndNote	#tag Property, Flags = &h21		Private entitytable(-1) As string	#tag EndProperty	#tag ViewBehavior		#tag ViewProperty			Name="Index"			Visible=true			Group="ID"			InitialValue="-2147483648"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="Left"			Visible=true			Group="Position"			InitialValue="0"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="Name"			Visible=true			Group="ID"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="Super"			Visible=true			Group="ID"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="Top"			Visible=true			Group="Position"			InitialValue="0"			InheritedFrom="Object"		#tag EndViewProperty	#tag EndViewBehaviorEnd Module#tag EndModule